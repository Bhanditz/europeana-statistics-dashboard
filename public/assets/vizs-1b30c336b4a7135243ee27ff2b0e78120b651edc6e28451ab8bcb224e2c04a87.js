function dataFinding(e){"One Dimensional Charts"==genre&&(e.color_mode="shade");var t=0;config_data=e,final_config={};var o=$(".cstm-form-control:input"),n=[];colorRepetation=[],countgroup=1;for(var i in current_config)config_data[i]=current_config[i];for(i=0;i<o.length;i++)if("core_theme_name"!=o[i].id)if(n.push(o[i].type),"number"===o[i].type.toLowerCase())o[i].value=config_data[$(o)[i].id],final_config[$(o)[i].id]=config_data[$(o)[i].id];else if("textbox"===o[i].type.toLowerCase())$(o)[i].value=config_data[$(o)[i].id]||"",final_config[$(o)[i].id]=config_data[$(o)[i].id];else if("text"===o[i].type.toLowerCase())$(o)[i].value=config_data[$(o)[i].id]||"",final_config[$(o)[i].id]=config_data[$(o)[i].id];else if("color"===o[i].type.toLowerCase())$(o)[i].value=config_data[$(o)[i].id]||"",final_config[$(o)[i].id]=config_data[$(o)[i].id];else if("color1"===$(o[i]).attr("reference")){1===t&&(t=0),t+=.2;var r=config_data[o[i].id];"chart_color"===o[i].id&&(r=r[0]);var s=hex2rgb(r),a=("rgba("+s[0]+","+s[1]+","+s[2]+","+t+")",RGBAtoRGB(s[0],s[1],s[2],t,255,255,255)),l=rgbToHex(a);o[i].value=l,$($(o[i])[0].parentElement).attr("data-color",l),$($(o[i])[0].previousElementSibling.childNodes[1]).css("background-color",l),"chart_color"===o[i].id&&countgroup<=5&&(5===countgroup?colorRepetation+=l:colorRepetation+=l+";",countgroup++)}else"checkbox"===o[i].type.toLowerCase()?($(o)[i].value=config_data[$(o)[i].id],"yes"===config_data[$(o)[i].id]?$(o)[i].checked=!0:$(o)[i].checked=!1,final_config[$(o)[i].id]=config_data[$(o)[i].id]):"select-one"===o[i].type.toLowerCase()&&($(o)[i].value=config_data[$(o)[i].id],final_config[$(o)[i].id]=config_data[$(o)[i].id]);config_data.data=parsed_data,config_data.selector=selector,init()}function init(){obj&&(config_data.title_text=""!=obj.title_text.toString().trim()?obj.title_text:config_data.title_text,config_data.subtitle_text=""!=obj.subtitle_text.toString().trim()?obj.subtitle_text:config_data.subtitle_text),obj=config_data,$(selector).empty(),config_data.map_code=map_code,final_config.map_code=map_code,obj.title_text&&"[entertitlehere]"==obj.title_text.trim().replace(/ /g,"").toLowerCase()&&$("#title_text").val(""),obj.subtitle_text&&"[entersubtitlehere]"==obj.subtitle_text.trim().replace(/ /g,"").toLowerCase()&&$("#subtitle_text").val("");var e="";e=colorRepetation,"Pictograph"!=chart_name&&"Grid"!==chart_name&&(config_data.chart_color=colorRepetation.split(";").reverse(),$("[id1='array_text']").attr("value",e.split(";").reverse().join(";"))),colorRepetation=[],e="",countgroup=1,initializeTheChart("true")}function hex2rgb(e){return["0x"+e[1]+e[2]|0,"0x"+e[3]+e[4]|0,"0x"+e[5]+e[6]|0]}function RGBAtoRGB(e,t,o,n,i,r,s){var a=Math.round((1-n)*i+n*e),l=Math.round((1-n)*r+n*t),c=Math.round((1-n)*s+n*o);return"rgb("+a+","+l+","+c+")"}function rgbToHex(e){if("#"===e.substr(0,1))return e;var t=/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(e),o=parseInt(t[2],10).toString(16),n=parseInt(t[3],10).toString(16),i=parseInt(t[4],10).toString(16);return"#"+((1==o.length?"0"+o:o)+(1==n.length?"0"+n:n)+(1==i.length?"0"+i:i))}function expandAndCollapseAllPanels(){$(".panel-body").hasClass("in")?$(".panel-body").removeClass("in"):($(".panel-body").addClass("in").css("height","auto"),$(".in").prev().removeClass("collapsed"))}Rumali.categorizeColumns=function(e){var t,o=[],n=[],i="#A2DED0",r="#C5EFF7",s=[];traverse_of_alias={};var a=function(e){var t={};t.token=gon.token,$.ajax({url:rumi_api_endpoint+Rumali.gridoperation.restEndPoint()+"column/dimensions_and_metrics",type:"GET",data:t,dataType:"json",success:function(o){$.ajax({url:rumi_api_endpoint+Rumali.gridoperation.restEndPoint()+"column/all_columns?data_types=true&original_names=true&token="+gon.token,type:"GET",data:t,dataType:"json",success:function(t){self.datatype_column=t.columns.column_types,Rumali.original_column_names=t.columns.original_column_names,e(o,t)}})}})},l=function(){$(".categorize_columns-draggable").draggable({addClasses:!1,appendTo:"body",revert:"invalid",helper:"clone",zIndex:100,start:function(e,t){var o=$(e.target);t.helper.width(o.width()),t.helper.addClass("drag-helper"),$(".ui-droppable").addClass("drop-here")},stop:function(){$(".ui-droppable").removeClass("drop-here")}})},c=function(e){var t=!1,i="";"metrics"===e?(o.length>0&&(t=!0),i=".metrics-reset"):"dimensions"===e&&(n.length>0&&(t=!0),i=".dimensions-reset"),t?$(i).show():$(i).hide()};jQuery.fn.highlight=function(){$(this).each(function(){var e=$(this);e.before("<div/>"),e.prev().width(e.width()).height(e.height()).css({position:"absolute","background-color":"#ffff99",opacity:".9"}).fadeOut(1e3)})};var h=function(){n.length>0||o.length>0?($("#reset_all").show(),$("#first_time_load").hide(),showHintForChartEligibility()):($("#reset_all").hide(),$("#dimension_metrics_container").highlight(),$("#first_time_load").show())},u=function(e){"block"===$("#chart_show").css("display")&&($(".is_selected_chart").removeClass("is_selected_chart"),$("#chart_show").hide());var t,a,u,d,f=$(this.parentNode.parentNode),p=$(f[0]).data("coltype"),g=$(f[0]).data("colname"),v=$(f[0]).data("datatype"),w=$(f[0]).data("aggregation"),y=n.indexOf(g),C={},b=Rumali.original_column_names[g];if(y>-1?(n.splice(y,1),table_show.removeDimensions([g]),c("dimensions")):void 0!==table_show.metrics[g]&&(o.splice(o.indexOf(g),1),table_show.removeMetrics([g]),c("metrics")),"dimensions"===p)t="#ref_dimensions_list",a=i;else if("metrics"===p){if("string"==typeof w)index_to_remove=s.indexOf(b+"_"+w),index_to_remove>=0&&s.splice(index_to_remove,1);else for(col_aggregations_length=w.length,d=0;d<=col_aggregations_length;d++)index_to_remove=s.indexOf(b+"_"+w[d]),index_to_remove>=0&&s.splice(index_to_remove,1);t="#ref_metrics_list",a=r}m(e,g),table_show.executeOnFilter=function(){C=table_show.flushToGet().data,u=d3.csv.parse(C),refreshTableData(u),appendAliasToColumnHeader(user_entered_column_names),enableCharts(C,n,s),$(t).append("<li class='categorize_columns-draggable' data-datatype='"+v+"' data-colname='"+g+"' data-coltype='"+p+"' style='background:"+a+"'>"+b+"</li>"),f.remove(),l(),h()},table_show.dimensions.length>0||!$.isEmptyObject(table_show.metrics)?($("#table_show").show(),table_show.call()):($("#table_show").hide(),u=[{"":""}],refreshTableData(u),appendAliasToColumnHeader(user_entered_column_names),enableCharts(C,n,s),$(t).append("<li class='categorize_columns-draggable' data-datatype='"+v+"' data-colname='"+g+"' data-coltype='"+p+"' style='background:"+a+"'>"+b+"</li>"),f.remove(),l(),h())},d=function(e){var o=$(this.parentNode.parentNode),n=o.data("aggregation");t=o.data("colname"),$("#select_metrics").select2("val",n),$("#aggregation_selection_list").show().css({top:e.clientY-$("#aggregation_selection_list")[0].getBoundingClientRect().height-15,left:e.clientX})},f=function(e,o){var i,r={},a=e.val(),l=Rumali.original_column_names[t];$("#Metrics .query-list[data-colname='"+t+"']").attr("data-aggregation",a).data("aggregation",a),$("#Metrics .query-list[data-colname='"+t+"'] .list-of-metrics").html(a.join(", ")+" - ");for(var c=a.length,h=0;c>h;h++)r[a[h]]=l+"_"+a[h],traverse_of_alias[l+"_"+a[h]]=[a[h],t];table_show.metrics[t]=a,table_show.alias[t]=r,column_name_alias=JSON.parse(JSON.stringify(table_show.alias)),o.added?(l+="_"+o.added.id,Rumali.original_column_names[l]=l,s.push(l),p(l,l,t,"metrics")):o.removed&&(l+="_"+o.removed.id,i=s.indexOf(l),i>=0&&s.splice(i,1),m(event,l)),table_show.executeOnFilter=function(){var e=table_show.flushToGet().data;refreshTableData(d3.csv.parse(e)),appendAliasToColumnHeader(user_entered_column_names),enableCharts(e,n,s),$("#show_grid_and_hide_the_chart").trigger("click"),$("#select_metrics").select2("close")},table_show.call()},p=function(e,t,o,n){var i=document.getElementById("sort_by_column"),r=i.options[i.options.length]=new Option(e,t);r.setAttribute("data-col_name",o),r.setAttribute("data-col_type",n)};Rumali.refreshChartAfterFilter=function(){var e=table_show.flushToGet().data;refreshTableData(d3.csv.parse(e)),appendAliasToColumnHeader(user_entered_column_names),enableCharts(e,n,s),$(".is_selected_chart").trigger("click")};var m=function(e,t,o){var i=$("#sort_by_column").val();o?$("#sort_by_column option[data-col_type='"+o+"']").remove():($("#sort_by_column option[data-col_name='"+t+"']").remove(),$("#sort_by_column option[value='"+t+"']").remove()),-1===n.indexOf(i)&&-1===s.indexOf(i)&&($("#sort_by_column").val(""),table_show.sort.shift()),e.stopPropagation()},g=function(e){var t=$("#sort_by_column").val();if(t){$(e).data("sort")&&($("#Sort .btn").removeClass("active"),$(e).addClass("active"));var o,i={};i[$("#sort_by_column").val()]=$("#Sort .active").data("sort"),table_show.sort[0]=i}else table_show.sort[0]={};table_show.executeOnFilter=function(){o=table_show.flushToGet().data,refreshTableData(d3.csv.parse(o)),appendAliasToColumnHeader(user_entered_column_names),enableCharts(o,n,s),$("#show_grid_and_hide_the_chart").trigger("click")},table_show.call()},v=function(e){table_show.executeOnFilter=function(){t=table_show.flushToGet().data,refreshTableData(d3.csv.parse(t)),enableCharts(t,n,s),$(".is_selected_chart").length>0?$(".is_selected_chart.enabled").trigger("click"):$("#show_grid_and_hide_the_chart").trigger("click")};var t,o=$(e).val();o&&o>0?table_show.limit=o:table_show.limit=200,table_show.call()},w=function(){$(".categorize_columns-droppable").droppable({activeClass:"ui-state-hover",hoverClass:"ui-state-active",accept:":not(.ui-sortable-helper)",drop:function(e,t){"data_container"===this.id&&("none"===$("#table_show").css("display")&&$("#table_show").show(),"block"===$("#chart_show").css("display")&&($(".is_selected_chart").removeClass("is_selected_chart"),$("#chart_show").hide())),t.draggable.appendTo(this);var a,l=t.draggable[0].parentNode.id,u=$(t.draggable[0]).data("colname"),d=$(t.draggable[0]).data("datatype"),f="",m=Rumali.original_column_names[u],g="";if("ref_dimensions_list"===l)f="dimensions",g=i;else if("ref_metrics_list"===l)f="metrics",g=r;else{var v;if(t.draggable.remove(),l=$(t.draggable[0]).data("coltype"),"metrics"===l){var w,y,C={},b={},_={};"integer"===d||"double"===d?(w="sum",y="<span class='glyphicon glyphicon-chevron-down show-aggregation-list'></span>"):(w="count",y=""),C[u]=[w],m+="_"+w,a=m,Rumali.original_column_names[m]=m,_[w]=m,b[u]=_,table_show.metrics=C,user_entered_column_names[u]=u+"_"+w,table_show.alias=b,column_name_alias=JSON.parse(JSON.stringify(table_show.alias)),traverse_of_alias[m]=[w,u],o.push(u),s.push(m),$("<li class='query-list' data-colname='"+u+"' data-datatype='"+d+"' data-aggregation="+[w]+" data-coltype='metrics' style='background:"+r+"'><div class='dropdown'><span class='alias'></span><span class='list-of-metrics'>"+w+" - </span>"+t.draggable.text()+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+y+"<span class='glyphicon glyphicon-remove-circle remove-from-query'></span></div></li>").appendTo($(this).find("#Metrics")),c("metrics"),v=document.getElementById("Metrics")}else"dimensions"===l&&(table_show.dimensions=[u],n.push(u),$("<li class='query-list' data-colname='"+u+"' data-datatype='"+d+"' data-coltype='dimensions' style='background:"+i+"'><div class='dropdown'><span class='alias'></span>"+t.draggable.text()+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-remove-circle remove-from-query'></span></div></li>").appendTo($(this).find("#Dimensions")),c("dimensions"),v=document.getElementById("Dimensions"),a=u);v.scrollLeft=v.scrollWidth,h(),p(m,a,u,l),table_show.executeOnFilter=function(){var e=table_show.flushToGet().data;refreshTableData(d3.csv.parse(e)),appendAliasToColumnHeader(user_entered_column_names),enableCharts(e,n,s)},table_show.call()}t.draggable.attr("data-coltype",f).css("background",g),("ref_dimensions_list"==this.id||"ref_metrics_list"==this.id)&&R(e)}}).sortable({item:"li",sort:function(){$(this).removeClass("ui-state-default")}}),$(".query-droppable").sortable({disabled:!0})},y=function(e){"block"===$("#chart_show").css("display")&&($(".is_selected_chart").removeClass("is_selected_chart"),$("#chart_show").hide());for(var t=$("#Dimensions .query-list"),o=t.length,r="",a={},u=0;o>u;u++){var d=$($(t[u])[0]).data("colname"),f=Rumali.original_column_names[d],p=$($(t[u])[0]).data("datatype");r+="<li class='categorize_columns-draggable' data-datatype='"+p+"' data-colname='"+d+"' data-coltype='dimensions' style='background:"+i+"'>"+f+"</li>"}for($("#ref_dimensions_list").append(r),$("#Dimensions .query-list").remove(),table_show.resetDimensions();n.length>0;)n.pop();m(e,"","dimensions"),table_show.executeOnFilter=function(){a=table_show.flushToGet().data,json_table_data=d3.csv.parse(a),refreshTableData(json_table_data),appendAliasToColumnHeader(user_entered_column_names),enableCharts(a,n,s),l(),c("dimensions"),h()},$.isEmptyObject(table_show.metrics)?($("#table_show").hide(),json_table_data=[{"":""}],refreshTableData(json_table_data),appendAliasToColumnHeader(user_entered_column_names),enableCharts(a,n,s),l(),c("dimensions"),h()):($("#table_show").show(),table_show.call())},C=function(e){"block"===$("#chart_show").css("display")&&($(".is_selected_chart").removeClass("is_selected_chart"),$("#chart_show").hide());for(var t=$("#Metrics .query-list").length,i=$("#Metrics .query-list"),a="",u={},d=0;t>d;d++){var f=$($(i[d])[0]).data("colname"),p=Rumali.original_column_names[f],g=$($(i[d])[0]).data("datatype");a+="<li class='categorize_columns-draggable' data-datatype='"+g+"' data-colname='"+f+"' data-coltype='metrics' style='background:"+r+"'>"+p+"</li>"}for($("#ref_metrics_list").append(a),$("#Metrics .query-list").remove(),table_show.resetMetrics();o.length>0;)o.pop();for(;s.length>0;)s.pop();m(e,"","metrics"),table_show.executeOnFilter=function(){u=table_show.flushToGet().data,json_table_data=d3.csv.parse(u),refreshTableData(json_table_data),appendAliasToColumnHeader(user_entered_column_names),enableCharts(u,n,o),l(),c("metrics"),h()},table_show.dimensions.length>0?($("#table_show").show(),table_show.call()):($("#table_show").hide(),json_table_data=[{"":""}],refreshTableData(json_table_data),appendAliasToColumnHeader(user_entered_column_names),enableCharts(u,n,o),l(),c("metrics"),h())},b=function(){l(),w(),$("body").is("#scopejs_vizs_new")&&($(".query-ul").unbind("click"),$(".query-ul").on("click",".remove-from-query",u),$(".dimensions-reset").unbind("click"),$(".dimensions-reset").on("click",y),$(".metrics-reset").unbind("click"),$(".metrics-reset").on("click",C),$("#select_metrics").unbind("change"),$(".query-ul").on("click",".show-aggregation-list",d),$(".close-aggregation-list").click(function(){$("#aggregation_selection_list").hide()}),$("body").click(function(e){$(e.target).hasClass("show-aggregation-list")||$(e.target).is("#select2-drop")||$("#aggregation_selection_list").hide()}),$("#select_metrics").select2({width:200,closeOnSelect:!1,dropdownCss:{"z-index":10001}}),$("#select_metrics").on("change",function(e){f($(this),e)}).on("select2-removing",function(e){1===$(this).val().length&&(console.warn("Cannot remove all the aggregation functions from a metric"),e.preventDefault())}),$("#Sort .btn").click(function(){g(this)}),$("#sort_by_column").change(function(){g(this)}),$("#limit_rows").blur(function(){v(this)}))},_=function(e,t){for(var o=e.dimensions,n=e.metrics,s="",a=o.length,l=n.length,c=0;a>c;c++)s+="<li class='categorize_columns-draggable' data-datatype='"+t.columns.column_types[o[c]]+"' data-colname='"+o[c]+"' data-coltype='dimensions' style='background:"+i+"'>"+t.columns.original_column_names[o[c]]+"</li>";s+="</ul>",$("#ref_dimensions_list").html(s),s="";for(var c=0;l>c;c++)s+="<li class='categorize_columns-draggable' data-datatype='"+t.columns.column_types[n[c]]+"' data-colname='"+n[c]+"' data-coltype='metrics' style='background:"+r+"'>"+t.columns.original_column_names[n[c]]+"</li>";s+="</ul>",$("#ref_metrics_list").html(s),b();var h=$("#table_header").handsontable("getInstance");void 0!=h&&h.updateSettings({data:Rumali.original_column_names})},R=function(e){var t=$(e.originalEvent.target).data("colname"),o=$(e.originalEvent.target).data("coltype").slice(0,-1),n={};value=e.target.id.split("_")[1].slice(0,-1),o!==value&&(n={column_name:t,value:value},n.token=gon.token,$.ajax({url:rumi_api_endpoint+Rumali.gridoperation.restEndPoint()+"column/set_column_dimension_and_metrics",type:"POST",data:n,contentType:"application/x-www-form-urlencoded",success:function(e){$("#flash_categorize_columns-save").html("<p style='width: 70px; background: yellow;  padding: 5px;'>Saved</p>"),setTimeout(function(){$("#flash_categorize_columns-save").html("")},1e3)},error:function(e){}}))};this.init=function(e){var t=function(e,t){_(e,t)};a(t)}},Rumali.gridApiCall=function(){this.originalColumnName=function(e,t){$.ajax({url:rumi_api_endpoint+Rumali.gridoperation.restEndPoint()+"column/all_columns",data:e,dataType:"json",type:"GET",success:function(e){t(e)},error:function(){console.error("Error in fetch data from server")}})},this.getDemensionsAndMetricsApiCall=function(e,t){$.ajax({url:rumi_api_endpoint+Rumali.gridoperation.restEndPoint()+"column/dimensions_and_metrics",type:"GET",data:e,dataType:"json",success:function(e){t(e)},error:function(){console.log("no mertics found: server error")}})},this.postAjaxcall=function(e,t){e.token=gon.token;var o=$.ajax({url:rumi_api_endpoint+Rumali.gridoperation.restEndPoint()+t,data:e,dataType:"json",type:"POST",async:!1,success:function(e){Rumali.pykgrid.getShowPage()},error:function(e){generate_notify({text:e.responseText,notify:"error",timeout:3e3,position:"topCenter"})}});return o},this.dataformatterapi=function(e,t){$.ajax({url:e,data:t,dataType:"json",type:"POST",success:function(e){Rumali.pykgrid.getShowPage()},error:function(){console.log("Save error. ")}})},this.datatypesApiCall=function(e,t){$.ajax({url:rumi_api_endpoint+Rumali.gridoperation.restEndPoint()+"column/datatype_distribution",data:e,dataType:"json",type:"Get",async:!1,success:function(e){t(e.dtd)},error:function(){generate_notify({text:"[rumm-api] datatype distribution failed.",notify:"error",timeout:3e3,position:"topCenter"})}})},this.rowAddApiCall=function(e,t,o){$.ajax({url:rumi_api_endpoint+Rumali.gridoperation.restEndPoint()+"row/add",data:e,dataType:"json",type:"POST",success:function(e){console.log(e,"----"),t(e),console.log("--ROW ADDED--")},error:function(){console.log("--Row add failed--"),console.error("Server error."),o()}})},this.columnAndCellChangeApiCall=function(e,t,o,n){$.ajax({url:rumi_api_endpoint+Rumali.gridoperation.restEndPoint()+t,data:e,dataType:"json",type:"POST",success:function(e){console.log(e),console.log("Cell updated"),o(e)},error:function(){console.error("Cell update failed"),n()}})},this.rowDeleteApiCall=function(e){$.ajax({url:rumi_api_endpoint+Rumali.gridoperation.restEndPoint()+"row/delete",data:e,dataType:"json",type:"POST",success:function(e){console.log(e)},error:function(){console.log("Save error"),alert("Unable to delete rows.")}})}},Rumali.gridOperation=function(){var e=this;this.getAllEditorTypes=function(){return{"boolean":"checkbox",date:"date",integer:"numeric","double":"numeric",string:"text"}},this.deleteColumnData=function(){var e=$("#grid_show").handsontable("getSelected")[1],t=self.columns_header[e+1],o={};o.column_name=t,pyk_statistics.resetMetrics(),pyk_statistics.resetDimensions(),grid_unique_values.resetDimensions(),grid_unique_values.resetMetrics(),divg1.destroyColumn(t),new_column_name=self.columns_header[e],Rumali.api.postAjaxcall(o,"/column/delete"),Rumali.gridoperation.showFilterCount();var n=new Rumali.categorizeColumns;n.init()},this.addColumnData=function(e){var t,o=$("#grid_show").handsontable("getSelected")[1],n={};"left"==e?(o+=1,t=self.columns_header[o-1]):(o+=2,t=self.columns_header[o-1]),n.column_name=Rumali.datatype_utils.random_name(),n.after=t,Rumali.api.postAjaxcall(n,"/column/add")},this.getOriginalColumnName=function(){var t={};t.original_names=!0,t.data_types=!0,t.token=gon.token,t.sub_types=!0,Rumali.api.originalColumnName(t,function(t){self.column_datatype=t,self.column_datatype=e.changeToColumnsType(self.column_datatype)})},this.changeToColumnsType=function(e){self.original_column_names=[],self.sub_datatype=[],self.columns_header=[];for(var t=[],o=e.columns.column_types,n=self.json_data[0],i=n.length,r=0;i>r;r++)null==e.columns.sub_types[n[r]]?self.sub_datatype.push("nil"):self.sub_datatype.push(e.columns.sub_types[n[r]]),null==e.columns.original_column_names[n[r]]?self.original_column_names.push("null"):self.original_column_names.push(e.columns.original_column_names[n[r]]),t.push(o[n[r]]);return self.columns_header=self.json_data[0],self.json_data[0]=self.original_column_names,t},this.getAzaxcall=function(){var t,o,n,i=e.getSelectedColumnIndex(),r={};if(i!==!1){t=self.columns_header[i+1],o=self.column_datatype[i+1],r[t]=["count"],grid_unique_values.resetDimensions(),grid_unique_values.resetMetrics(),grid_unique_values.dimensions=[new_column_name],grid_unique_values.metrics=r,grid_unique_values.executeOnFilter=function(){n=JSON.parse(grid_unique_values.flushToGet().data),data_distribution=e.changeToJsonData(n,t),"integer"==o||"double"==o?Rumali.histogram(t,o,data_distribution):($("#histogram-chart").hide(),$("#histogram_min_max").hide(),Rumali.countUniqueValues(data_distribution)),e.resetFilterElements(),e.toggleReplaceButton(),console.log()};try{grid_unique_values.dataformat="json",grid_unique_values.call()}catch(s){console.log(s,"error in data distribution")}}},this.changeToJsonData=function(e,t){for(var o={},n=e.length,i=0;n>i;i++){var r=e[i];o[r[t]]=r.count}return o},this.restEndPoint=function(){var e=window.document.URL.split("/"),t=e.indexOf("data"),o=e[t+1],n=e[--t],i=e[--t];return o.indexOf("?")>-1&&(o=$("#data_store_name").val()),i+"/"+n+"/"+o+"/"},this.getColumnsWithType=function(e){function t(e,t){t(0==e?!1:!0)}var o,n=[];column_data_length=e.length,o="id"==self.json_data[0][0]?1:0;for(var i=o;i<column_data_length;i++){var r=e[i],s="";"double"==r?(s="0.0[0000]",n.push({type:editor_types[r],data:i,format:s,validator:t,allowInvalid:!0})):n.push({type:editor_types[r],data:i,checkedTemplate:"t",uncheckedTemplate:"f"})}return n},this.returnContentColumnNames=function(e){var t=[];return $.each(e,function(o){t.push(e[o].column_name)}),t},this.showrules=function(){var t=e.rules_array.length;$("#rules-div").empty();for(var o=0;t>o;o++)$("#rules-div").append(e.rules_array[o]+"<td><span class='update-rule' id ='"+o+"'>Edit</span></td><td><span class='glyphicon glyphicon-remove delete-rule' id ='"+o+"'></span></td></tr>");$("#rules-div").append("</table>")},this.columnHeaderSelected=function(t){Rumali.pykgrid.column_selected_flag=!0,$("#histogram_min_max").hide(),$("#input-col-cancel").hide(),$("#col-info-panel").hide(),$("#grid-count").show(),e.editColumn(t),$("#column").addClass("active"),$("#column2").removeClass("active"),$("#table").removeClass("active"),$("#table1").removeClass("active"),$("#show_when_column_is_selected_3").addClass("active"),$("#mapConfigure").removeClass("active"),$("#map_options").removeClass("active"),$("#col-info-panel").show(),$("#grid_datatypes").show(),$("#pyk_statistics").show(),$("#filter_toggle").hide(),$("#hide_when_column_is_selected_2").removeClass("active"),$("#show_when_column_is_selected_1").show(),$("#show_when_column_is_selected_3").show(),$("#sorting-value").show(),$("#convert-value").show()},this.columnHeaderDeselected=function(){e.showHideListForm(!0),Rumali.pykgrid.column_selected_flag=!1,$("#table").addClass("active"),$("#column").removeClass("active"),$("#show_when_column_is_selected_3").removeClass("active"),$("#hide_when_column_is_selected_2").removeClass("active"),$("#mapConfigure").removeClass("active"),$("#map_options").removeClass("active"),$("#table1").addClass("active"),$("#show_when_column_is_selected_1").hide(),$("#show_when_column_is_selected_3").hide(),$("#input-col-name").hide(),$("#grid_datatypes").hide(),$("#pyk_statistics").hide(),$("#sorting-value").hide(),$("#merge").hide(),$("#histogram_min_max").hide()},this.showPagination=function(t){var o=grid_show.limit,n=Math.ceil(t/o);$("#page-count").empty(),t>o&&$("#page-count").pagination({pages:n,displayedPages:2,onPageClick:function(t,n){t-=1;grid_show.offset=o*t,grid_show.dataformat="array",grid_show.executeOnFilter=function(){var t=grid_show.flushToGet();void 0!=t&&(self.json_data=t.data),e.reloadGrid()};try{grid_show.call()}catch(i){console.log(i)}n.preventDefault()},cssStyle:"light-theme",edges:1})},this.toggleReplaceButton=function(){var e=[];$(".check-value:checked").each(function(t,o){e.push($(this).val())}),e.length<1?$("#replace-values").hide():$("#replace-values").show()},this.getSelectedColumnIndex=function(){var e=$("#grid_show").handsontable("getSelected");if(void 0==e)return!1;var t=e[1];return t},this.reloadGrid=function(){var e=self.json_data.length-1;self.columns_header=self.json_data[0],self.json_data[0]=self.original_column_names,$("#grid_show").handsontable("loadData",self.json_data),$container.handsontable("selectCell",e,new_column_value_index,0,new_column_value_index),Rumali.gridoperation.showFilterCount()},this.removeAllFilterColumn=function(e){for(var t=divg1.filters.slice(0),o=t.length,n=0;o>n;n++)for(var i=t[n],r=i.length,s=0,a=0;r>a;a++)if(i[a].column_name===e){divg1.filters.splice(n-s),s++;break}Rumali.gridoperation.showFilterCount()},this.showFilterCount=function(){var e=divg1.filters.length,t="";$("#applied_filters_tab_count").text(e),0===e&&(t="No filters applied yet. To apply a filter, select a column and apply from the available list."),$("#hide_when_column_is_selected_1 .hint").html(t)},this.resetFilterElements=function(){var e=divg1.filters,t=e.length;$(".check-value:checkbox").removeClass("pykquery-selected").prop("checked",!1),$(".side-bar-data-type:checkbox").removeClass("pykquery-selected").prop("checked",!1),d3.select("rect.extent").attr("x",0).attr("width",0),d3.selectAll("g.resize").style("display","none");for(var o=0;t>o;o++)for(var n=e[o],i=n.length,r=0;i>r;r++){var s=n[r];if(new_column_name==s.column_name)switch(s.condition_type){case"values":for(var a=s["in"],l=a.length,r=0;l>r;r++){var c=a[r];$("input:checkbox[value='"+c+"']").addClass("pykquery-selected"),$("input:checkbox[value='"+c+"']").prop("checked",!0)}break;case"datatype":for(var a=s["in"],l=a.length,r=0;l>r;r++){var c=a[r];$("input:checkbox[data-type='"+c+"']").addClass("pykquery-selected"),$("input:checkbox[data-type='"+c+"']").prop("checked",!0)}break;case"range":var h=(s.column_name,s.condition.min),u=s.condition.max;0==s.condition.not?($("input[type='radio'][value='in']").parent().addClass("active"),$("input[type='radio'][value='notin']").parent().removeClass("active")):($("input[type='radio'][value='in']").parent().removeClass("active"),$("input[type='radio'][value='notin']").parent().addClass("active")),global_brush.extent([h,u]),brush.call(global_brush)}}},this.sortColumnData=function(t){var o=($("#grid_show").handsontable("getSelected")[1],{});o[new_column_name]=t,grid_show.sort=[o],grid_show.executeOnFilter=function(){var t=grid_show.flushToGet().data;""!=t&&void 0!=t&&(self.json_data=t,e.reloadGrid(),$container.handsontable("selectCell",0,0,0,0))};try{grid_show.call()}catch(n){console.error("error in  data for sorting")}},this.findDataType=function(e){var t=Rumali.datatype_utils.isBoolean(e)||Rumali.datatype_utils.isNumber(e)||Rumali.datatype_utils.isDate(e)||Rumali.datatype_utils.isBlank(e)||"string";return t},this.editColumn=function(t){$("#input-data-type").val(self.column_datatype[t+1]),$("#sub-data-type").val(self.sub_datatype[t+1]),e.showHideListForm(!1),$("#grid_datatypes").show(),$("#input-col-name").show(),$("#merge").show()},this.showHideListForm=function(e){e?($("#column-list").show(),$("#grid-column-form").hide()):($("#column-list").hide(),$("#grid-column-form").show())},this.update_grid_with_new_data=function(e){if(void 0==e)return!1;if(e.length>0)return self.json_data=e,!0;if(0==e.length){var t=self.json_data[0];return self.json_data=[],self.json_data[0]=t,!0}},$(document).ready(function(){$(document).on("click",".filter_remove",function(e){Rumali.executeAfterDeleteFilter(),e.preventDefault()})})};/*!
 * Handsontable 0.12.4
 * Handsontable is a JavaScript library for editable tables with basic copy-paste compatibility with Excel and Google Docs
 *
 * Copyright 2012-2014 Marcin Warpechowski
 * Licensed under the MIT license.
 * http://handsontable.com/
 *
 * Date: Fri Jan 23 2015 10:07:24 GMT+0100 (CET)
 */
var Handsontable=function(e,t){t=t||{};var o=new Handsontable.Core(e,t);return o.init(),o};Handsontable.plugins={},function(e,t){"use strict";function o(){this.refCounter=0,this.init()}function n(){function e(){var e=this;e._registerTimeout(setTimeout(function(){e.updateSettings({observeChanges:!0})},0))}function o(e){return function(t,o){return"string"==typeof t[1]&&(t[1]=t[1].toLowerCase()),"string"==typeof o[1]&&(o[1]=o[1].toLowerCase()),t[1]===o[1]?0:null===t[1]||""===t[1]?1:null===o[1]||""===o[1]?-1:t[1]<o[1]?e?-1:1:t[1]>o[1]?e?1:-1:0}}function n(e){return function(t,o){if(t[1]===o[1])return 0;if(null===t[1])return 1;if(null===o[1])return-1;var n=new Date(t[1]),i=new Date(o[1]);return i>n?e?-1:1:n>i?e?1:-1:0}}function i(e){return"undefined"!=typeof e.sortColumn}var r=this;this.init=function(t){var o,n,i=this,s=i.getSettings().columnSorting;if(i.sortingEnabled=!!s,i.sortingEnabled){i.sortIndex=[];var c=a.call(i);"undefined"!=typeof c?(o=c.sortColumn,n=c.sortOrder):(o=s.column,n=s.sortOrder),r.sortByColumn.call(i,o,n),i.sort=function(){var e=Array.prototype.slice.call(arguments);return r.sortByColumn.apply(i,e)},"undefined"==typeof i.getSettings().observeChanges&&e.call(i),"afterInit"==t&&(l.call(i),i.addHook("afterCreateRow",r.afterCreateRow),i.addHook("afterRemoveRow",r.afterRemoveRow),i.addHook("afterLoadData",r.init))}else delete i.sort,i.removeHook("afterCreateRow",r.afterCreateRow),i.removeHook("afterRemoveRow",r.afterRemoveRow),i.removeHook("afterLoadData",r.init)},this.setSortingColumn=function(e,t){var o=this;return"undefined"==typeof e?(delete o.sortColumn,void delete o.sortOrder):(o.sortColumn===e&&"undefined"==typeof t?o.sortOrder=!o.sortOrder:o.sortOrder="undefined"!=typeof t?t:!0,void(o.sortColumn=e))},this.sortByColumn=function(e,o){var n=this;r.setSortingColumn.call(n,e,o),"undefined"!=typeof n.sortColumn&&(t.hooks.run(n,"beforeColumnSort",n.sortColumn,n.sortOrder),r.sort.call(n),n.render(),s.call(n),t.hooks.run(n,"afterColumnSort",n.sortColumn,n.sortOrder))};var s=function(){var e=this,o={};"undefined"!=typeof e.sortColumn&&(o.sortColumn=e.sortColumn),"undefined"!=typeof e.sortOrder&&(o.sortOrder=e.sortOrder),(o.hasOwnProperty("sortColumn")||o.hasOwnProperty("sortOrder"))&&t.hooks.run(e,"persistentStateSave","columnSorting",o)},a=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","columnSorting",o),o.value},l=function(){function e(){var e=n.view.TBODY.querySelector("tr").querySelectorAll("th");return e.length}function o(o){var n=t.Dom.closest(o,"TH");return t.Dom.index(n)-e()}var n=this,i=t.eventManager(n);i.addEventListener(n.rootElement,"click",function(e){if(t.Dom.hasClass(e.target,"columnSorting")){var i=o(e.target);r.sortByColumn.call(n,i)}})};this.sort=function(){var e=this;if("undefined"!=typeof e.sortOrder){e.sortingEnabled=!1,e.sortIndex.length=0;for(var t=this.colOffset(),i=0,r=this.countRows()-e.getSettings().minSpareRows;r>i;i++)this.sortIndex.push([i,e.getDataAtCell(i,this.sortColumn+t)]);var s,a=e.getCellMeta(0,e.sortColumn);switch(a.type){case"date":s=n;break;default:s=o}this.sortIndex.sort(s(e.sortOrder));for(var i=this.sortIndex.length;i<e.countRows();i++)this.sortIndex.push([i,e.getDataAtCell(i,this.sortColumn+t)]);e.sortingEnabled=!0}},this.translateRow=function(e){var t=this;return t.sortingEnabled&&t.sortIndex&&t.sortIndex.length&&t.sortIndex[e]?t.sortIndex[e][0]:e},this.untranslateRow=function(e){var t=this;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length)for(var o=0;o<t.sortIndex.length;o++)if(t.sortIndex[o][0]==e)return o},this.getColHeader=function(e,o){this.getSettings().columnSorting&&e>=0&&t.Dom.addClass(o.querySelector(".colHeader"),"columnSorting")},this.afterCreateRow=function(e,t){var o=this;if(i(o)){for(var n=0;n<o.sortIndex.length;n++)o.sortIndex[n][0]>=e&&(o.sortIndex[n][0]+=t);for(var n=0;t>n;n++)o.sortIndex.splice(e+n,0,[e+n,o.getData()[e+n][o.sortColumn+o.colOffset()]]);s.call(o)}},this.afterRemoveRow=function(e,t){var o=this;if(i(o)){var n=r.translateRow.call(o,e);o.sortIndex.splice(e,t);for(var a=0;a<o.sortIndex.length;a++)o.sortIndex[a][0]>n&&(o.sortIndex[a][0]-=t);s.call(o)}},this.afterChangeSort=function(e){var t=this,o=!1,n={};if(e){for(var i=0;i<e.length;i++)if(e[i][1]==t.sortColumn){o=!0,n.row=r.translateRow.call(t,e[i][0]),n.col=e[i][1];break}o&&t._registerTimeout(setTimeout(function(){r.sort.call(t),t.render(),t.selectCell(r.untranslateRow.call(t,n.row),n.col)},0))}}}function i(e){var o=t.eventManager(e),n=function(e,t,o,n){n.setCellMeta(e,t,"comment",o),n.render()},i=function(e,t,o){n(e.from.row,e.from.col,t,o)},r=function(){var e=c();e.style.display="none",e.value=""},s=function(n){function s(t){if(o.removeEventListener(document,"mouseover"),"htCommentTextArea"!=t.target.className&&-1==t.target.innerHTML.indexOf("Comment")){var s=document.querySelector(".htCommentTextArea").value;s.trim().length>1&&i(n,s,e),a(),r()}}o.addEventListener(document,"mousedown",t.helper.proxy(s))},a=function(){o.removeEventListener(document,"mousedown"),o.addEventListener(document,"mousedown",t.helper.proxy(h))},l=function(o,n){var i=e.view.wt.wtTable.getCell(o.from),r=t.Dom.offset(i),a=e.getColWidth(o.from.col);n.style.position="absolute",n.style.left=r.left+a+"px",n.style.top=r.top+"px",n.style.zIndex=2,s(o,n)},c=function(e){var o=document.querySelector(".htComments");if(!o){o=document.createElement("DIV");var n=document.createElement("TEXTAREA");t.Dom.addClass(n,"htCommentTextArea"),o.appendChild(n),t.Dom.addClass(o,"htComments"),document.getElementsByTagName("body")[0].appendChild(o)}return e=e||"",document.querySelector(".htCommentTextArea").value=e,o},h=function(o){if(-1!=o.target.className.indexOf("htCommentCell")){a();var n=e.view.wt.wtTable.getCoords(o.target),i={from:new u(n.row,n.col)};t.Comments.showComment(i)}else"htCommentTextArea"!=o.target.className&&r()};return{init:function(){o.addEventListener(document,"mouseover",t.helper.proxy(h))},showComment:function(t){var o=e.getCellMeta(t.from.row,t.from.col),n="";o.comment&&(n=o.comment);var i=c(n);i.style.display="block",l(t,i)},removeComment:function(t,o){e.removeCellMeta(t,o,"comment"),e.render()},checkSelectionCommentsConsistency:function(){var t=!1,o=e.getSelectedRange().from;return e.getCellMeta(o.row,o.col).comment&&(t=!0),t}}}function r(t){var o,n=function(){e.localStorage[t+"__persistentStateKeys"]=JSON.stringify(o)},i=function(){var n=e.localStorage[t+"__persistentStateKeys"],i="string"==typeof n?JSON.parse(n):void 0;o=i?i:[]},r=function(){o=[],n()};i(),this.saveValue=function(i,r){e.localStorage[t+"_"+i]=JSON.stringify(r),-1==o.indexOf(i)&&(o.push(i),n())},this.loadValue=function(o,n){o="undefined"!=typeof o?o:n;var i=e.localStorage[t+"_"+o];return"undefined"==typeof i?void 0:JSON.parse(i)},this.reset=function(o){e.localStorage.removeItem(t+"_"+o)},this.resetAll=function(){for(var n=0;n<o.length;n++)e.localStorage.removeItem(t+"_"+o[n]);r()}}function s(){this.boundaries=null,this.callback=null}function a(){var e=[];return e.getInfo=function(e,t){for(var o=0,n=this.length;n>o;o++)if(this[o].row<=e&&this[o].row+this[o].rowspan-1>=e&&this[o].col<=t&&this[o].col+this[o].colspan-1>=t)return this[o]},e.setInfo=function(e){for(var t=0,o=this.length;o>t;t++)if(this[t].row===e.row&&this[t].col===e.col)return void(this[t]=e);this.push(e)},e.removeInfo=function(e,t){for(var o=0,n=this.length;n>o;o++)if(this[o].row===e&&this[o].col===t){this.splice(o,1);break}},e}function l(e){if(this.mergedCellInfoCollection=new a,Array.isArray(e))for(var t=0,o=e.length;o>t;t++)this.mergedCellInfoCollection.setInfo(e[t])}function c(){}function h(e,o){var n,i=function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};var e=10,t=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var o={position:"absolute",height:t+"px",width:t+"px","border-radius":parseInt(t/1.5,10)+"px"};for(var n in o)o.hasOwnProperty(n)&&(this.selectionHandles.styles.bottomRightHitArea[n]=o[n],this.selectionHandles.styles.topLeftHitArea[n]=o[n]);var i={position:"absolute",height:e+"px",width:e+"px","border-radius":parseInt(e/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var n in i)i.hasOwnProperty(n)&&(this.selectionHandles.styles.bottomRight[n]=i[n],this.selectionHandles.styles.topLeft[n]=i[n]);this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)};if(o){var r=t.eventManager(e);this.instance=e,this.settings=o,this.main=document.createElement("div"),n=this.main.style,n.position="absolute",n.top=0,n.left=0;for(var s=["top","left","bottom","right","corner"],a=0;5>a;a++){var l=s[a],c=document.createElement("DIV");c.className="wtBorder "+(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(c.className+=" hidden"),n=c.style,n.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:o.border.color,n.height=this.settings[l]&&this.settings[l].width?this.settings[l].width+"px":o.border.width+"px",n.width=this.settings[l]&&this.settings[l].width?this.settings[l].width+"px":o.border.width+"px",this.main.appendChild(c)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),t.mobileBrowser&&i.call(this),this.disappear(),e.wtTable.bordersHolder||(e.wtTable.bordersHolder=document.createElement("div"),e.wtTable.bordersHolder.className="htBorders",e.wtTable.hider.appendChild(e.wtTable.bordersHolder)),e.wtTable.bordersHolder.insertBefore(this.main,e.wtTable.bordersHolder.firstChild);var h=!1;r.addEventListener(document.body,"mousedown",function(){h=!0}),r.addEventListener(document.body,"mouseup",function(){h=!1});for(var u=0,d=this.main.childNodes.length;d>u;u++)r.addEventListener(this.main.childNodes[u],"mouseenter",function(t){if(h&&e.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),t.stopImmediatePropagation();var o=this.getBoundingClientRect();this.style.display="none";var n=function(e){return e.clientY<Math.floor(o.top)?!0:e.clientY>Math.ceil(o.top+o.height)?!0:e.clientX<Math.floor(o.left)?!0:e.clientX>Math.ceil(o.left+o.width)?!0:void 0},i=function(e){n(e)&&(r.removeEventListener(document.body,"mousemove",i),this.style.display="block")};r.addEventListener(document.body,"mousemove",i)}})}}function u(e,t){"undefined"!=typeof e&&"undefined"!=typeof t?(this.row=e,this.col=t):(this.row=null,this.col=null)}function d(e,t,o){this.highlight=e,this.from=t,this.to=o}function f(e,t,o){this.offset=e,this.total=t,this.countTH=o}function p(e,t,o,n){var i,r=0;for(this.instance=e,this.containerSizeFn=t,this.cellSizesSum=0,this.cellSizes=[],this.cellStretch=[],this.cellCount=0,this.visibleCellCount=0,this.remainingSize=0,this.strategy=n;;){if(i=o(r),void 0===i)break;this.cellSizesSum<this.getContainerSize()&&this.visibleCellCount++,this.cellSizes.push(i),this.cellSizesSum+=i,this.cellCount++,r++}var s=this.getContainerSize();this.remainingSize=this.cellSizesSum-s}function m(e){var o=[];if(this.guid="wt_"+w(),e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new k(this,e.table),this.wtScroll=new C(this),this.wtViewport=e.cloneSource.wtViewport,this.wtEvent=new v(this),this.selections=this.cloneSource.selections):(this.wtSettings=new T(this,e),this.wtTable=new k(this,e.table),this.wtScroll=new C(this),this.wtViewport=new D(this),this.wtEvent=new v(this),this.selections=this.getSetting("selections"),this.wtScrollbars=new S(this)),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;i>n;n++)o.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,n){t.Dom.fastInnerText(n,o[e])}])}this.drawn=!1,this.drawInterrupted=!1}function g(e){this.instance=e,this.init(),this.clone=this.makeClone("debug"),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",this.lastTimeout=null,t.Dom.addClass(this.clone.wtTable.holder.parentNode,"wtDebugVisible")}function v(o){var n=this,i=t.eventManager(o);this.instance=o;var r=[null,null];this.dblClickTimeout=[null,null];var s,a,l=function(e){var o=n.parentCell(e.target);t.Dom.hasClass(e.target,"corner")?n.instance.getSetting("onCellCornerMouseDown",e,e.target):o.TD&&n.instance.hasSetting("onCellMouseDown")&&n.instance.getSetting("onCellMouseDown",e,o.coords,o.TD,n.instance),2!==e.button&&o.TD&&(r[0]=o.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){r[0]=null},1e3))},c=function(e){n.instance.touchMoving=!0},h=function(e){i.addEventListener(this,"touchmove",c),n.checkIfTouchMove=setTimeout(function(){return n.instance.touchMoving===!0?(n.instance.touchMoving=void 0,void i.removeEventListener("touchmove",c,!1)):void l(e)},30)},u=function(e){if(n.instance.hasSetting("onCellMouseOver")){var o=n.instance.wtTable.TABLE,i=t.Dom.closest(e.target,["TD","TH"],o);i&&i!==a&&t.Dom.isChildOf(i,o)&&(a=i,n.instance.getSetting("onCellMouseOver",e,n.instance.wtTable.getCoords(i),i,n.instance))}},d=function(e){if(2!==e.button){var o=n.parentCell(e.target);o.TD===r[0]&&o.TD===r[1]?(t.Dom.hasClass(e.target,"corner")?n.instance.getSetting("onCellCornerDblClick",e,o.coords,o.TD,n.instance):n.instance.getSetting("onCellDblClick",e,o.coords,o.TD,n.instance),r[0]=null,r[1]=null):o.TD===r[0]&&(r[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){r[1]=null},500))}},f=function(e){clearTimeout(s),e.preventDefault(),d(e)};if(i.addEventListener(this.instance.wtTable.holder,"mousedown",l),i.addEventListener(this.instance.wtTable.TABLE,"mouseover",u),i.addEventListener(this.instance.wtTable.holder,"mouseup",d),this.instance.wtTable.holder.parentNode.parentNode&&t.mobileBrowser){var p="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");i.addEventListener(this.instance.wtTable.holder.parentNode.parentNode,"touchstart",function(e){n.instance.touchApplied=!0,t.Dom.isChildOf(e.target,p)&&h.call(e.target,e)}),i.addEventListener(this.instance.wtTable.holder.parentNode.parentNode,"touchend",function(e){n.instance.touchApplied=!1,t.Dom.isChildOf(e.target,p)&&f.call(e.target,e)}),n.instance.momentumScrolling||(n.instance.momentumScrolling={}),i.addEventListener(this.instance.wtTable.holder.parentNode.parentNode,"scroll",function(e){clearTimeout(n.instance.momentumScrolling._timeout),n.instance.momentumScrolling.ongoing||n.instance.getSetting("onBeforeTouchScroll"),n.instance.momentumScrolling.ongoing=!0,n.instance.momentumScrolling._timeout=setTimeout(function(){n.instance.touchApplied||(n.instance.momentumScrolling.ongoing=!1,n.instance.getSetting("onAfterMomentumScroll"))},200)})}i.addEventListener(e,"resize",function(){n.instance.draw()}),this.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1]),i.clear()}}function w(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function y(e,t,o){this.offset=e,this.total=t,this.countTH=o}function C(e){this.instance=e}function b(e){this.instance=e,this.type="corner",this.init(),this.clone=this.makeClone("corner")}function _(e){this.instance=e,this.type="horizontal",this.offset=0,this.init(),this.clone=this.makeClone("left")}function R(e){this.instance=e,this.type="vertical",this.init(),this.clone=this.makeClone("top")}function S(e){this.instance=e,e.update("scrollbarWidth",t.Dom.getScrollbarWidth()),e.update("scrollbarHeight",t.Dom.getScrollbarWidth()),this.vertical=new R(e),this.horizontal=new _(e),this.corner=new b(e),e.getSetting("debug")&&(this.debug=new g(e)),this.registerListeners()}function E(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={}}function T(e,o){var n=this;this.instance=e,this.defaults={table:void 0,debug:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,o,i){var r=n.getSetting("data",e,o);t.Dom.fastInnerText(i,void 0===r||null===r?"":r)},columnWidth:function(e){},rowHeight:function(e){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1},this.settings={};for(var i in this.defaults)if(this.defaults.hasOwnProperty(i))if(void 0!==o[i])this.settings[i]=o[i];else{if(void 0===this.defaults[i])throw new Error('A required setting "'+i+'" was not provided');this.settings[i]=this.defaults[i]}}function k(e,o){this.instance=e,this.TABLE=o,t.Dom.removeTextNodes(this.TABLE);var n=this.TABLE.parentNode;if(!n||1!==n.nodeType||!t.Dom.hasClass(n,"wtHolder")){var i=document.createElement("DIV");i.className="wtSpreader",n&&n.insertBefore(i,this.TABLE),i.appendChild(this.TABLE)}if(this.spreader=this.TABLE.parentNode,n=this.spreader.parentNode,!n||1!==n.nodeType||!t.Dom.hasClass(n,"wtHolder")){var r=document.createElement("DIV");r.className="wtHider",n&&n.insertBefore(r,this.spreader),r.appendChild(this.spreader)}if(this.hider=this.spreader.parentNode,this.hiderStyle=this.hider.style,this.hiderStyle.position="relative",n=this.hider.parentNode,!n||1!==n.nodeType||!t.Dom.hasClass(n,"wtHolder")){var s=document.createElement("DIV");s.style.position="relative",s.className="wtHolder",e.cloneSource||(s.className+=" ht_master"),n&&n.insertBefore(s,this.hider),s.appendChild(this.hider)}if(this.holder=this.hider.parentNode,this.isWorkingOnClone()||(this.holder.parentNode.style.position="relative"),this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0],this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0],this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0],this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.instance.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){var a=document.createElement("TR");this.THEAD.appendChild(a)}this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null}function x(e){this.wtTable=e,this.instance=e.instance,this.rowFilter=e.rowFilter,this.columnFilter=e.columnFilter,this.TABLE=e.TABLE,this.THEAD=e.THEAD,this.TBODY=e.TBODY,this.COLGROUP=e.COLGROUP,this.utils=x.utils}function D(o){this.instance=o,this.oversizedRows=[],this.oversizedCols=[],this.oversizedColumnHeaders=[];var n=this,i=t.eventManager(o);i.addEventListener(e,"resize",function(){n.clientHeight=n.getWorkspaceHeight()})}function A(e,t,o,n,i,r,s){function a(e,t){var n=0;if(d.stretchAllColumnsWidth[e]||(d.stretchAllColumnsWidth[e]=Math.round(t*d.stretchAllRatio)),d.stretchAllColumnsWidth.length===o&&d.needVerifyLastColumnWidth){d.needVerifyLastColumnWidth=!1;for(var i=0;i<d.stretchAllColumnsWidth.length;i++)n+=d.stretchAllColumnsWidth[i];n!=d.totalTargetWidth&&(d.stretchAllColumnsWidth[d.stretchAllColumnsWidth.length-1]+=d.totalTargetWidth-n)}return d.stretchAllColumnsWidth[e]}function l(e,t){return e===o-1?d.stretchLastWidth:null}var c,h,u,d=this,f=1,p=0,m=!0,g=50,v=[];for(this.scrollOffset=t,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.count=0,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],c=function(e){var t=n(e);return f=f||1,void 0===t&&(t=g),t},this.refreshStretching=function(e){for(var t,n,i=0,r=0;o>r;r++)t=c(r),i+=t;this.totalTargetWidth=e,n=i-e,"all"===this.stretch&&0>n?(this.stretchAllRatio=e/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0):"last"===this.stretch&&e!==1/0&&(this.stretchLastWidth=-n+c(o-1))},this.getStretchedColumnWidth=function(e,t){var o=null;return"all"===this.stretch&&0!==this.stretchAllRatio?o=a(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(o=l(e,t)),o},u=0;o>u;u++)if(h=c(u),t>=p&&!r&&(this.startColumn=u),p>=t&&t+e>=p+h&&(null==this.startColumn&&(this.startColumn=u),this.endColumn=u),v.push(p),p+=h,r||(this.endColumn=u),p>=t+e){m=!1;break}if(this.endColumn==o-1&&m)for(this.startColumn=this.endColumn;this.startColumn>0;){var w=v[this.endColumn]+h-v[this.startColumn-1];if((e>=w||!r)&&this.startColumn--,w>e)break}null!==this.startColumn&&i&&i(this),this.startPosition=v[this.startColumn],void 0==this.startPosition&&(this.startPosition=null),null!=this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}function O(e,t,o,n,i,r){this.scrollOffset=t,this.startRow=null,this.startPosition=null,this.endRow=null,this.count=0;for(var s,a=0,l=!0,c=23,h=[],u=0;o>u;u++)if(s=n(u),void 0===s&&(s=c),t>=a&&!r&&(this.startRow=u),a>=t&&t+e>=a+s&&(null==this.startRow&&(this.startRow=u),this.endRow=u),h.push(a),a+=s,r||(this.endRow=u),a>=t+e){l=!1;break}if(this.endRow==o-1&&l)for(this.startRow=this.endRow;this.startRow>0;){var d=h[this.endRow]+s-h[this.startRow-1];if((e>=d||!r)&&this.startRow--,d>=e)break}null!==this.startRow&&i&&i(this),this.startPosition=h[this.startRow],void 0==this.startPosition&&(this.startPosition=null),null!=this.startRow&&(this.count=this.endRow-this.startRow+1)}Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,o=Number(arguments[1])||0;for(o=0>o?Math.ceil(o):Math.floor(o),0>o&&(o+=t);t>o;o++)if(o in this&&this[o]===e)return o;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e,t){function o(e){return/NodeList/i.test(e.item)}function n(e){for(var t=[],o=0,n=e.length;n>o;o++)t[o]=e[o];return t}if("undefined"==typeof this||null===this)throw new TypeError;if("function"!=typeof e)throw new TypeError;t=t||this,o(t)&&(t=n(t));var i,r,s=t.length,a=[];for(i=0;s>i;i+=1)t.hasOwnProperty(i)&&(r=t[i],e.call(t,r,i,t)&&a.push(r));return a}),Array.isArray||(Array.isArray=function(e){return"[object Array]"==toString.call(e)}),Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=o.length;return function(i){if("object"!=typeof i&&("function"!=typeof i||null===i))throw new TypeError("Object.keys called on non-object");var r,s,a=[];for(r in i)e.call(i,r)&&a.push(r);if(t)for(s=0;n>s;s++)e.call(i,o[s])&&a.push(o[s]);return a}}()),/*
 * Copyright 2012 The Polymer Authors. All rights reserved.
 * Use of this source code is governed by a BSD-style
 * license that can be found in the LICENSE file.
 */
"undefined"==typeof WeakMap&&!function(){var t=Object.defineProperty;try{var o=!0;t(function(){},"foo",{})}catch(n){o=!1}var i=+new Date%1e9,r=function(){this.name="__st"+(1e9*Math.random()>>>0)+(i++ +"__"),o||(this._wmCache=[])};o?r.prototype={set:function(e,o){var n=e[this.name];n&&n[0]===e?n[1]=o:t(e,this.name,{value:[e,o],writable:!0})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},"delete":function(e){this.set(e,void 0)}}:r.prototype={set:function(e,t){if("undefined"!=typeof e&&"undefined"!=typeof t){for(var o=0,n=this._wmCache.length;n>o;o++)if(this._wmCache[o].key==e)return void(this._wmCache[o].value=t);this._wmCache.push({key:e,value:t})}},get:function(e){if("undefined"!=typeof e)for(var t=0,o=this._wmCache.length;o>t;t++)if(this._wmCache[t].key==e)return this._wmCache[t].value},"delete":function(e){if("undefined"!=typeof e)for(var t=0,o=this._wmCache.length;o>t;t++)this._wmCache[t].key==e&&Array.prototype.slice.call(this._wmCache,t,1)}},e.WeakMap=r}(),t.activeGuid=null,t.Core=function(e,o){function n(){var e=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==e&&(e=!0,this.onQueueEmpty())}}}function i(e,o,i){function r(){var n;e.length&&(n=t.hooks.run(w,"beforeChange",e,o),"function"==typeof n?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):n===!1&&e.splice(0,e.length)),i()}var s=new n;s.onQueueEmpty=r;for(var a=e.length-1;a>=0;a--)if(null===e[a])e.splice(a,1);else{var l=e[a][0],c=p.propToCol(e[a][1]),h=w.runHooks("modifyCol",c),u=w.getCellMeta(l,h);if("numeric"===u.type&&"string"==typeof e[a][3]&&e[a][3].length>0&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(e[a][3])||u.format)){var d=e[a][3].length;"undefined"==typeof u.language?numeral.language("en"):e[a][3].indexOf(".")===d-3&&-1===e[a][3].indexOf(",")?numeral.language("en"):numeral.language(u.language),numeral.validate(e[a][3])&&(e[a][3]=numeral().unformat(e[a][3]))}w.getCellValidator(u)&&(s.addValidatorToQueue(),w.validateCell(e[a][3],u,function(t,o){return function(n){if("boolean"!=typeof n)throw new Error("Validation error: result is not boolean");n===!1&&o.allowInvalid===!1&&(e.splice(t,1),o.valid=!0,--t),s.removeValidatorFormQueue()}}(a,u),o))}s.checkIfQueueIsEmpty()}function r(e,o){var n=e.length-1;if(!(0>n)){for(;n>=0;n--)if(null!==e[n]){if(null!=e[n][2]||null!=e[n][3]){if(f.settings.allowInsertRow)for(;e[n][0]>w.countRows()-1;)p.createRow();if("array"===w.dataType&&f.settings.allowInsertColumn)for(;p.propToCol(e[n][1])>w.countCols()-1;)p.createCol();p.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1);w.forceFullRender=!0,m.adjustRowsAndCols(),t.hooks.run(w,"beforeChangeRender",e,o),g.refreshBorders(null,!0),t.hooks.run(w,"afterChange",e,o||"edit")}}function s(e,t,o){return"object"==typeof e?e:[[e,t,o]]}function a(e){if(e.hasOwnProperty("type")){var o,n={};if("object"==typeof e.type)o=e.type;else if("string"==typeof e.type&&(o=t.cellTypes[e.type],void 0===o))throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var i in o)o.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(n[i]=o[i]);return n}}function l(e){return t.hooks.run(w,"modifyRow",e)}function c(e){return t.hooks.run(w,"modifyCol",e)}function h(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}var f,p,m,g,v,w=this,y=function(){},C=t.eventManager(w);t.helper.extend(y.prototype,H.prototype),t.helper.extend(y.prototype,o),t.helper.extend(y.prototype,a(o)),this.rootElement=e,this.container=document.createElement("DIV"),this.container.className="htContainer",e.insertBefore(this.container,e.firstChild),this.guid="ht_"+t.helper.randomString(),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),f={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new y,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},m={alter:function(e,t,o,n,i){var r;switch(o=o||1,e){case"insert_row":r=p.createRow(t,o),r&&(g.isSelected()&&f.selRange.from.row>=t?(f.selRange.from.row=f.selRange.from.row+r,g.transformEnd(r,0)):g.refreshBorders());break;case"insert_col":if(r=p.createCol(t,o)){if(Array.isArray(w.getSettings().colHeaders)){var s=[t,0];s.length+=r,Array.prototype.splice.apply(w.getSettings().colHeaders,s)}g.isSelected()&&f.selRange.from.col>=t?(f.selRange.from.col=f.selRange.from.col+r,g.transformEnd(0,r)):g.refreshBorders()}break;case"remove_row":t=w.runHooks("modifyCol",t),p.removeRow(t,o),f.cellSettings.splice(t,o),m.adjustRowsAndCols(),g.refreshBorders();break;case"remove_col":p.removeCol(t,o);for(var a=0,l=p.getAll().length;l>a;a++)a in f.cellSettings&&f.cellSettings[a].splice(t,o);Array.isArray(w.getSettings().colHeaders)&&("undefined"==typeof t&&(t=-1),w.getSettings().colHeaders.splice(t,o)),m.adjustRowsAndCols(),g.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"')}i||m.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t,o,n;if(t=w.countRows(),t<f.settings.minRows)for(e=0;e<f.settings.minRows-t;e++)p.createRow(w.countRows(),1,!0);if(o=w.countEmptyRows(!0),o<f.settings.minSpareRows)for(;o<f.settings.minSpareRows&&w.countRows()<f.settings.maxRows;o++)p.createRow(w.countRows(),1,!0);if(n=w.countEmptyCols(!0),!f.settings.columns&&w.countCols()<f.settings.minCols)for(;w.countCols()<f.settings.minCols;n++)p.createCol(w.countCols(),1,!0);if(!f.settings.columns&&"array"===w.dataType&&n<f.settings.minSpareCols)for(;n<f.settings.minSpareCols&&w.countCols()<f.settings.maxCols;n++)p.createCol(w.countCols(),1,!0);var i=w.countRows(),r=w.countCols();if((0===i||0===r)&&g.deselect(),g.isSelected()){var s,a=f.selRange.from.row,l=f.selRange.from.col,c=f.selRange.to.row,h=f.selRange.to.col;a>i-1?(a=i-1,s=!0,c>a&&(c=a)):c>i-1&&(c=i-1,s=!0,a>c&&(a=c)),l>r-1?(l=r-1,s=!0,h>l&&(h=l)):h>r-1&&(h=r-1,s=!0,l>h&&(l=h)),s&&w.selectCell(a,l,c,h)}},populateFromArray:function(e,o,n,i,r,s,a){var l,c,h,u,d=[],p={};if(c=o.length,0===c)return!1;var m,g,v,y;switch(r){case"shift_down":for(m=n?n.col-e.col+1:0,g=n?n.row-e.row+1:0,o=t.helper.translateRowsToColumns(o),h=0,u=o.length,v=Math.max(u,m);v>h;h++)if(u>h){for(l=0,c=o[h].length;g-c>l;l++)o[h].push(o[h][l%c]);o[h].unshift(e.col+h,e.row,0),w.spliceCol.apply(w,o[h])}else o[h%u][0]=e.col+h,w.spliceCol.apply(w,o[h%u]);break;case"shift_right":for(m=n?n.col-e.col+1:0,g=n?n.row-e.row+1:0,l=0,c=o.length,y=Math.max(c,g);y>l;l++)if(c>l){for(h=0,u=o[l].length;m-u>h;h++)o[l].push(o[l][h%u]);o[l].unshift(e.row+l,e.col,0),w.spliceRow.apply(w,o[l])}else o[l%c][0]=e.row+l,w.spliceRow.apply(w,o[l%c]);break;case"overwrite":default:p.row=e.row,p.col=e.col;var C={row:0,col:0},b={row:n&&e?n.row-e.row+1:1,col:n&&e?n.col-e.col+1:1};for(-1!==["up","left"].indexOf(s)?C={row:Math.ceil(b.row/c)||1,col:Math.ceil(b.col/o[0].length)||1}:-1!==["down","right"].indexOf(s)&&(C={row:1,col:1}),l=0;c>l&&!(n&&p.row>n.row||!f.settings.allowInsertRow&&p.row>w.countRows()-1||p.row>=f.settings.maxRows);l++){for(p.col=e.col,u=o[l]?o[l].length:0,h=0;u>h&&!(n&&p.col>n.col||!f.settings.allowInsertColumn&&p.col>w.countCols()-1||p.col>=f.settings.maxCols);h++){if(!w.getCellMeta(p.row,p.col).readOnly){var _,R=o[l][h],S={row:l,col:h};"autofill"===i&&(_=w.runHooks("beforeAutofillInsidePopulate",S,s,o,a,C,b),_&&(C="undefined"!=typeof _.iterators?_.iterators:C,R="undefined"!=typeof _.value?_.value:R)),d.push([p.row,p.col,R])}p.col++,n&&h===u-1&&(h=-1,-1!==["down","right"].indexOf(s)?C.col++:-1!==["up","left"].indexOf(s)&&C.col>1&&C.col--)}p.row++,C.col=1,n&&l===c-1&&(l=-1,-1!==["down","right"].indexOf(s)?C.row++:-1!==["up","left"].indexOf(s)&&C.row>1&&C.row--)}w.setDataAtCell(d,null,null,i||"populateFromArray")}}},this.selection=g={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(e,t){w.selection.selectedHeader.rows=e,w.selection.selectedHeader.cols=t},begin:function(){w.selection.inProgress=!0},finish:function(){var e=w.getSelected();t.hooks.run(w,"afterSelectionEnd",e[0],e[1],e[2],e[3]),t.hooks.run(w,"afterSelectionEndByProp",e[0],w.colToProp(e[1]),e[2],w.colToProp(e[3])),w.selection.inProgress=!1},isInProgress:function(){return w.selection.inProgress},setRangeStart:function(e,o){t.hooks.run(w,"beforeSetRangeStart",e),f.selRange=new d(e,e,e),g.setRangeEnd(e,null,o)},setRangeEnd:function(e,o,n){t.hooks.run(w,"beforeSetRangeEnd",e),w.selection.begin(),f.selRange.to=new u(e.row,e.col),f.settings.multiSelect||(f.selRange.from=e),w.view.wt.selections.current.clear(),w.view.wt.selections.current.add(f.selRange.highlight),w.view.wt.selections.area.clear(),g.isMultiple()&&(w.view.wt.selections.area.add(f.selRange.from),w.view.wt.selections.area.add(f.selRange.to)),(f.settings.currentRowClassName||f.settings.currentColClassName)&&(w.view.wt.selections.highlight.clear(),w.view.wt.selections.highlight.add(f.selRange.from),w.view.wt.selections.highlight.add(f.selRange.to)),t.hooks.run(w,"afterSelection",f.selRange.from.row,f.selRange.from.col,f.selRange.to.row,f.selRange.to.col),t.hooks.run(w,"afterSelectionByProp",f.selRange.from.row,p.colToProp(f.selRange.from.col),f.selRange.to.row,p.colToProp(f.selRange.to.col)),o!==!1&&w.view.mainViewIsActive()&&(f.selRange.from?w.view.scrollViewport(f.selRange.from):w.view.scrollViewport(e)),g.refreshBorders(null,n)},refreshBorders:function(e,t){t||v.destroyEditor(e),w.view.render(),g.isSelected()&&!t&&v.prepareEditor()},isMultiple:function(){var e=!(f.selRange.to.col===f.selRange.from.col&&f.selRange.to.row===f.selRange.from.row),o=t.hooks.run(w,"afterIsMultipleSelection",e);return e?o:void 0},transformStart:function(e,t,o,n){var i=new u(e,t);w.runHooks("modifyTransformStart",i),f.selRange.highlight.row+e>w.countRows()-1?o&&f.settings.minSpareRows>0?w.alter("insert_row",w.countRows()):f.settings.autoWrapCol&&(i.row=1-w.countRows(),i.col=f.selRange.highlight.col+i.col==w.countCols()-1?1-w.countCols():1):f.settings.autoWrapCol&&f.selRange.highlight.row+i.row<0&&f.selRange.highlight.col+i.col>=0&&(i.row=w.countRows()-1,i.col=f.selRange.highlight.col+i.col==0?w.countCols()-1:-1),f.selRange.highlight.col+i.col>w.countCols()-1?o&&f.settings.minSpareCols>0?w.alter("insert_col",w.countCols()):f.settings.autoWrapRow&&(i.row=f.selRange.highlight.row+i.row==w.countRows()-1?1-w.countRows():1,i.col=1-w.countCols()):f.settings.autoWrapRow&&f.selRange.highlight.col+i.col<0&&f.selRange.highlight.row+i.row>=0&&(i.row=f.selRange.highlight.row+i.row==0?w.countRows()-1:-1,i.col=w.countCols()-1);var r=w.countRows(),s=w.countCols(),a=new u(f.selRange.highlight.row+i.row,f.selRange.highlight.col+i.col);a.row<0?a.row=0:a.row>0&&a.row>=r&&(a.row=r-1),a.col<0?a.col=0:a.col>0&&a.col>=s&&(a.col=s-1),g.setRangeStart(a,n)},transformEnd:function(e,t){var o=new u(e,t);w.runHooks("modifyTransformEnd",o);var n=w.countRows(),i=w.countCols(),r=new u(f.selRange.to.row+o.row,f.selRange.to.col+o.col);r.row<0?r.row=0:r.row>0&&r.row>=n&&(r.row=n-1),r.col<0?r.col=0:r.col>0&&r.col>=i&&(r.col=i-1),g.setRangeEnd(r)},isSelected:function(){return null!==f.selRange},inInSelection:function(e){return g.isSelected()?f.selRange.includes(e):!1},deselect:function(){g.isSelected()&&(w.selection.inProgress=!1,f.selRange=null,w.view.wt.selections.current.clear(),w.view.wt.selections.area.clear(),(f.settings.currentRowClassName||f.settings.currentColClassName)&&w.view.wt.selections.highlight.clear(),v.destroyEditor(),g.refreshBorders(),t.hooks.run(w,"afterDeselect"))},selectAll:function(){f.settings.multiSelect&&(g.setRangeStart(new u(0,0)),g.setRangeEnd(new u(w.countRows()-1,w.countCols()-1),!1))},empty:function(){if(g.isSelected()){var e,t,o=f.selRange.getTopLeftCorner(),n=f.selRange.getBottomRightCorner(),i=[];for(e=o.row;e<=n.row;e++)for(t=o.col;t<=n.col;t++)w.getCellMeta(e,t).readOnly||i.push([e,t,""]);w.setDataAtCell(i)}}},this.init=function(){t.hooks.run(w,"beforeInit"),t.mobileBrowser&&t.Dom.addClass(w.rootElement,"mobile"),this.updateSettings(f.settings,!0),this.view=new t.TableView(this),v=new t.EditorManager(w,f,g,p),this.forceFullRender=!0,this.view.render(),"object"==typeof f.firstRun&&(t.hooks.run(w,"afterChange",f.firstRun[0],f.firstRun[1]),f.firstRun=!1),t.hooks.run(w,"afterInit")},this.validateCell=function(e,o,n,i){var r=w.getCellValidator(o);"[object RegExp]"===Object.prototype.toString.call(r)&&(r=function(e){return function(t,o){o(e.test(t))}}(r)),"function"==typeof r?(e=t.hooks.run(w,"beforeValidate",e,o.row,o.prop,i),w._registerTimeout(setTimeout(function(){r.call(o,e,function(r){r=t.hooks.run(w,"afterValidate",r,e,o.row,o.prop,i),o.valid=r,n(r),t.hooks.run(w,"postAfterValidate",r,e,o.row,o.prop,i)})},0))):(o.valid=!0,n(!0))},this.setDataAtCell=function(e,t,o,n){var a,l,c,h=s(e,t,o),u=[];for(a=0,l=h.length;l>a;a++){if("object"!=typeof h[a])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof h[a][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=p.colToProp(h[a][1]),u.push([h[a][0],c,p.get(h[a][0],c),h[a][2]])}n||"object"!=typeof e||(n=t),i(u,n,function(){r(u,n)})},this.setDataAtRowProp=function(e,t,o,n){var a,l,c=s(e,t,o),h=[];for(a=0,l=c.length;l>a;a++)h.push([c[a][0],c[a][1],p.get(c[a][0],c[a][1]),c[a][2]]);n||"object"!=typeof e||(n=t),i(h,n,function(){r(h,n)})},this.listen=function(){t.activeGuid=w.guid,document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()},this.unlisten=function(){t.activeGuid=null},this.isListening=function(){return t.activeGuid===w.guid},this.destroyEditor=function(e){g.refreshBorders(e)},this.populateFromArray=function(e,t,o,n,i,r,s,a,l){var c;if("object"!=typeof o||"object"!=typeof o[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return c="number"==typeof n?new u(n,i):null,m.populateFromArray(new u(e,t),o,c,r,s,a,l)},this.spliceCol=function(e,t,o){return p.spliceCol.apply(p,arguments)},this.spliceRow=function(e,t,o){return p.spliceRow.apply(p,arguments)},this.getSelected=function(){return g.isSelected()?[f.selRange.from.row,f.selRange.from.col,f.selRange.to.row,f.selRange.to.col]:void 0},this.getSelectedRange=function(){return g.isSelected()?f.selRange:void 0},this.render=function(){w.view&&(w.forceFullRender=!0,g.refreshBorders(null,!0))},this.loadData=function(e){function o(){f.cellSettings.length=0}if("object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof e+" given)");e=[];for(var n,i=0,r=f.settings.startRows;r>i;i++){n=[];for(var s=0,a=f.settings.startCols;a>s;s++)n.push(null);e.push(n)}}f.isPopulated=!1,y.prototype.data=e,Array.isArray(f.settings.dataSchema)||Array.isArray(e[0])?w.dataType="array":"function"==typeof f.settings.dataSchema?w.dataType="function":w.dataType="object",p=new t.DataMap(w,f,y),o(),m.adjustRowsAndCols(),t.hooks.run(w,"afterLoadData"),f.firstRun?f.firstRun=[null,"loadData"]:(t.hooks.run(w,"afterChange",null,"loadData"),w.render()),f.isPopulated=!0},this.getData=function(e,t,o,n){return"undefined"==typeof e?p.getAll():p.getRange(new u(e,t),new u(o,n),p.DESTINATION_RENDERER)},this.getCopyableData=function(e,t,o,n){return p.getCopyableText(new u(e,t),new u(o,n))},this.updateSettings=function(e,o){var n,i;if("undefined"!=typeof e.rows)throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if("undefined"!=typeof e.cols)throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(n in e)"data"!==n&&(void 0!==t.hooks.hooks[n]||void 0!==t.hooks.legacy[n]?("function"==typeof e[n]||Array.isArray(e[n]))&&w.addHook(n,e[n]):!o&&e.hasOwnProperty(n)&&(y.prototype[n]=e[n]));if(void 0===e.data&&void 0===f.settings.data?w.loadData(null):void 0!==e.data?w.loadData(e.data):void 0!==e.columns&&p.createMap(),i=w.countCols(),f.cellSettings.length=0,i>0){var r,s;for(n=0;i>n;n++)f.columnSettings[n]=t.helper.columnFactory(y,f.columnsSettingConflicts),r=f.columnSettings[n].prototype,y.prototype.columns&&(s=y.prototype.columns[n],t.helper.extend(r,s),t.helper.extend(r,a(s)))}if("undefined"!=typeof e.cell)for(n in e.cell){var l=e.cell[n];w.setCellMetaObject(l.row,l.col,l)}if(t.hooks.run(w,"afterCellMetaReset"),"undefined"!=typeof e.className&&(y.prototype.className&&t.Dom.removeClass(w.rootElement,y.prototype.className),e.className&&t.Dom.addClass(w.rootElement,e.className)),"undefined"!=typeof e.height){var c=e.height;"function"==typeof c&&(c=c()),w.rootElement.style.height=c+"px"}if("undefined"!=typeof e.width){var h=e.width;"function"==typeof h&&(h=h()),w.rootElement.style.width=h+"px"}c&&(w.rootElement.style.overflow="auto"),o||t.hooks.run(w,"afterUpdateSettings"),m.adjustRowsAndCols(),w.view&&!f.firstRun&&(w.forceFullRender=!0,g.refreshBorders(null,!0))},this.getValue=function(){var e=w.getSelected();if(y.prototype.getValue){if("function"==typeof y.prototype.getValue)return y.prototype.getValue.call(w);if(e)return w.getData()[e[0]][y.prototype.getValue]}else if(e)return w.getDataAtCell(e[0],e[1])},this.getSettings=function(){return f.settings},this.clear=function(){g.selectAll(),g.empty()},this.alter=function(e,t,o,n,i){m.alter(e,t,o,n,i)},this.getCell=function(e,t,o){return w.view.getCellAtCoords(new u(e,t),o)},this.getCoords=function(e){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,e)},this.colToProp=function(e){return p.colToProp(e)},this.propToCol=function(e){return p.propToCol(e)},this.getDataAtCell=function(e,t){return p.get(e,p.colToProp(t))},this.getDataAtRowProp=function(e,t){return p.get(e,t)},this.getDataAtCol=function(e){var t=[];return t.concat.apply(t,p.getRange(new u(0,e),new u(f.settings.data.length-1,e),p.DESTINATION_RENDERER))},this.getDataAtProp=function(e){var t,o=[];return t=p.getRange(new u(0,p.propToCol(e)),new u(f.settings.data.length-1,p.propToCol(e)),p.DESTINATION_RENDERER),o.concat.apply(o,t)},this.getSourceDataAtCol=function(e){for(var t=[],o=f.settings.data,n=0;n<o.length;n++)t.push(o[n][e]);return t},this.getSourceDataAtRow=function(e){return f.settings.data[e]},this.getDataAtRow=function(e){var t=p.getRange(new u(e,0),new u(e,this.countCols()-1),p.DESTINATION_RENDERER);return t[0]},this.removeCellMeta=function(e,t,o){var n=w.getCellMeta(e,t);void 0!=n[o]&&delete f.cellSettings[e][t][o]},this.setCellMetaObject=function(e,t,o){if("object"==typeof o)for(var n in o){var i=o[n];this.setCellMeta(e,t,n,i)}},this.setCellMeta=function(e,o,n,i){f.cellSettings[e]||(f.cellSettings[e]=[]),f.cellSettings[e][o]||(f.cellSettings[e][o]=new f.columnSettings[o]),f.cellSettings[e][o][n]=i,t.hooks.run(w,"afterSetCellMeta",e,o,n,i)},this.getCellMeta=function(e,o){var n,i=p.colToProp(o);if(e=l(e),o=c(o),f.columnSettings[o]||(f.columnSettings[o]=t.helper.columnFactory(y,f.columnsSettingConflicts)),f.cellSettings[e]||(f.cellSettings[e]=[]),f.cellSettings[e][o]||(f.cellSettings[e][o]=new f.columnSettings[o]),n=f.cellSettings[e][o],n.row=e,n.col=o,n.prop=i,n.instance=w,t.hooks.run(w,"beforeGetCellMeta",e,o,n),t.helper.extend(n,a(n)),n.cells){var r=n.cells.call(n,e,o,i);r&&(t.helper.extend(n,r),t.helper.extend(n,a(r)))}return t.hooks.run(w,"afterGetCellMeta",e,o,n),n};var b=t.helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(e,o){var n=b.call(this,e,o);return t.renderers.getRenderer(n)},this.getCellEditor=t.helper.cellMethodLookupFactory("editor"),this.getCellValidator=t.helper.cellMethodLookupFactory("validator"),this.validateCells=function(e){var t=new n;t.onQueueEmpty=e;for(var o=w.countRows()-1;o>=0;){for(var i=w.countCols()-1;i>=0;)t.addValidatorToQueue(),w.validateCell(w.getDataAtCell(o,i),w.getCellMeta(o,i),function(){t.removeValidatorFormQueue()},"validateCells"),i--;o--}t.checkIfQueueIsEmpty()},this.getRowHeader=function(e){if(void 0===e){for(var t=[],o=0,n=w.countRows();n>o;o++)t.push(w.getRowHeader(o));return t}return Array.isArray(f.settings.rowHeaders)&&void 0!==f.settings.rowHeaders[e]?f.settings.rowHeaders[e]:"function"==typeof f.settings.rowHeaders?f.settings.rowHeaders(e):f.settings.rowHeaders&&"string"!=typeof f.settings.rowHeaders&&"number"!=typeof f.settings.rowHeaders?e+1:f.settings.rowHeaders},this.hasRowHeaders=function(){return!!f.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==f.settings.colHeaders&&null!==f.settings.colHeaders)return!!f.settings.colHeaders;for(var e=0,t=w.countCols();t>e;e++)if(w.getColHeader(e))return!0;return!1},this.getColHeader=function(e){if(void 0===e){for(var o=[],n=0,i=w.countCols();i>n;n++)o.push(w.getColHeader(n));return o}var r=e;return e=t.hooks.run(w,"modifyCol",e),f.settings.columns&&f.settings.columns[e]&&f.settings.columns[e].title?f.settings.columns[e].title:Array.isArray(f.settings.colHeaders)&&void 0!==f.settings.colHeaders[e]?f.settings.colHeaders[e]:"function"==typeof f.settings.colHeaders?f.settings.colHeaders(e):f.settings.colHeaders&&"string"!=typeof f.settings.colHeaders&&"number"!=typeof f.settings.colHeaders?t.helper.spreadsheetColumnLabel(r):f.settings.colHeaders},this._getColWidthFromSettings=function(e){var t=w.getCellMeta(0,e),o=t.width;if((void 0===o||o===f.settings.width)&&(o=t.colWidths),void 0!==o&&null!==o){switch(typeof o){case"object":o=o[e];break;case"function":o=o(e)}"string"==typeof o&&(o=parseInt(o,10))}return o},this.getColWidth=function(e){var o=w._getColWidthFromSettings(e);return o||(o=50),o=t.hooks.run(w,"modifyColWidth",o,e)},this._getRowHeightFromSettings=function(e){var t=f.settings.rowHeights;if(void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var o=w._getRowHeightFromSettings(e);return o=t.hooks.run(w,"modifyRowHeight",o,e)},this.countRows=function(){return f.settings.data.length},this.countCols=function(){return"object"===w.dataType||"function"===w.dataType?f.settings.columns&&f.settings.columns.length?f.settings.columns.length:p.colToPropCache.length:"array"===w.dataType?f.settings.columns&&f.settings.columns.length?f.settings.columns.length:f.settings.data&&f.settings.data[0]&&f.settings.data[0].length?f.settings.data[0].length:0:void 0},this.rowOffset=function(){return w.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return w.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return w.view.wt.drawn?w.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return w.view.wt.drawn?w.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return w.view.wt.drawn?w.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return w.view.wt.drawn?w.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(e){for(var o,n=w.countRows()-1,i=0;n>=0;){if(o=t.hooks.run(this,"modifyRow",n),w.isEmptyRow(o))i++;else if(e)break;n--}return i},this.countEmptyCols=function(e){if(w.countRows()<1)return 0;for(var t=w.countCols()-1,o=0;t>=0;){if(w.isEmptyCol(t))o++;else if(e)break;t--}return o},this.isEmptyRow=function(e){return f.settings.isEmptyRow.call(w,e)},this.isEmptyCol=function(e){return f.settings.isEmptyCol.call(w,e)},this.selectCell=function(e,t,o,n,i){if("number"!=typeof e||0>e||e>=w.countRows())return!1;if("number"!=typeof t||0>t||t>=w.countCols())return!1;if("undefined"!=typeof o){if("number"!=typeof o||0>o||o>=w.countRows())return!1;if("number"!=typeof n||0>n||n>=w.countCols())return!1}var r=new u(e,t);return f.selRange=new d(r,r,r),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),w.listen(),"undefined"==typeof o?g.setRangeEnd(f.selRange.from,i):g.setRangeEnd(new u(o,n),i),w.selection.finish(),!0},this.selectCellByProp=function(e,t,o,n,i){return arguments[1]=p.propToCol(arguments[1]),"undefined"!=typeof arguments[3]&&(arguments[3]=p.propToCol(arguments[3])),w.selectCell.apply(w,arguments)},this.deselectCell=function(){g.deselect()},this.destroy=function(){w._clearTimeouts(),w.view&&w.view.destroy(),t.Dom.empty(w.rootElement),C.clear(),t.hooks.run(w,"afterDestroy"),t.hooks.destroy(w);for(var e in w)w.hasOwnProperty(e)&&("function"==typeof w[e]?"runHooks"!==e&&(w[e]=h):"guid"!==e&&(w[e]=null));f=null,p=null,m=null,g=null,v=null,w=null,y=null},this.getActiveEditor=function(){return v.getActiveEditor()},this.getInstance=function(){return w},this.addHook=function(e,o){t.hooks.add(e,o,w)},this.addHookOnce=function(e,o){t.hooks.once(e,o,w)},this.removeHook=function(e,o){t.hooks.remove(e,o,w)},this.runHooks=function(e,o,n,i,r,s,a){return t.hooks.run(w,e,o,n,i,r,s,a)},this.timeouts=[],this._registerTimeout=function(e){this.timeouts.push(e)},this._clearTimeouts=function(){for(var e=0,t=this.timeouts.length;t>e;e++)clearTimeout(this.timeouts[e])},this.version="0.12.4"};var H=function(){};if(H.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,colWidths:void 0,columns:void 0,cells:void 0,cell:[],minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"none",isEmptyRow:function(e){for(var t,o=0,n=this.countCols();n>o;o++)if(t=this.getDataAtCell(e,o),""!==t&&null!==t&&"undefined"!=typeof t)return!1;return!0},isEmptyCol:function(e){for(var t,o=0,n=this.countRows();n>o;o++)if(t=this.getDataAtCell(o,e),""!==t&&null!==t&&"undefined"!=typeof t)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,type:"text",copyable:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,manualColumnFreeze:void 0,viewportRowRenderingOffset:10,viewportColumnRenderingOffset:10,groups:void 0},t.DefaultSettings=H,function(e){function t(){function e(e){return null!==e&&!o(e)&&("string"==typeof e||"number"==typeof e)}function t(e){return null!==e&&("object"==typeof e||"function"==typeof e)}function o(e){return e!==e}var n={arrayMap:[],weakMap:new WeakMap};return{get:function(o){return e(o)?n.arrayMap[o]:t(o)?n.weakMap.get(o):void 0},set:function(o,i){if(e(o))n.arrayMap[o]=i;else{if(!t(o))throw new Error("Invalid key type");n.weakMap.set(o,i)}},"delete":function(o){e(o)?delete n.arrayMap[o]:t(o)&&n.weakMap["delete"](o)}}}e.MultiMap||(e.MultiMap=t)}(e),!e.Handsontable)var t={};if(t.Dom={},t.Dom.enableImmediatePropagation=function(e){null!=e&&null==e.isImmediatePropagationEnabled&&(e.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1,this.cancelBubble=!0},e.isImmediatePropagationEnabled=!0,e.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled})},t.Dom.closest=function(e,t,o){for(;null!=e&&e!==o;){if(1===e.nodeType&&t.indexOf(e.nodeName)>-1)return e;e=e.parentNode}return null},t.Dom.isChildOf=function(e,t){var o=e.parentNode,n=[];for("string"==typeof t?n=Array.prototype.slice.call(document.querySelectorAll(t),0):n.push(t);null!=o;){if(n.indexOf(o)>-1)return!0;o=o.parentNode}return!1},t.Dom.index=function(e){var t=0;if(e.previousSibling)for(;e=e.previousSibling;)++t;return t},document.documentElement.classList?(t.Dom.hasClass=function(e,t){return e.classList.contains(t)},t.Dom.addClass=function(e,t){t&&e.classList.add(t)},t.Dom.removeClass=function(e,t){e.classList.remove(t)}):(t.Dom.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},t.Dom.addClass=function(e,t){""===e.className?e.className=t:this.hasClass(e,t)||(e.className+=" "+t)},t.Dom.removeClass=function(e,t){if(this.hasClass(e,t)){var o=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(o," ").trim()}}),t.Dom.removeTextNodes=function(e,t){if(3===e.nodeType)t.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var o=e.childNodes,n=o.length-1;n>=0;n--)this.removeTextNodes(o[n],e)},t.Dom.empty=function(e){for(var t;t=e.lastChild;)e.removeChild(t)},t.Dom.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,t.Dom.fastInnerHTML=function(e,t){this.HTML_CHARACTERS.test(t)?e.innerHTML=t:this.fastInnerText(e,t)},document.createTextNode("test").textContent?t.Dom.fastInnerText=function(e,t){var o=e.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=t:(this.empty(e),e.appendChild(document.createTextNode(t)))}:t.Dom.fastInnerText=function(e,t){var o=e.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.data=t:(this.empty(e),e.appendChild(document.createTextNode(t)))},t.Dom.isVisible=function(e){for(var o=e;o!==document.documentElement;){if(null===o)return!1;if(11===o.nodeType){if(o.host){if(o.host.impl)return t.Dom.isVisible(o.host.impl);if(o.host)return t.Dom.isVisible(o.host);throw new Error("Lost in Web Components world")}return!1}if("none"===o.style.display)return!1;o=o.parentNode}return!0},t.Dom.offset=function(t){var o,n,i,r,s;if(r=document.documentElement,this.hasCaptionProblem()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName)return s=t.getBoundingClientRect(),{top:s.top+(e.pageYOffset||r.scrollTop)-(r.clientTop||0),left:s.left+(e.pageXOffset||r.scrollLeft)-(r.clientLeft||0)};for(o=t.offsetLeft,n=t.offsetTop,i=t;(t=t.offsetParent)&&t!==document.body;)o+=t.offsetLeft,n+=t.offsetTop,i=t;return i&&"fixed"===i.style.position&&(o+=e.pageXOffset||r.scrollLeft,n+=e.pageYOffset||r.scrollTop),{left:o,top:n}},t.Dom.getWindowScrollTop=function(){var t=e.scrollY;return void 0==t&&(t=document.documentElement.scrollTop),t},t.Dom.getWindowScrollLeft=function(){var t=e.scrollX;return void 0==t&&(t=document.documentElement.scrollLeft),t},t.Dom.getScrollTop=function(o){return o===e?t.Dom.getWindowScrollTop(o):o.scrollTop},t.Dom.getScrollLeft=function(o){return o===e?t.Dom.getWindowScrollLeft(o):o.scrollLeft},t.Dom.getScrollableElement=function(t){for(var o,n,i,r=t.parentNode,s=["auto","scroll"];r&&r.style;){if(o=r.style.overflow,n=r.style.overflowX,i=r.style.overflowY,"scroll"==o||"scroll"==n||"scroll"==i)return r;if(r.clientHeight<r.scrollHeight&&(-1!==s.indexOf(i)||-1!==s.indexOf(o)))return r;if(r.clientWidth<r.scrollWidth&&(-1!==s.indexOf(n)||-1!==s.indexOf(o)))return r;r=r.parentNode}return e},t.Dom.getComputedStyle=function(e){return e.currentStyle||document.defaultView.getComputedStyle(e)},t.Dom.outerWidth=function(e){return e.offsetWidth},t.Dom.outerHeight=function(e){return this.hasCaptionProblem()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight},t.Dom.innerHeight=function(e){return e.clientHeight||e.innerHeight},t.Dom.innerWidth=function(e){return e.clientWidth||e.innerWidth},t.Dom.addEvent=function(t,o,n){e.addEventListener?t.addEventListener(o,n,!1):t.attachEvent("on"+o,n)},t.Dom.removeEvent=function(t,o,n){e.removeEventListener?t.removeEventListener(o,n,!1):t.detachEvent("on"+o,n)},function(){function e(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var o=document.createElement("CAPTION");o.innerHTML="c<br>c<br>c<br>c",o.style.padding=0,o.style.margin=0,e.insertBefore(o,t),document.body.appendChild(e),n=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function o(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",
t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),(document.body||document.documentElement).appendChild(t);var o=e.offsetWidth;t.style.overflow="scroll";var n=e.offsetWidth;return o==n&&(n=t.clientWidth),(document.body||document.documentElement).removeChild(t),o-n}var n;t.Dom.hasCaptionProblem=function(){return void 0===n&&e(),n},t.Dom.getCaretPosition=function(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var o=e.createTextRange(),n=o.duplicate();return o.moveToBookmark(t.getBookmark()),n.setEndPoint("EndToStart",o),n.text.length}return 0},t.Dom.getSelectionEndPosition=function(e){if(e.selectionEnd)return e.selectionEnd;if(document.selection){var t=document.selection.createRange();if(null==t)return 0;var o=e.createTextRange();return o.text.indexOf(t.text)+t.text.length}},t.Dom.setCaretPosition=function(e,t,o){if(void 0===o&&(o=t),e.setSelectionRange)e.focus(),e.setSelectionRange(t,o);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",o),n.moveStart("character",t),n.select()}};var i;t.Dom.getScrollbarWidth=function(){return void 0===i&&(i=o()),i};var r=!document.createTextNode("test").textContent;t.Dom.isIE8=function(){return r};var s=!!document.documentMode;t.Dom.isIE9=function(){return s};var a=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);t.Dom.isSafari=function(){return a},t.Dom.setOverlayPosition=function(e,t,o){r||s?(e.style.top=o,e.style.left=t):a?e.style["-webkit-transform"]="translate3d("+t+","+o+",0)":e.style.transform="translate3d("+t+","+o+",0)"},t.Dom.getCssTransform=function(e){var t;return e.style.transform&&""!=(t=e.style.transform)?["transform",t]:e.style["-webkit-transform"]&&""!=(t=e.style["-webkit-transform"])?["-webkit-transform",t]:-1},t.Dom.resetCssTransform=function(e){e.transform&&""!=e.transform?e.transform="":e["-webkit-transform"]&&""!=e["-webkit-transform"]&&(e["-webkit-transform"]="")}}(),!e.Handsontable)var t={};t.countEventManagerListeners=0,t.eventManager=function(o){var n,i,r,s;if(!o)throw new Error("instance not defined");return o.eventListeners||(o.eventListeners=[]),n=function(n,r,s){var a;return a=function(e){void 0==e.target&&void 0!=e.srcElement&&(e.definePoperty?e.definePoperty("target",{value:e.srcElement}):e.target=e.srcElement),void 0==e.preventDefault&&(e.definePoperty?e.definePoperty("preventDefault",{value:function(){this.returnValue=!1}}):e.preventDefault=function(){this.returnValue=!1}),s.call(this,e)},o.eventListeners.push({element:n,event:r,callback:s,callbackProxy:a}),e.addEventListener?n.addEventListener(r,a,!1):n.attachEvent("on"+r,a),t.countEventManagerListeners++,function(){i(n,r,s)}},i=function(e,n,i){for(var r,s=o.eventListeners.length;s--;)if(r=o.eventListeners[s],r.event==n&&r.element==e){if(i&&i!=r.callback)continue;o.eventListeners.splice(s,1),r.element.removeEventListener?r.element.removeEventListener(r.event,r.callbackProxy,!1):r.element.detachEvent("on"+r.event,r.callbackProxy),t.countEventManagerListeners--}},r=function(){for(var e,t=o.eventListeners.length;t--;)e=o.eventListeners[t],e&&i(e.element,e.event,e.callback)},s=function(t,o){var n,i;n={bubbles:!0,cancelable:"mousemove"!==o,view:e,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},document.createEvent?(i=document.createEvent("MouseEvents"),i.initMouseEvent(o,n.bubbles,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget||document.body.parentNode)):i=document.createEventObject(),t.dispatchEvent?t.dispatchEvent(i):t.fireEvent("on"+o,i)},{addEventListener:n,removeEventListener:i,clear:r,fireEvent:s}},t.TableView=function(o){var n=this;this.eventManager=t.eventManager(o),this.instance=o,this.settings=o.getSettings();var i=o.rootElement.getAttribute("style");i&&o.rootElement.setAttribute("data-originalstyle",i),t.Dom.addClass(o.rootElement,"handsontable");var r=document.createElement("TABLE");r.className="htCore",this.THEAD=document.createElement("THEAD"),r.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),r.appendChild(this.TBODY),o.table=r,o.container.insertBefore(r,o.container.firstChild),this.eventManager.addEventListener(o.rootElement,"mousedown",function(t){n.isTextSelectionAllowed(t.target)||(a(),t.preventDefault(),e.focus())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(e){o.selection.isInProgress()&&!e.shiftKey&&o.selection.finish()});var s;this.isMouseDown=function(){return s},this.eventManager.addEventListener(document.documentElement,"mouseup",function(e){o.selection.isInProgress()&&1===e.which&&o.selection.finish(),s=!1,t.helper.isOutsideInput(document.activeElement)&&o.unlisten()}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(e){var t=e.target;if(!s){if(t!==n.wt.wtTable.spreader)for(;t!==document.documentElement;){if(null===t)return;if(t===o.rootElement)return;t=t.parentNode}n.settings.outsideClickDeselects?o.deselectCell():o.destroyEditor()}}),this.eventManager.addEventListener(r,"selectstart",function(e){n.settings.fragmentSelection||e.preventDefault()});var a=function(){e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():document.selection&&document.selection.empty()},l=[new E({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&!o.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!n.isCellEdited()&&!o.selection.isMultiple()}}}),new E({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&o.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!n.isCellEdited()&&o.selection.isMultiple()}}}),new E({className:"highlight",highlightRowClassName:n.settings.currentRowClassName,highlightColumnClassName:n.settings.currentColClassName}),new E({className:"fill",border:{width:1,color:"red"}})];l.current=l[0],l.area=l[1],l.highlight=l[2],l.fill=l[3];var c={debug:function(){return n.settings.debug},table:r,stretchH:this.settings.stretchH,data:o.getDataAtCell,totalRows:o.countRows,totalColumns:o.countCols,fixedColumnsLeft:function(){return n.settings.fixedColumnsLeft},fixedRowsTop:function(){return n.settings.fixedRowsTop},renderAllRows:n.settings.renderAllRows,rowHeaders:function(){var e=[];return o.hasRowHeaders()&&e.push(function(e,t){n.appendRowHeader(e,t)}),t.hooks.run(o,"afterGetRowHeaderRenderers",e),e},columnHeaders:function(){var e=[];return o.hasColHeaders()&&e.push(function(e,t){n.appendColHeader(e,t)}),t.hooks.run(o,"afterGetColumnHeaderRenderers",e),e},columnWidth:o.getColWidth,rowHeight:o.getRowHeight,cellRenderer:function(e,o,i){var r=n.instance.colToProp(o),s=n.instance.getCellMeta(e,o),a=n.instance.getCellRenderer(s),l=n.instance.getDataAtRowProp(e,r);a(n.instance,i,e,o,r,l,s),t.hooks.run(n.instance,"afterRenderer",i,e,o,r,l,s)},selections:l,hideBorderOnMouseDownOver:function(){return n.settings.fragmentSelection},onCellMouseDown:function(e,i,r,a){o.listen(),n.activeWt=a,s=!0,t.hooks.run(o,"beforeOnCellMouseDown",e,i,r),t.Dom.enableImmediatePropagation(e),e.isImmediatePropagationStopped()||(2===e.button&&o.selection.inInSelection(i)||(e.shiftKey?i.row>=0&&i.col>=0&&o.selection.setRangeEnd(i):i.row<0||i.col<0?(i.row<0&&(o.selectCell(0,i.col,o.countRows()-1,i.col),o.selection.setSelectedHeaders(!1,!0)),i.col<0&&(o.selectCell(i.row,0,i.row,o.countCols()-1),o.selection.setSelectedHeaders(!0,!1))):o.selection.setRangeStart(i)),t.hooks.run(o,"afterOnCellMouseDown",e,i,r),n.activeWt=n.wt)},onCellMouseOver:function(e,i,r,a){n.activeWt=a,i.row>=0&&i.col>=0?s&&o.selection.setRangeEnd(i):s&&(i.row<0&&(o.selection.setRangeEnd(new u(o.countRows()-1,i.col)),o.selection.setSelectedHeaders(!1,!0)),i.col<0&&(o.selection.setRangeEnd(new u(i.row,o.countCols()-1)),o.selection.setSelectedHeaders(!0,!1))),t.hooks.run(o,"afterOnCellMouseOver",e,i,r),n.activeWt=n.wt},onCellCornerMouseDown:function(e){e.preventDefault(),t.hooks.run(o,"afterOnCellCornerMouseDown",e)},beforeDraw:function(e){n.beforeRender(e)},onDraw:function(e){n.onDraw(e)},onScrollVertically:function(){o.runHooks("afterScrollVertically")},onScrollHorizontally:function(){o.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(e,t){o.runHooks("beforeDrawBorders",e,t)},onBeforeTouchScroll:function(){o.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){o.runHooks("afterMomentumScroll")},viewportRowCalculatorOverride:function(e){n.settings.viewportRowRenderingOffset&&(e.startRow=Math.max(e.startRow-n.settings.viewportRowRenderingOffset,0),e.endRow=Math.min(e.endRow+n.settings.viewportRowRenderingOffset,o.countRows()-1)),o.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:function(e){n.settings.viewportColumnRenderingOffset&&(e.startColumn=Math.max(e.startColumn-n.settings.viewportColumnRenderingOffset,0),e.endColumn=Math.min(e.endColumn+n.settings.viewportColumnRenderingOffset,o.countCols()-1)),o.runHooks("afterViewportColumnCalculatorOverride",e)}};t.hooks.run(o,"beforeInitWalkontable",c),this.wt=new m(c),this.activeWt=this.wt,this.eventManager.addEventListener(n.wt.wtTable.spreader,"mousedown",function(e){e.target===n.wt.wtTable.spreader&&3===e.which&&t.helper.stopPropagation(e)}),this.eventManager.addEventListener(n.wt.wtTable.spreader,"contextmenu",function(e){e.target===n.wt.wtTable.spreader&&3===e.which&&t.helper.stopPropagation(e)}),this.eventManager.addEventListener(document.documentElement,"click",function(){n.settings.observeDOMVisibility&&n.wt.drawInterrupted&&(n.instance.forceFullRender=!0,n.render())})},t.TableView.prototype.isTextSelectionAllowed=function(e){return t.helper.isInput(e)?!0:this.settings.fragmentSelection&&t.Dom.isChildOf(e,this.TBODY)?!0:!1},t.TableView.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()},t.TableView.prototype.beforeRender=function(e){e&&t.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender)},t.TableView.prototype.onDraw=function(e){e&&t.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)},t.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1},t.TableView.prototype.getCellAtCoords=function(e,t){var o=this.wt.getCell(e,t);return 0>o?null:o},t.TableView.prototype.scrollViewport=function(e){this.wt.scrollViewport(e)},t.TableView.prototype.appendRowHeader=function(e,o){var n=document.createElement("DIV"),i=document.createElement("SPAN");n.className="relative",i.className="rowHeader",e>-1?t.Dom.fastInnerHTML(i,this.instance.getRowHeader(e)):t.Dom.fastInnerText(i,String.fromCharCode(160)),n.appendChild(i),t.Dom.empty(o),o.appendChild(n),t.hooks.run(this.instance,"afterGetRowHeader",e,o)},t.TableView.prototype.appendColHeader=function(e,o){var n=document.createElement("DIV"),i=document.createElement("SPAN");n.className="relative",i.className="colHeader",e>-1?t.Dom.fastInnerHTML(i,this.instance.getColHeader(e)):t.Dom.fastInnerText(i,String.fromCharCode(160)),n.appendChild(i),t.Dom.empty(o),o.appendChild(n),t.hooks.run(this.instance,"afterGetColHeader",e,o)},t.TableView.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth(),o=t-e;return o>0?o:0},t.TableView.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight(),o=t-e;return o>0?o:0},t.TableView.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},t.TableView.prototype.destroy=function(){this.wt.destroy(),this.eventManager.clear()},function(e){function t(e){var t,o;o={},t=e,this.getInstance=function(e){return e.guid in o||(o[e.guid]=new t(e)),o[e.guid]}}var o={},n=new WeakMap;e.editors={registerEditor:function(e,i){var r=new t(i);"string"==typeof e&&(o[e]=r),n.set(i,r)},getEditor:function(e,t){var i;if("function"==typeof e)n.get(e)||this.registerEditor(null,e),i=n.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter ');i=o[e]}if(!i)throw Error('No editor registered under name "'+e+'"');return i.getInstance(t)}}}(t),function(e){e.EditorManager=function(t,o,n){var i,r=this,s=e.helper.keyCode,a=!1,l=e.eventManager(t),c=function(){function c(l){if(t.isListening()&&(e.hooks.run(t,"beforeKeyDown",l),!a&&(e.Dom.enableImmediatePropagation(l),!l.isImmediatePropagationStopped()&&(o.lastKeyCode=l.keyCode,n.isSelected())))){var c=(l.ctrlKey||l.metaKey)&&!l.altKey;if(!(i.isWaiting()||e.helper.isMetaKey(l.keyCode)||c||r.isEditorOpened()))return void r.openEditor("");var h=l.shiftKey?n.setRangeEnd:n.setRangeStart;switch(l.keyCode){case s.A:c&&(n.selectAll(),l.preventDefault(),e.helper.stopPropagation(l));break;case s.ARROW_UP:r.isEditorOpened()&&!i.isWaiting()&&r.closeEditorAndSaveChanges(c),f(l.shiftKey),l.preventDefault(),e.helper.stopPropagation(l);break;case s.ARROW_DOWN:r.isEditorOpened()&&!i.isWaiting()&&r.closeEditorAndSaveChanges(c),p(l.shiftKey),l.preventDefault(),e.helper.stopPropagation(l);break;case s.ARROW_RIGHT:r.isEditorOpened()&&!i.isWaiting()&&r.closeEditorAndSaveChanges(c),m(l.shiftKey),l.preventDefault(),e.helper.stopPropagation(l);break;case s.ARROW_LEFT:r.isEditorOpened()&&!i.isWaiting()&&r.closeEditorAndSaveChanges(c),g(l.shiftKey),l.preventDefault(),e.helper.stopPropagation(l);break;case s.TAB:var v="function"==typeof o.settings.tabMoves?o.settings.tabMoves(l):o.settings.tabMoves;l.shiftKey?n.transformStart(-v.row,-v.col):n.transformStart(v.row,v.col,!0),l.preventDefault(),e.helper.stopPropagation(l);break;case s.BACKSPACE:case s.DELETE:n.empty(l),r.prepareEditor(),l.preventDefault();break;case s.F2:r.openEditor(),l.preventDefault();break;case s.ENTER:r.isEditorOpened()?(i.state!==e.EditorState.WAITING&&r.closeEditorAndSaveChanges(c),d(l.shiftKey)):t.getSettings().enterBeginsEditing?r.openEditor():d(l.shiftKey),l.preventDefault(),l.stopImmediatePropagation();break;case s.ESCAPE:r.isEditorOpened()&&r.closeEditorAndRestoreOriginalValue(c),l.preventDefault();break;case s.HOME:h(l.ctrlKey||l.metaKey?new u(0,o.selRange.from.col):new u(o.selRange.from.row,0)),l.preventDefault(),e.helper.stopPropagation(l);break;case s.END:h(l.ctrlKey||l.metaKey?new u(t.countRows()-1,o.selRange.from.col):new u(o.selRange.from.row,t.countCols()-1)),l.preventDefault(),e.helper.stopPropagation(l);break;case s.PAGE_UP:n.transformStart(-t.countVisibleRows(),0),l.preventDefault(),e.helper.stopPropagation(l);break;case s.PAGE_DOWN:n.transformStart(t.countVisibleRows(),0),l.preventDefault(),e.helper.stopPropagation(l)}}}function h(e,t,o){"TD"==o.nodeName&&r.openEditor()}function d(e){var t="function"==typeof o.settings.enterMoves?o.settings.enterMoves(event):o.settings.enterMoves;e?n.transformStart(-t.row,-t.col):n.transformStart(t.row,t.col,!0)}function f(e){e?n.transformEnd(-1,0):n.transformStart(-1,0)}function p(e){e?n.transformEnd(1,0):n.transformStart(1,0)}function m(e){e?n.transformEnd(0,1):n.transformStart(0,1)}function g(e){e?n.transformEnd(0,-1):n.transformStart(0,-1)}t.addHook("afterDocumentKeyDown",function(e){c(e)}),l.addEventListener(document,"keydown",function(e){t.runHooks("afterDocumentKeyDown",e)}),t.view.wt.update("onCellDblClick",h),t.addHook("afterDestroy",function(){a=!0})};this.destroyEditor=function(e){this.closeEditor(e)},this.getActiveEditor=function(){return i},this.prepareEditor=function(){if(i&&i.isWaiting())return void this.closeEditor(!1,!1,function(e){e&&r.prepareEditor()});var n=o.selRange.highlight.row,s=o.selRange.highlight.col,a=t.colToProp(s),l=t.getCell(n,s),c=t.getDataAtCell(n,s),h=t.getCellMeta(n,s),u=t.getCellEditor(h);i=e.editors.getEditor(u,t),i.prepare(n,s,a,l,c,h)},this.isEditorOpened=function(){return i.isOpened()},this.openEditor=function(e){i.cellProperties.readOnly||i.beginEditing(e)},this.closeEditor=function(e,t,o){i?i.finishEditing(e,t,o):o&&o(!1)},this.closeEditorAndSaveChanges=function(e){return this.closeEditor(!1,e)},this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(!0,e)},c()}}(t),function(e){var t={};e.renderers={registerRenderer:function(e,o){t[e]=o},getRenderer:function(e){if("function"==typeof e)return e;if("string"!=typeof e)throw Error('Only strings and functions can be passed as "renderer" parameter ');if(!(e in t))throw Error('No editor registered under name "'+e+'"');return t[e]}}}(t),t.helper={},t.helper.isPrintableChar=function(e){return 32==e||e>=48&&57>=e||e>=96&&111>=e||e>=186&&192>=e||e>=219&&222>=e||e>=226||e>=65&&90>=e},t.helper.isMetaKey=function(e){var o=t.helper.keyCode,n=[o.ARROW_DOWN,o.ARROW_UP,o.ARROW_LEFT,o.ARROW_RIGHT,o.HOME,o.END,o.DELETE,o.BACKSPACE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.TAB,o.PAGE_DOWN,o.PAGE_UP,o.ENTER,o.ESCAPE,o.SHIFT,o.CAPS_LOCK,o.ALT];return-1!=n.indexOf(e)},t.helper.isCtrlKey=function(e){var o=t.helper.keyCode;return-1!=[o.CONTROL_LEFT,224,o.COMMAND_LEFT,o.COMMAND_RIGHT].indexOf(e)},t.helper.stringify=function(e){switch(typeof e){case"string":case"number":return e+"";case"object":return null===e?"":e.toString();case"undefined":return"";default:return e.toString()}},t.helper.spreadsheetColumnLabel=function(e){for(var t,o=e+1,n="";o>0;)t=(o-1)%26,n=String.fromCharCode(65+t)+n,o=parseInt((o-t)/26,10);return n},t.helper.createSpreadsheetData=function(e,o){e="number"==typeof e?e:100,o="number"==typeof o?o:4;var n,i,r=[];for(n=0;e>n;n++){var s=[];for(i=0;o>i;i++)s.push(t.helper.spreadsheetColumnLabel(i)+(n+1));r.push(s)}return r},t.helper.createSpreadsheetObjectData=function(e,o){e="number"==typeof e?e:100,o="number"==typeof o?o:4;var n,i,r=[];for(n=0;e>n;n++){var s={};for(i=0;o>i;i++)s["prop"+i]=t.helper.spreadsheetColumnLabel(i)+(n+1);r.push(s)}return r},t.helper.isNumeric=function(e){var t=typeof e;return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?e.length?1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e):!1:"object"==t?!(!e||"number"!=typeof e.valueOf()||e instanceof Date):!1},t.helper.randomString=function(){return w()},t.helper.inherit=function(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e},t.helper.extend=function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},t.helper.deepExtend=function(e,o){for(var n in o)o.hasOwnProperty(n)&&(o[n]&&"object"==typeof o[n]?(e[n]||(Array.isArray(o[n])?e[n]=[]:e[n]={}),t.helper.deepExtend(e[n],o[n])):e[n]=o[n])},t.helper.deepClone=function(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e},t.helper.getPrototypeOf=function(e){var t;if("object"==typeof e.__proto__)t=e.__proto__;else{var o,n=e.constructor;"function"==typeof e.constructor&&(o=n,delete e.constructor&&(n=e.constructor,e.constructor=o)),t=n?n.prototype:null}return t},t.helper.columnFactory=function(e,o){function n(){}t.helper.inherit(n,e);for(var i=0,r=o.length;r>i;i++)n.prototype[o[i]]=void 0;return n},t.helper.translateRowsToColumns=function(e){var t,o,n,i,r=[],s=0;for(t=0,o=e.length;o>t;t++)for(n=0,i=e[t].length;i>n;n++)n==s&&(r.push([]),s++),r[n].push(e[t][n]);return r},t.helper.to2dArray=function(e){for(var t=0,o=e.length;o>t;)e[t]=[e[t]],t++},t.helper.extendArray=function(e,t){for(var o=0,n=t.length;n>o;)e.push(t[o]),o++},t.helper.isInput=function(e){var t=["INPUT","SELECT","TEXTAREA"];return t.indexOf(e.nodeName)>-1},t.helper.isOutsideInput=function(e){return t.helper.isInput(e)&&-1==e.className.indexOf("handsontableInput")},t.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86},t.helper.isObject=function(e){return"[object Object]"==Object.prototype.toString.call(e)},t.helper.pivot=function(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var o=e.length,n=e[0].length,i=0;o>i;i++)for(var r=0;n>r;r++)t[r]||(t[r]=[]),t[r][i]=e[i][r];return t},t.helper.proxy=function(e,t){return function(){return e.apply(t,arguments)}},t.helper.cellMethodLookupFactory=function(e,o){function n(e){var o=t.cellTypes[e];if("undefined"==typeof o)throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return o}return o="undefined"==typeof o?!0:o,function(i,r){return function s(i){if(i){if(i.hasOwnProperty(e)&&void 0!==i[e])return i[e];if(i.hasOwnProperty("type")&&i.type){var r;if("string"!=typeof i.type)throw new Error("Cell type must be a string ");if(r=n(i.type),r.hasOwnProperty(e))return r[e];if(o)return}return s(t.helper.getPrototypeOf(i))}}("number"==typeof i?this.getCellMeta(i,r):i)}},t.helper.isMobileBrowser=function(e){return e||(e=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)},t.helper.isTouchSupported=function(){return"ontouchstart"in e},t.helper.stopPropagation=function(e){"function"==typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},t.helper.pageX=function(e){if(e.pageX)return e.pageX;var o=t.Dom.getWindowScrollLeft(),n=e.clientX+o;return n},t.helper.pageY=function(e){if(e.pageY)return e.pageY;var o=t.Dom.getWindowScrollTop(),n=e.clientY+o;return n},function(e){e.DataMap=function(e,t,o){this.instance=e,this.priv=t,this.GridSettings=o,this.dataSource=this.instance.getSettings().data,this.dataSource[0]?this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]):this.duckSchema={},this.createMap()},e.DataMap.prototype.DESTINATION_RENDERER=1,e.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,e.DataMap.prototype.recursiveDuckSchema=function(e){var t;if(Array.isArray(e))t=[];else{t={};for(var o in e)e.hasOwnProperty(o)&&("object"!=typeof e[o]||Array.isArray(e[o])?t[o]=null:t[o]=this.recursiveDuckSchema(e[o]))}return t},e.DataMap.prototype.recursiveDuckColumns=function(e,t,o){var n,i;if("undefined"==typeof t&&(t=0,o=""),"object"==typeof e&&!Array.isArray(e))for(i in e)e.hasOwnProperty(i)&&(null===e[i]?(n=o+i,this.colToPropCache.push(n),this.propToColCache.set(n,t),t++):t=this.recursiveDuckColumns(e[i],t,i+"."));return t},e.DataMap.prototype.createMap=function(){var e,t,o=this.getSchema();if("undefined"==typeof o)throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new MultiMap;var n=this.instance.getSettings().columns;if(n)for(e=0,t=n.length;t>e;e++)"undefined"!=typeof n[e].data&&(this.colToPropCache[e]=n[e].data,this.propToColCache.set(n[e].data,e));else this.recursiveDuckColumns(o)},e.DataMap.prototype.colToProp=function(t){return t=e.hooks.run(this.instance,"modifyCol",t),this.colToPropCache&&"undefined"!=typeof this.colToPropCache[t]?this.colToPropCache[t]:t},e.DataMap.prototype.propToCol=function(t){var o;return o="undefined"!=typeof this.propToColCache.get(t)?this.propToColCache.get(t):t,o=e.hooks.run(this.instance,"modifyCol",o)},e.DataMap.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;return e?"function"==typeof e?e():e:this.duckSchema},e.DataMap.prototype.createRow=function(t,o,n){var i,r,s=this.instance.countCols(),a=0;o||(o=1),("number"!=typeof t||t>=this.instance.countRows())&&(t=this.instance.countRows()),r=t;for(var l=this.instance.getSettings().maxRows;o>a&&this.instance.countRows()<l;){if("array"===this.instance.dataType){i=[];for(var c=0;s>c;c++)i.push(null)}else"function"===this.instance.dataType?i=this.instance.getSettings().dataSchema(t):(i={},e.helper.deepExtend(i,this.getSchema()));t===this.instance.countRows()?this.dataSource.push(i):this.dataSource.splice(t,0,i),a++,r++}return e.hooks.run(this.instance,"afterCreateRow",t,a,n),this.instance.forceFullRender=!0,a},e.DataMap.prototype.createCol=function(t,o,n){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var i,r,s=this.instance.countRows(),a=this.dataSource,l=0;o||(o=1),r=t;for(var c=this.instance.getSettings().maxCols;o>l&&this.instance.countCols()<c;){if(i=e.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof t||t>=this.instance.countCols()){for(var h=0;s>h;h++)"undefined"==typeof a[h]&&(a[h]=[]),a[h].push(null);this.priv.columnSettings.push(i)}else{for(var h=0;s>h;h++)a[h].splice(r,0,null);this.priv.columnSettings.splice(r,0,i)}l++,r++}return e.hooks.run(this.instance,"afterCreateCol",t,l,n),this.instance.forceFullRender=!0,l},e.DataMap.prototype.removeRow=function(t,o){o||(o=1),"number"!=typeof t&&(t=-o),t=(this.instance.countRows()+t)%this.instance.countRows();var n=this.physicalRowsToLogical(t,o),i=e.hooks.run(this.instance,"beforeRemoveRow",t,o);if(i!==!1){var r=this.dataSource,s=r.filter(function(e,t){return-1==n.indexOf(t)});r.length=0,Array.prototype.push.apply(r,s),e.hooks.run(this.instance,"afterRemoveRow",t,o),this.instance.forceFullRender=!0}},e.DataMap.prototype.removeCol=function(t,o){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");o||(o=1),"number"!=typeof t&&(t=-o),t=(this.instance.countCols()+t)%this.instance.countCols();var n=e.hooks.run(this.instance,"beforeRemoveCol",t,o);if(n!==!1){for(var i=this.dataSource,r=0,s=this.instance.countRows();s>r;r++)i[r].splice(t,o);this.priv.columnSettings.splice(t,o),e.hooks.run(this.instance,"afterRemoveCol",t,o),this.instance.forceFullRender=!0}},e.DataMap.prototype.spliceCol=function(t,o,n){var i=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getDataAtCol(t),s=r.slice(o,o+n),a=r.slice(o+n);e.helper.extendArray(i,a);for(var l=0;n>l;)i.push(null),l++;return e.helper.to2dArray(i),this.instance.populateFromArray(o,t,i,null,null,"spliceCol"),s},e.DataMap.prototype.spliceRow=function(t,o,n){var i=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getSourceDataAtRow(t),s=r.slice(o,o+n),a=r.slice(o+n);e.helper.extendArray(i,a);for(var l=0;n>l;)i.push(null),l++;return this.instance.populateFromArray(t,o,[i],null,null,"spliceRow"),s},e.DataMap.prototype.get=function(t,o){if(t=e.hooks.run(this.instance,"modifyRow",t),"string"==typeof o&&o.indexOf(".")>-1){var n=o.split("."),i=this.dataSource[t];if(!i)return null;for(var r=0,s=n.length;s>r;r++)if(i=i[n[r]],"undefined"==typeof i)return null;return i}return"function"==typeof o?o(this.dataSource.slice(t,t+1)[0]):this.dataSource[t]?this.dataSource[t][o]:null};var t=e.helper.cellMethodLookupFactory("copyable",!1);e.DataMap.prototype.getCopyable=function(e,o){return t.call(this.instance,e,this.propToCol(o))?this.get(e,o):""},e.DataMap.prototype.set=function(t,o,n,i){if(t=e.hooks.run(this.instance,"modifyRow",t,i||"datamapGet"),"string"==typeof o&&o.indexOf(".")>-1){for(var r=o.split("."),s=this.dataSource[t],a=0,l=r.length-1;l>a;a++)"undefined"==typeof s[r[a]]&&(s[r[a]]={}),s=s[r[a]];s[r[a]]=n}else"function"==typeof o?o(this.dataSource.slice(t,t+1)[0],n):this.dataSource[t][o]=n},e.DataMap.prototype.physicalRowsToLogical=function(t,o){for(var n,i=this.instance.countRows(),r=(i+t)%i,s=[],a=o;i>r&&a;)n=e.hooks.run(this.instance,"modifyRow",r),s.push(n),a--,r++;return s},e.DataMap.prototype.clear=function(){for(var e=0;e<this.instance.countRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")},e.DataMap.prototype.getAll=function(){return this.dataSource},e.DataMap.prototype.getRange=function(e,t,o){var n,i,r,s,a,l=[],c=o===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(i=Math.max(e.row,t.row),s=Math.max(e.col,t.col),n=Math.min(e.row,t.row);i>=n;n++){for(a=[],r=Math.min(e.col,t.col);s>=r;r++)a.push(c.call(this,n,this.colToProp(r)));l.push(a)}return l},e.DataMap.prototype.getText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))},e.DataMap.prototype.getCopyableText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))}}(t),function(e){e.renderers.cellDecorator=function(t,o,n,i,r,s,a){a.className&&(o.className?o.className=o.className+" "+a.className:o.className=a.className),a.readOnly&&e.Dom.addClass(o,a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName&&e.Dom.addClass(o,a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&e.Dom.addClass(o,a.noWordWrapClassName),!s&&a.placeholder&&e.Dom.addClass(o,a.placeholderCellClassName)}}(t),function(e){var t=function(t,o,n,i,r,s,a){e.renderers.cellDecorator.apply(this,arguments),!s&&a.placeholder&&(s=a.placeholder);var l=e.helper.stringify(s);if(a.rendererTemplate){e.Dom.empty(o);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=t.getSourceDataAtRow(n),o.appendChild(c)}else e.Dom.fastInnerText(o,l)};e.renderers.TextRenderer=t,e.renderers.registerRenderer("text",t)}(t),function(e){var t=document.createElement("DIV");t.className="htAutocompleteWrapper";var o=document.createElement("DIV");o.className="htAutocompleteArrow",o.appendChild(document.createTextNode(String.fromCharCode(9660)));var n=function(n,i,r,s,a,l,c){var h=(t.cloneNode(!0),o.cloneNode(!0));if(e.renderers.TextRenderer(n,i,r,s,a,l,c),i.appendChild(h),e.Dom.addClass(i,"htAutocomplete"),i.firstChild||i.appendChild(document.createTextNode(String.fromCharCode(160))),!n.acArrowListener){var d=e.eventManager(n);n.acArrowListener=function(t){e.Dom.hasClass(t.target,"htAutocompleteArrow")&&n.view.wt.getSetting("onCellDblClick",null,new u(r,s),i)},d.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",function(){d.clear()})}};e.AutocompleteRenderer=n,e.renderers.AutocompleteRenderer=n,e.renderers.registerRenderer("autocomplete",n)}(t),function(e){var t=document.createElement("INPUT");t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off");var o=function(o,n,i,r,s,a,l){var c=e.eventManager(o);"undefined"==typeof l.checkedTemplate&&(l.checkedTemplate=!0),"undefined"==typeof l.uncheckedTemplate&&(l.uncheckedTemplate=!1),e.Dom.empty(n);var h=t.cloneNode(!1);a===l.checkedTemplate||a===e.helper.stringify(l.checkedTemplate)?(h.checked=!0,n.appendChild(h)):a===l.uncheckedTemplate||a===e.helper.stringify(l.uncheckedTemplate)?n.appendChild(h):null===a?(h.className+=" noValue",n.appendChild(h)):e.Dom.fastInnerText(n,"#bad value#"),l.readOnly?c.addEventListener(h,"click",function(e){e.preventDefault()}):(c.addEventListener(h,"mousedown",function(t){e.helper.stopPropagation(t)}),c.addEventListener(h,"mouseup",function(t){e.helper.stopPropagation(t)}),c.addEventListener(h,"change",function(){this.checked?o.setDataAtRowProp(i,s,l.checkedTemplate):o.setDataAtRowProp(i,s,l.uncheckedTemplate)})),o.CheckboxRenderer&&o.CheckboxRenderer.beforeKeyDownHookBound||(o.CheckboxRenderer={beforeKeyDownHookBound:!0},o.addHook("beforeKeyDown",function(t){if(e.Dom.enableImmediatePropagation(t),t.keyCode==e.helper.keyCode.SPACE||t.keyCode==e.helper.keyCode.ENTER)for(var n,i,r,s=o.getSelectedRange(),a=s.getTopLeftCorner(),l=s.getBottomRightCorner(),h=a.row;h<=l.row;h++)for(var u=a.col;u<=l.col;u++)if(n=o.getCell(h,u),r=o.getCellMeta(h,u),i=n.querySelectorAll("input[type=checkbox]"),i.length>0&&!r.readOnly){t.isImmediatePropagationStopped()||(t.stopImmediatePropagation(),t.preventDefault());for(var d=0,f=i.length;f>d;d++)i[d].checked=!i[d].checked,c.fireEvent(i[d],"change")}}))};e.CheckboxRenderer=o,e.renderers.CheckboxRenderer=o,e.renderers.registerRenderer("checkbox",o)}(t),function(e){var t=function(t,o,n,i,r,s,a){e.helper.isNumeric(s)&&("undefined"!=typeof a.language&&numeral.language(a.language),s=numeral(s).format(a.format||"0"),e.Dom.addClass(o,"htNumeric")),e.renderers.TextRenderer(t,o,n,i,r,s,a)};e.NumericRenderer=t,e.renderers.NumericRenderer=t,e.renderers.registerRenderer("numeric",t)}(t),function(e){var t=function(t,o,n,i,r,s,a){e.renderers.TextRenderer.apply(this,arguments),s=o.innerHTML;var l,c=a.hashLength||s.length,h=a.hashSymbol||"*";
for(l="";l.split(h).length-1<c;l+=h);e.Dom.fastInnerHTML(o,l)};e.PasswordRenderer=t,e.renderers.PasswordRenderer=t,e.renderers.registerRenderer("password",t)}(t),function(e){function t(t,o,n,i,r,s,a){e.renderers.cellDecorator.apply(this,arguments),e.Dom.fastInnerHTML(o,s)}e.renderers.registerRenderer("html",t),e.renderers.HtmlRenderer=t}(t),function(e){function t(t){this.instance=t,this.state=e.EditorState.VIRGIN,this._opened=!1,this._closeCallback=null,this.init()}e.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},t.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)},t.prototype.init=function(){},t.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},t.prototype.setValue=function(e){throw Error("Editor setValue() method unimplemented")},t.prototype.open=function(){throw Error("Editor open() method unimplemented")},t.prototype.close=function(){throw Error("Editor close() method unimplemented")},t.prototype.prepare=function(t,o,n,i,r,s){this.TD=i,this.row=t,this.col=o,this.prop=n,this.originalValue=r,this.cellProperties=s,this.state=e.EditorState.VIRGIN},t.prototype.extend=function(){function e(){o.apply(this,arguments)}function t(e,t){function o(){}return o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e,e}var o=this.constructor;return t(e,o)},t.prototype.saveValue=function(e,t){if(t){var o,n=this.instance.getSelected();n[0]>n[2]&&(o=n[0],n[0]=n[2],n[2]=o),n[1]>n[3]&&(o=n[1],n[1]=n[3],n[3]=o),this.instance.populateFromArray(n[0],n[1],e,n[2],n[3],"edit")}else this.instance.populateFromArray(this.row,this.col,e,null,null,"edit")},t.prototype.beginEditing=function(t){this.state==e.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new u(this.row,this.col)),this.instance.view.render(),this.state=e.EditorState.EDITING,t="string"==typeof t?t:this.originalValue,this.setValue(e.helper.stringify(t)),this.open(),this._opened=!0,this.focus(),this.instance.view.render())},t.prototype.finishEditing=function(t,o,n){var i=this;if(n){var r=this._closeCallback;this._closeCallback=function(e){r&&r(e),n(e)}}if(!this.isWaiting()){if(this.state==e.EditorState.VIRGIN)return void this.instance._registerTimeout(setTimeout(function(){i._fireCallbacks(!0)},0));if(this.state==e.EditorState.EDITING){if(t)return this.cancelChanges(),void this.instance.view.render();var s=[[String.prototype.trim.call(this.getValue())]];this.state=e.EditorState.WAITING,this.saveValue(s,o),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(t){i.state=e.EditorState.FINISHED,i.discardEditor(t)}):(this.state=e.EditorState.FINISHED,this.discardEditor(!0))}}},t.prototype.cancelChanges=function(){this.state=e.EditorState.FINISHED,this.discardEditor()},t.prototype.discardEditor=function(t){this.state===e.EditorState.FINISHED&&(t===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=e.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=e.EditorState.VIRGIN,this._fireCallbacks(!0)))},t.prototype.isOpened=function(){return this._opened},t.prototype.isWaiting=function(){return this.state===e.EditorState.WAITING},e.editors.BaseEditor=t}(t),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){var t=this;this.createElements(),this.eventManager=new e.eventManager(this),this.bindEvents(),this.autoResize=N(),this.instance.addHook("afterDestroy",function(){t.destroy()})},t.prototype.getValue=function(){return this.TEXTAREA.value},t.prototype.setValue=function(e){this.TEXTAREA.value=e};var o=function(t){var o=this,n=o.getActiveEditor(),i=e.helper.keyCode,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if(e.Dom.enableImmediatePropagation(t),t.target===n.TEXTAREA&&!t.isImmediatePropagationStopped()){if(17===t.keyCode||224===t.keyCode||91===t.keyCode||93===t.keyCode)return void t.stopImmediatePropagation();switch(t.keyCode){case i.ARROW_RIGHT:e.Dom.getCaretPosition(n.TEXTAREA)!==n.TEXTAREA.value.length&&t.stopImmediatePropagation();break;case i.ARROW_LEFT:0!==e.Dom.getCaretPosition(n.TEXTAREA)&&t.stopImmediatePropagation();break;case i.ENTER:var s=n.instance.getSelected(),a=!(s[0]===s[2]&&s[1]===s[3]);(r&&!a||t.altKey)&&(n.isOpened()?(n.setValue(n.getValue()+"\n"),n.focus()):n.beginEditing(n.originalValue+"\n"),t.stopImmediatePropagation()),t.preventDefault();break;case i.A:case i.X:case i.C:case i.V:r&&t.stopImmediatePropagation();break;case i.BACKSPACE:case i.DELETE:case i.HOME:case i.END:t.stopImmediatePropagation()}n.autoResize.resize(String.fromCharCode(t.keyCode))}};t.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",o)},t.prototype.close=function(){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",o)},t.prototype.focus=function(){this.TEXTAREA.focus(),e.Dom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},t.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),e.Dom.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),e.Dom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var t=this;this.instance._registerTimeout(setTimeout(function(){t.refreshDimensions()},0))},t.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},t.prototype.getEditedCell=function(){var e,t=this.checkEditorSection();switch(t){case"top":e=this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"corner":e=this.instance.view.wt.wtScrollbars.corner.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":e=this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=e&&-2!=e?e:void 0},t.prototype.refreshDimensions=function(){if(this.state===e.EditorState.EDITING&&(this.TD=this.getEditedCell(),this.TD)){var t,o=e.Dom.offset(this.TD),n=e.Dom.offset(this.instance.rootElement),i=o.top-n.top-1,r=o.left-n.left-1,s=this.instance.getSettings(),a=s.rowHeaders===!1?0:1,l=s.colHeaders===!1?0:1,c=this.checkEditorSection();switch(c){case"top":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.holder.parentNode);break;case"left":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.holder.parentNode);break;case"corner":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.corner.clone.wtTable.holder.parentNode)}0>i&&(i=0),0>r&&(r=0),a>0&&parseInt(this.TD.style.borderTopWidth,10)>0&&(i+=1),l>0&&parseInt(this.TD.style.borderLeftWidth,10)>0&&(r+=1),t&&-1!=t?this.textareaParentStyle[t[0]]=t[1]:e.Dom.resetCssTransform(this.textareaParentStyle),this.textareaParentStyle.top=i+"px",this.textareaParentStyle.left=r+"px";var h=this.TD.offsetTop-this.instance.view.wt.wtScrollbars.vertical.getScrollPosition(),u=this.TD.offsetLeft-this.instance.view.wt.wtScrollbars.horizontal.getScrollPosition(),d=e.Dom.innerWidth(this.TD)-8,f=this.instance.view.maximumVisibleElementWidth(u)-10,p=e.Dom.outerHeight(this.TD)-4,m=this.instance.view.maximumVisibleElementHeight(h)-2;parseInt(this.TD.style.borderTopWidth,10)>0&&(p-=1),parseInt(this.TD.style.borderLeftWidth,10)>0&&a>0&&(d-=1),this.TEXTAREA.style.fontSize=e.Dom.getComputedStyle(this.TD).fontSize,this.TEXTAREA.style.fontFamily=e.Dom.getComputedStyle(this.TD).fontFamily,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(p,m),maxHeight:m,minWidth:Math.min(d,f),maxWidth:f},!0),this.textareaParentStyle.display="block"}},t.prototype.bindEvents=function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(t){e.helper.stopPropagation(t)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(t){e.helper.stopPropagation(t)}),this.instance.addHook("afterScrollVertically",function(){t.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){t.refreshDimensions(),t.focus()}),this.instance.addHook("afterRowResize",function(){t.refreshDimensions(),t.focus()}),this.instance.addHook("afterDestroy",function(){t.eventManager.clear()})},t.prototype.destroy=function(){this.eventManager.clear()},e.editors.TextEditor=t,e.editors.registerEditor("text",e.editors.TextEditor)}(t),function(t){var o=t.editors.BaseEditor.prototype.extend(),n={},i=function(){this.controls={},this.controls.leftButton=document.createElement("DIV"),this.controls.leftButton.className="leftButton",this.controls.rightButton=document.createElement("DIV"),this.controls.rightButton.className="rightButton",this.controls.upButton=document.createElement("DIV"),this.controls.upButton.className="upButton",this.controls.downButton=document.createElement("DIV"),this.controls.downButton.className="downButton";for(var e in this.controls)this.controls.hasOwnProperty(e)&&this.positionControls.appendChild(this.controls[e])};o.prototype.valueChanged=function(){return this.initValue!=this.getValue()},o.prototype.init=function(){var e=this;this.eventManager=new t.eventManager(this.instance),this.createElements(),this.bindEvents(),this.instance.addHook("afterDestroy",function(){e.destroy()})},o.prototype.getValue=function(){return this.TEXTAREA.value},o.prototype.setValue=function(e){this.initValue=e,this.TEXTAREA.value=e},o.prototype.createElements=function(){this.editorContainer=document.createElement("DIV"),this.editorContainer.className="htMobileEditorContainer",this.cellPointer=document.createElement("DIV"),this.cellPointer.className="cellPointer",this.moveHandle=document.createElement("DIV"),this.moveHandle.className="moveHandle",this.inputPane=document.createElement("DIV"),this.inputPane.className="inputs",this.positionControls=document.createElement("DIV"),this.positionControls.className="positionControls",this.TEXTAREA=document.createElement("TEXTAREA"),t.Dom.addClass(this.TEXTAREA,"handsontableInput"),this.inputPane.appendChild(this.TEXTAREA),this.editorContainer.appendChild(this.cellPointer),this.editorContainer.appendChild(this.moveHandle),this.editorContainer.appendChild(this.inputPane),this.editorContainer.appendChild(this.positionControls),i.call(this),document.body.appendChild(this.editorContainer)},o.prototype.onBeforeKeyDown=function(e){var o=this,n=o.getActiveEditor();if(t.Dom.enableImmediatePropagation(e),e.target===n.TEXTAREA&&!e.isImmediatePropagationStopped()){var i=t.helper.keyCode;switch(e.keyCode){case i.ENTER:n.close(),e.preventDefault();break;case i.BACKSPACE:e.stopImmediatePropagation()}}},o.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),t.Dom.addClass(this.editorContainer,"active"),t.Dom.removeClass(this.cellPointer,"hidden"),this.updateEditorPosition()},o.prototype.focus=function(){this.TEXTAREA.focus(),t.Dom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},o.prototype.close=function(){this.TEXTAREA.blur(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),t.Dom.removeClass(this.editorContainer,"active")},o.prototype.scrollToView=function(){var e=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(e)},o.prototype.hideCellPointer=function(){t.Dom.hasClass(this.cellPointer,"hidden")||t.Dom.addClass(this.cellPointer,"hidden")},o.prototype.updateEditorPosition=function(o,i){if(o&&i)o=parseInt(o,10),i=parseInt(i,10),this.editorContainer.style.top=i+"px",this.editorContainer.style.left=o+"px";else{var r=this.instance.getSelected(),s=this.instance.getCell(r[0],r[1]);if(n.cellPointer||(n.cellPointer={height:t.Dom.outerHeight(this.cellPointer),width:t.Dom.outerWidth(this.cellPointer)}),n.editorContainer||(n.editorContainer={width:t.Dom.outerWidth(this.editorContainer)}),void 0!==s){var a=this.instance.view.wt.wtScrollbars.horizontal.scrollHandler==e?0:t.Dom.getScrollLeft(this.instance.view.wt.wtScrollbars.horizontal.scrollHandler),l=this.instance.view.wt.wtScrollbars.vertical.scrollHandler==e?0:t.Dom.getScrollTop(this.instance.view.wt.wtScrollbars.vertical.scrollHandler),c=t.Dom.offset(s),h=t.Dom.outerWidth(s),u={x:a,y:l};this.editorContainer.style.top=parseInt(c.top+t.Dom.outerHeight(s)-u.y+n.cellPointer.height,10)+"px",this.editorContainer.style.left=parseInt(e.innerWidth/2-n.editorContainer.width/2,10)+"px",c.left+h/2>parseInt(this.editorContainer.style.left,10)+n.editorContainer.width?this.editorContainer.style.left=e.innerWidth-n.editorContainer.width+"px":c.left+h/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px"),this.cellPointer.style.left=parseInt(c.left-n.cellPointer.width/2-t.Dom.offset(this.editorContainer).left+h/2-u.x,10)+"px"}}},o.prototype.updateEditorData=function(){var e=this.instance.getSelected(),t=this.instance.getDataAtCell(e[0],e[1]);this.row=e[0],this.col=e[1],this.setValue(t),this.updateEditorPosition()},o.prototype.prepareAndSave=function(){if(!this.valueChanged())return!0;var e=[[String.prototype.trim.call(this.getValue())]];this.saveValue(e)},o.prototype.bindEvents=function(){var o=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(e){o.prepareAndSave(),o.instance.selection.transformStart(0,-1,null,!0),o.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(e){o.prepareAndSave(),o.instance.selection.transformStart(0,1,null,!0),o.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.upButton,"touchend",function(e){o.prepareAndSave(),o.instance.selection.transformStart(-1,0,null,!0),o.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.downButton,"touchend",function(e){o.prepareAndSave(),o.instance.selection.transformStart(1,0,null,!0),o.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.moveHandle,"touchstart",function(e){if(1==e.touches.length){var t=e.touches[0],n={x:o.editorContainer.offsetLeft,y:o.editorContainer.offsetTop},i={x:t.pageX-n.x,y:t.pageY-n.y};o.eventManager.addEventListener(this,"touchmove",function(e){var t=e.touches[0];o.updateEditorPosition(t.pageX-i.x,t.pageY-i.y),o.hideCellPointer(),e.preventDefault()})}}),this.eventManager.addEventListener(document.body,"touchend",function(e){t.Dom.isChildOf(e.target,o.editorContainer)||t.Dom.isChildOf(e.target,o.instance.rootElement)||o.close()}),this.eventManager.addEventListener(this.instance.view.wt.wtScrollbars.horizontal.scrollHandler,"scroll",function(t){o.instance.view.wt.wtScrollbars.horizontal.scrollHandler!=e&&o.hideCellPointer()}),this.eventManager.addEventListener(this.instance.view.wt.wtScrollbars.vertical.scrollHandler,"scroll",function(t){o.instance.view.wt.wtScrollbars.vertical.scrollHandler!=e&&o.hideCellPointer()})},o.prototype.destroy=function(){this.eventManager.clear(),this.editorContainer.parentNode.removeChild(this.editorContainer)},t.editors.MobileTextEditor=o,t.editors.registerEditor("mobile",t.editors.MobileTextEditor)}(t),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.beginEditing=function(){var e=this.TD.querySelector('input[type="checkbox"]');e&&e.click()},t.prototype.finishEditing=function(){},t.prototype.init=function(){},t.prototype.open=function(){},t.prototype.close=function(){},t.prototype.getValue=function(){},t.prototype.setValue=function(){},t.prototype.focus=function(){},e.editors.CheckboxEditor=t,e.editors.registerEditor("checkbox",t)}(t),function(t){var o,n=t.editors.TextEditor.prototype.extend();n.prototype.init=function(){if("undefined"==typeof jQuery)throw new Error("You need to include jQuery to your project in order to use the jQuery UI Datepicker.");if(o=jQuery,!o.datepicker)throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?");t.editors.TextEditor.prototype.init.apply(this,arguments),this.isCellEdited=!1;var e=this;this.instance.addHook("afterDestroy",function(){e.destroyElements()})},n.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments),this.datePicker=document.createElement("DIV"),t.Dom.addClass(this.datePicker,"htDatepickerHolder"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=99,document.body.appendChild(this.datePicker),this.$datePicker=o(this.datePicker);var e=this,n={dateFormat:"yy-mm-dd",showButtonPanel:!0,changeMonth:!0,changeYear:!0,onSelect:function(t){e.setValue(t),e.finishEditing(!1)}};this.$datePicker.datepicker(n);var i=t.eventManager(this);i.addEventListener(this.datePicker,"mousedown",function(e){t.helper.stopPropagation(e)}),this.hideDatepicker()},n.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy"),this.$datePicker.remove()},n.prototype.open=function(){t.editors.TextEditor.prototype.open.call(this),this.showDatepicker()},n.prototype.finishEditing=function(e,o){this.hideDatepicker(),t.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},n.prototype.showDatepicker=function(){var o,n,i=this.TD.getBoundingClientRect();this.datePickerStyle.top=e.pageYOffset+i.top+t.Dom.outerHeight(this.TD)+"px",this.datePickerStyle.left=e.pageXOffset+i.left+"px",o=function(){},o.prototype=this.cellProperties,n=new o,n.defaultDate=this.originalValue||void 0,this.$datePicker.datepicker("option",n),this.originalValue&&this.$datePicker.datepicker("setDate",this.originalValue),this.datePickerStyle.display="block"},n.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"},t.editors.DateEditor=n,t.editors.registerEditor("date",n)}(t),function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments);var t=document.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.htEditor=new e(t),this.assignHooks()},t.prototype.prepare=function(t,o,n,i,r,s){e.editors.TextEditor.prototype.prepare.apply(this,arguments);var a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var e=this.getValue();void 0!==e&&a.setValue(e),a.instance.destroyEditor()}};this.cellProperties.handsontable&&e.helper.extend(l,s.handsontable),this.htEditor&&this.htEditor.destroy(),this.htEditor=new e(this.htContainer,l)};var o=function(t){if(null!=t&&null==t.isImmediatePropagationEnabled&&(t.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1,this.cancelBubble=!0},t.isImmediatePropagationEnabled=!0,t.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled}),!t.isImmediatePropagationStopped()){var o,n=this.getActiveEditor(),i=n.htEditor.getInstance();if(t.keyCode==e.helper.keyCode.ARROW_DOWN)if(i.getSelected()){var r=i.getSelected()[0],s=i.countRows()-1;o=Math.min(s,r+1)}else o=0;else if(t.keyCode==e.helper.keyCode.ARROW_UP&&i.getSelected()){var r=i.getSelected()[0];o=r-1}void 0!==o&&(0>o?i.deselectCell():i.selectCell(o,0),t.preventDefault(),t.stopImmediatePropagation(),n.instance.listen(),n.TEXTAREA.focus())}};t.prototype.open=function(){this.instance.addHook("beforeKeyDown",o),e.editors.TextEditor.prototype.open.apply(this,arguments),this.htEditor.render(),this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible"),e.Dom.setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)},t.prototype.close=function(){this.instance.removeHook("beforeKeyDown",o),this.instance.listen(),e.editors.TextEditor.prototype.close.apply(this,arguments)},t.prototype.focus=function(){this.instance.listen(),e.editors.TextEditor.prototype.focus.apply(this,arguments)},t.prototype.beginEditing=function(t){var o=this.instance.getSettings().onBeginEditing;o&&o()===!1||e.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},t.prototype.finishEditing=function(t,o){if(this.htEditor.isListening()&&this.instance.listen(),this.htEditor.getSelected()){var n=this.htEditor.getInstance().getValue();void 0!==n&&this.setValue(n)}return e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},t.prototype.assignHooks=function(){var e=this;this.instance.addHook("afterDestroy",function(){e.htEditor&&e.htEditor.destroy()})},e.editors.HandsontableEditor=t,e.editors.registerEditor("handsontable",t)}(t),function(t){var o=t.editors.HandsontableEditor.prototype.extend();o.prototype.init=function(){t.editors.HandsontableEditor.prototype.init.apply(this,arguments);var e=this.htEditor.getInstance();e.updateSettings({height:1}),this.query=null,this.choices=[]},o.prototype.createElements=function(){t.editors.HandsontableEditor.prototype.createElements.apply(this,arguments);var o=function(){return-1!=e.navigator.platform.indexOf("Mac")?"htMacScroll":""};t.Dom.addClass(this.htContainer,"autocompleteEditor"),t.Dom.addClass(this.htContainer,o())};var n=!1,i=function(e){n=!1;var o=this.getActiveEditor(),i=t.helper.keyCode;if(t.helper.isPrintableChar(e.keyCode)||e.keyCode===i.BACKSPACE||e.keyCode===i.DELETE||e.keyCode===i.INSERT){var r=0;if(e.keyCode===i.C&&(e.ctrlKey||e.metaKey))return;o.isOpened()||(r+=10),o.instance._registerTimeout(setTimeout(function(){o.queryChoices(o.TEXTAREA.value),n=!0},r))}};o.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",i),t.editors.HandsontableEditor.prototype.prepare.apply(this,arguments)},o.prototype.open=function(){t.editors.HandsontableEditor.prototype.open.apply(this,arguments),this.TEXTAREA.style.visibility="visible",this.focus(),this.htContainer.style.overflow="hidden";var e=this.htEditor.getInstance(),o=this;e.updateSettings({colWidths:[t.Dom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(e,t,n,i,r){var s=this.getCellMeta(t,n).filteringCaseSensitive===!0;if(r){var a=s?r.indexOf(this.query):r.toLowerCase().indexOf(o.query.toLowerCase());if(-1!=a){var l=r.substr(a,o.query.length);e.innerHTML=r.replace(l,"<strong>"+l+"</strong>")}}}}),n&&(n=!1),o.instance._registerTimeout(setTimeout(function(){o.queryChoices(o.TEXTAREA.value),o.htContainer.style.overflow="auto"},0))},o.prototype.close=function(){t.editors.HandsontableEditor.prototype.close.apply(this,arguments)},o.prototype.queryChoices=function(e){if(this.query=e,"function"==typeof this.cellProperties.source){var t=this;this.cellProperties.source(e,function(e){t.updateChoicesList(e)})}else if(Array.isArray(this.cellProperties.source)){var o;if(e&&this.cellProperties.filter!==!1){var n=this.cellProperties.filteringCaseSensitive===!0,i=e.toLowerCase();o=this.cellProperties.source.filter(function(t){return n?-1!=t.indexOf(e):-1!=t.toLowerCase().indexOf(i)})}else o=this.cellProperties.source;this.updateChoicesList(o)}else this.updateChoicesList([])},o.prototype.updateChoicesList=function(e){var n,i=t.Dom.getCaretPosition(this.TEXTAREA),r=t.Dom.getSelectionEndPosition(this.TEXTAREA),s=o.sortByRelevance(this.getValue(),e,this.cellProperties.filteringCaseSensitive);if(0!=this.cellProperties.filter){for(var a=[],l=0,c=s.length;c>l;l++)a.push(e[s[l]]);n=0,e=a}else n=s[0];this.choices=e,this.htEditor.loadData(t.helper.pivot([e])),this.htEditor.updateSettings({height:this.getDropdownHeight()}),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(n),this.instance.listen(),this.TEXTAREA.focus(),t.Dom.setCaretPosition(this.TEXTAREA,i,i!=r?r:void 0)},o.prototype.finishEditing=function(e){e||this.instance.removeHook("beforeKeyDown",i),t.editors.HandsontableEditor.prototype.finishEditing.apply(this,arguments)},o.prototype.highlightBestMatchingChoice=function(e){"number"==typeof e?this.htEditor.selectCell(e,0):this.htEditor.deselectCell()},o.sortByRelevance=function(e,t,o){var n,i,r,s,a,l=[],c=e.length,h=[];if(0===c){for(s=0,a=t.length;a>s;s++)h.push(s);return h}for(s=0,a=t.length;a>s;s++)n=t[s],i=o?n.indexOf(e):n.toLowerCase().indexOf(e.toLowerCase()),-1!=i&&(r=n.length-i-c,l.push({baseIndex:s,index:i,charsLeft:r,value:n}));for(l.sort(function(e,t){return-1===t.index?-1:-1===e.index?1:e.index<t.index?-1:t.index<e.index?1:e.index===t.index?e.charsLeft<t.charsLeft?-1:e.charsLeft>t.charsLeft?1:0:void 0}),s=0,a=l.length;a>s;s++)h.push(l[s].baseIndex);return h},o.prototype.getDropdownHeight=function(){var e=this.htEditor.getInstance().getRowHeight(0)||23;return this.choices.length>=10?10*e:this.choices.length*e+8},t.editors.AutocompleteEditor=o,t.editors.registerEditor("autocomplete",o)}(t),function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,e.Dom.empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)},e.editors.PasswordEditor=t,e.editors.registerEditor("password",t)}(t),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){this.select=document.createElement("SELECT"),e.Dom.addClass(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select)},t.prototype.prepare=function(){e.editors.BaseEditor.prototype.prepare.apply(this,arguments);var t,o=this.cellProperties.selectOptions;t="function"==typeof o?this.prepareOptions(o(this.row,this.col,this.prop)):this.prepareOptions(o),e.Dom.empty(this.select);for(var n in t)if(t.hasOwnProperty(n)){var i=document.createElement("OPTION");i.value=n,e.Dom.fastInnerHTML(i,t[n]),this.select.appendChild(i)}},t.prototype.prepareOptions=function(e){var t={};if(Array.isArray(e))for(var o=0,n=e.length;n>o;o++)t[e[o]]=e[o];else"object"==typeof e&&(t=e);return t},t.prototype.getValue=function(){return this.select.value},t.prototype.setValue=function(e){this.select.value=e};var o=function(t){var o=this,n=o.getActiveEditor();switch(t.keyCode){case e.helper.keyCode.ARROW_UP:var i=n.select.find("option:selected").prev();1==i.length&&i.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault();break;case e.helper.keyCode.ARROW_DOWN:var r=n.select.find("option:selected").next();1==r.length&&r.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault()}};t.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},t.prototype.open=function(){var t,n=e.Dom.outerWidth(this.TD),i=e.Dom.outerHeight(this.TD),r=e.Dom.offset(this.instance.rootElement),s=e.Dom.offset(this.TD),a=this.checkEditorSection();switch(a){case"top":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.holder.parentNode);break;case"left":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.holder.parentNode);break;case"corner":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.corner.clone.wtTable.holder.parentNode)}var l=this.select.style;t&&-1!=t?l[t[0]]=t[1]:e.Dom.resetCssTransform(this.select),l.height=i+"px",l.minWidth=n+"px",l.top=s.top-r.top+"px",l.left=s.left-r.left+"px",l.margin="0px",l.display="",this.instance.addHook("beforeKeyDown",o)},t.prototype.close=function(){this.select.style.display="none",this.instance.removeHook("beforeKeyDown",o)},t.prototype.focus=function(){this.select.focus()},e.editors.SelectEditor=t,e.editors.registerEditor("select",t)}(t),function(e){var t=e.editors.AutocompleteEditor.prototype.extend();t.prototype.prepare=function(){e.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments),this.cellProperties.filter=!1,this.cellProperties.strict=!0},e.editors.DropdownEditor=t,e.editors.registerEditor("dropdown",t)}(t),function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.beginEditing=function(t){var o=e.editors.TextEditor.prototype;if("undefined"==typeof t&&this.originalValue){var n=""+this.originalValue;"undefined"!=typeof this.cellProperties.language&&numeral.language(this.cellProperties.language);var i=numeral.languageData().delimiters.decimal;n=n.replace(".",i),o.beginEditing.apply(this,[n])}else o.beginEditing.apply(this,arguments)},e.editors.NumericEditor=t,e.editors.registerEditor("numeric",t)}(t),t.NumericValidator=function(e,t){null===e&&(e=""),t(/^-?\d*(\.|\,)?\d*$/.test(e))};var P=function(e,t){var o=e,n="string"==typeof o?o.toLowerCase():null;return function(e){for(var i=!1,r=0,s=e.length;s>r;r++){if(o===e[r]){i=!0;break}if(n===e[r].toLowerCase()){i=!0;break}}t(i)}};t.AutocompleteValidator=function(e,t){this.strict&&this.source?"function"==typeof this.source?this.source(e,P(e,t)):P(e,t)(this.source):t(!0)},t.mobileBrowser=t.helper.isMobileBrowser(),t.AutocompleteCell={editor:t.editors.AutocompleteEditor,renderer:t.renderers.AutocompleteRenderer,validator:t.AutocompleteValidator},t.CheckboxCell={editor:t.editors.CheckboxEditor,renderer:t.renderers.CheckboxRenderer},t.TextCell={editor:t.mobileBrowser?t.editors.MobileTextEditor:t.editors.TextEditor,renderer:t.renderers.TextRenderer},t.NumericCell={editor:t.editors.NumericEditor,renderer:t.renderers.NumericRenderer,validator:t.NumericValidator,dataType:"number"},t.DateCell={editor:t.editors.DateEditor,renderer:t.renderers.AutocompleteRenderer},t.HandsontableCell={editor:t.editors.HandsontableEditor,renderer:t.renderers.AutocompleteRenderer},t.PasswordCell={editor:t.editors.PasswordEditor,renderer:t.renderers.PasswordRenderer,copyable:!1},t.DropdownCell={editor:t.editors.DropdownEditor,renderer:t.renderers.AutocompleteRenderer,validator:t.AutocompleteValidator},t.cellTypes={text:t.TextCell,date:t.DateCell,numeric:t.NumericCell,checkbox:t.CheckboxCell,autocomplete:t.AutocompleteCell,handsontable:t.HandsontableCell,password:t.PasswordCell,dropdown:t.DropdownCell},t.cellLookup={validator:{numeric:t.NumericValidator,autocomplete:t.AutocompleteValidator}};/**
 * autoResize - resizes a DOM element to the width and height of another DOM element
 *
 * Copyright 2014, Marcin Warpechowski
 * Licensed under the MIT license
 */
var N=function(){var o,n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},i=document.body,r=document.createTextNode(""),s=document.createElement("SPAN"),a=function(t,o,n){e.attachEvent?t.attachEvent("on"+o,n):t.addEventListener(o,n,!1)},l=function(t,o,n){e.removeEventListener?t.removeEventListener(o,n,!1):t.detachEvent("on"+o,n)},c=function(e){var a,l;e?/^[a-zA-Z \.,\\\/\|0-9]$/.test(e)||(e="."):e="",void 0!==r.textContent?r.textContent=o.value+e:r.data=o.value+e,s.style.fontSize=t.Dom.getComputedStyle(o).fontSize,s.style.fontFamily=t.Dom.getComputedStyle(o).fontFamily,s.style.whiteSpace="pre",i.appendChild(s),a=s.clientWidth+2,i.removeChild(s),o.style.height=n.minHeight+"px",n.minWidth>a?o.style.width=n.minWidth+"px":a>n.maxWidth?o.style.width=n.maxWidth+"px":o.style.width=a+"px",l=o.scrollHeight?o.scrollHeight-1:0,n.minHeight>l?o.style.height=n.minHeight+"px":n.maxHeight<l?(o.style.height=n.maxHeight+"px",o.style.overflowY="visible"):o.style.height=l+"px"},h=function(){e.setTimeout(c,0)},u=function(e){if(e&&e.minHeight)if("inherit"==e.minHeight)n.minHeight=o.clientHeight;else{var t=parseInt(e.minHeight);isNaN(t)||(n.minHeight=t)}if(e&&e.maxHeight)if("inherit"==e.maxHeight)n.maxHeight=o.clientHeight;else{var i=parseInt(e.maxHeight);isNaN(i)||(n.maxHeight=i)}if(e&&e.minWidth)if("inherit"==e.minWidth)n.minWidth=o.clientWidth;else{var a=parseInt(e.minWidth);isNaN(a)||(n.minWidth=a)}if(e&&e.maxWidth)if("inherit"==e.maxWidth)n.maxWidth=o.clientWidth;else{var l=parseInt(e.maxWidth);isNaN(l)||(n.maxWidth=l)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(r))},d=function(e,t,i){o=e,u(t),"TEXTAREA"==o.nodeName&&(o.style.resize="none",o.style.overflowY="",o.style.height=n.minHeight+"px",o.style.minWidth=n.minWidth+"px",o.style.maxWidth=n.maxWidth+"px",o.style.overflowY="hidden"),i&&(a(o,"change",c),a(o,"cut",h),a(o,"paste",h),a(o,"drop",h),a(o,"keydown",h)),c()};return{init:function(e,t,o){d(e,t,o)},unObserve:function(){l(o,"change",c),l(o,"cut",h),l(o,"paste",h),l(o,"drop",h),l(o,"keydown",h)},resize:c}};/**
 * SheetClip - Spreadsheet Clipboard Parser
 * version 0.2
 *
 * This tiny library transforms JavaScript arrays to strings that are pasteable by LibreOffice, OpenOffice,
 * Google Docs and Microsoft Excel.
 *
 * Copyright 2012, Marcin Warpechowski
 * Licensed under the MIT license.
 * http://github.com/warpech/sheetclip/
 */
!function(e){function t(e){return e.split('"').length-1}e.SheetClip={parse:function(e){var o,n,i,r,s,a,l,c=[],h=0;for(i=e.split("\n"),i.length>1&&""===i[i.length-1]&&i.pop(),o=0,n=i.length;n>o;o+=1){for(i[o]=i[o].split("	"),r=0,s=i[o].length;s>r;r+=1)c[h]||(c[h]=[]),a&&0===r?(l=c[h].length-1,c[h][l]=c[h][l]+"\n"+i[o][0],a&&1&t(i[o][0])&&(a=!1,c[h][l]=c[h][l].substring(0,c[h][l].length-1).replace(/""/g,'"'))):r===s-1&&0===i[o][r].indexOf('"')?(c[h].push(i[o][r].substring(1).replace(/""/g,'"')),a=!0):(c[h].push(i[o][r].replace(/""/g,'"')),a=!1);a||(h+=1)}return c},stringify:function(e){var t,o,n,i,r,s="";for(t=0,o=e.length;o>t;t+=1){for(i=e[t].length,n=0;i>n;n+=1)n>0&&(s+="	"),r=e[t][n],s+="string"==typeof r?r.indexOf("\n")>-1?'"'+r.replace(/"/g,'""')+'"':r:null===r||void 0===r?"":r;s+="\n"}return s}}}(e);var I=function(){var e;return{getInstance:function(){return e?e.hasBeenDestroyed()&&e.init():e=new o,e.refCounter++,e}}}();o.prototype.init=function(){var e,o;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],this._eventManager=t.eventManager(this),o=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("DIV"),this.elDiv.id="CopyPasteDiv",e=this.elDiv.style,e.position="fixed",e.top="-10000px",e.left="-10000px",o.appendChild(this.elDiv),this.elTextarea=document.createElement("TEXTAREA"),this.elTextarea.className="copyPaste",this.elTextarea.onpaste=function(e){return"WebkitAppearance"in document.documentElement.style?(this.value=e.clipboardData.getData("Text"),!1):void 0},e=this.elTextarea.style,e.width="10000px",e.height="10000px",e.overflow="hidden",this.elDiv.appendChild(this.elTextarea),"undefined"!=typeof e.opacity&&(e.opacity=0)),this.keyDownRemoveEvent=this._eventManager.addEventListener(document.documentElement,"keydown",this.onKeyDown.bind(this),!1)},o.prototype.onKeyDown=function(e){var t=this,o=!1;if(e.metaKey?o=!0:e.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(o=!0),o){if(document.activeElement!==this.elTextarea&&(""!==this.getSelectionText()||-1!==["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)))return;this.selectNodeText(this.elTextarea),setTimeout(function(){t.selectNodeText(t.elTextarea)},0)}!o||67!==e.keyCode&&86!==e.keyCode&&88!==e.keyCode||(88===e.keyCode?setTimeout(function(){t.triggerCut(e)},0):86===e.keyCode&&setTimeout(function(){t.triggerPaste(e)},0))},o.prototype.selectNodeText=function(e){e&&e.select()},o.prototype.getSelectionText=function(){var t="";return e.getSelection?t=e.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(t=document.selection.createRange().text),t},o.prototype.copyable=function(e){if("string"!=typeof e&&void 0===e.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=e},o.prototype.onCut=function(e){this.cutCallbacks.push(e)},o.prototype.onPaste=function(e){this.pasteCallbacks.push(e)},o.prototype.removeCallback=function(e){var t,o;for(t=0,o=this.copyCallbacks.length;o>t;t++)if(this.copyCallbacks[t]===e)return this.copyCallbacks.splice(t,1),!0;for(t=0,o=this.cutCallbacks.length;o>t;t++)if(this.cutCallbacks[t]===e)return this.cutCallbacks.splice(t,1),!0;for(t=0,o=this.pasteCallbacks.length;o>t;t++)if(this.pasteCallbacks[t]===e)return this.pasteCallbacks.splice(t,1),!0;return!1},o.prototype.triggerCut=function(e){var t=this;t.cutCallbacks&&setTimeout(function(){for(var o=0,n=t.cutCallbacks.length;n>o;o++)t.cutCallbacks[o](e)},50)},o.prototype.triggerPaste=function(e,t){var o=this;o.pasteCallbacks&&setTimeout(function(){for(var n=t||o.elTextarea.value,i=0,r=o.pasteCallbacks.length;r>i;i++)o.pasteCallbacks[i](n,e)},50)},o.prototype.destroy=function(){this.hasBeenDestroyed()||0!==--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elDiv=null,this.elTextarea=null),this.keyDownRemoveEvent())},o.prototype.hasBeenDestroyed=function(){return!this.refCounter};var M;!function(t){function o(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function n(e,t){var i;for(var r in e)if(e.hasOwnProperty(r)){if(e[r]===t)return o(r)+"/";if("object"==typeof e[r]&&(i=n(e[r],t),""!=i))return o(r)+"/"+i}return""}function i(e,t){if(e===t)return"/";var o=n(e,t);if(""===o)throw new Error("Object not found in root");return"/"+o}function r(e){for(var t=0,o=w.length;o>t;t++)if(w[t].obj===e)return w[t]}function s(e,t){for(var o=0,n=e.observers.length;n>o;o++)if(e.observers[o].callback===t)return e.observers[o].observer}function a(e,t){for(var o=0,n=e.observers.length;n>o;o++)if(e.observers[o].observer===t)return void e.observers.splice(o,1)}function l(e,t){d(t),Object.observe?u(t,e):clearTimeout(t.next);var o=r(e);a(o,t)}function c(t,o){var n,a=[],l=t,c=r(t);if(c?n=s(c,o):(c=new y(t),w.push(c)),n)return n;if(Object.observe)n=function(e){u(n,t),h(n,t);for(var r=0,s=e.length;s>r;){if(("length"!==e[r].name||!_(e[r].object))&&"__Jasmine_been_here_before__"!==e[r].name){var c=e[r].type;switch(c){case"new":c="add";break;case"deleted":c="delete";break;case"updated":c="update"}v[c].call(e[r],a,i(l,e[r].object))}r++}a&&o&&o(a),n.patches=a,a=[]};else if(n={},c.value=JSON.parse(JSON.stringify(t)),o){n.callback=o,n.next=null;var f=this.intervals||[100,1e3,1e4,6e4],p=0,m=function(){d(n)},g=function(){clearTimeout(n.next),n.next=setTimeout(function(){m(),p=0,n.next=setTimeout(b,f[p++])},0)},b=function(){m(),p==f.length&&(p=f.length-1),n.next=setTimeout(b,f[p++])};"undefined"!=typeof e&&(e.addEventListener?(e.addEventListener("mousedown",g),e.addEventListener("mouseup",g),e.addEventListener("keydown",g)):(e.attachEvent("onmousedown",g),e.attachEvent("onmouseup",g),e.attachEvent("onkeydown",g))),n.next=setTimeout(b,f[p++])}return n.patches=a,n.object=t,c.observers.push(new C(o,n)),h(n,t)}function h(e,t){if(Object.observe){Object.observe(t,e);for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];n&&"object"==typeof n&&h(e,n)}}return e}function u(e,t){if(Object.observe){Object.unobserve(t,e);for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];n&&"object"==typeof n&&u(e,n)}}return e}function d(e){if(Object.observe)Object.deliverChangeRecords(e);else{for(var t,o=0,n=w.length;n>o;o++)if(w[o].obj===e.object){t=w[o];break}f(t.value,e.object,e.patches,"")}var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function f(e,t,n,i){for(var r=b(t),s=b(e),a=!1,l=!1,c=s.length-1;c>=0;c--){var h=s[c],u=e[h];if(t.hasOwnProperty(h)){var d=t[h];u instanceof Object?f(u,d,n,i+"/"+o(h)):u!=d&&(a=!0,n.push({op:"replace",path:i+"/"+o(h),value:d}),e[h]=d)}else n.push({op:"remove",path:i+"/"+o(h)}),delete e[h],l=!0}if(l||r.length!=s.length)for(var c=0;c<r.length;c++){var h=r[c];e.hasOwnProperty(h)||(n.push({op:"add",path:i+"/"+o(h),value:t[h]}),e[h]=JSON.parse(JSON.stringify(t[h])))}}function p(e,t){for(var o,n=!1,i=0,r=t.length;r>i;){o=t[i];for(var s=o.path.split("/"),a=e,l=1,c=s.length;;)if(_(a)){var h=parseInt(s[l],10);if(l++,l>=c){n=g[o.op].call(o,a,h,e);break}a=a[h]}else{var u=s[l];if(-1!=u.indexOf("~")&&(u=u.replace(/~1/g,"/").replace(/~0/g,"~")),l++,l>=c){n=m[o.op].call(o,a,u,e);break}a=a[u]}i++}return n}var m={add:function(e,t){return e[t]=this.value,!0},remove:function(e,t){return delete e[t],!0},replace:function(e,t){return e[t]=this.value,!0},move:function(e,t,o){var n={op:"_get",path:this.from};return p(o,[n]),p(o,[{op:"remove",path:this.from}]),p(o,[{op:"add",path:this.path,value:n.value}]),!0},copy:function(e,t,o){var n={op:"_get",path:this.from};return p(o,[n]),p(o,[{op:"add",path:this.path,value:n.value}]),!0},test:function(e,t){return JSON.stringify(e[t])===JSON.stringify(this.value)},_get:function(e,t){this.value=e[t]}},g={add:function(e,t){return e.splice(t,0,this.value),!0},remove:function(e,t){return e.splice(t,1),!0},replace:function(e,t){return e[t]=this.value,!0},move:m.move,copy:m.copy,test:m.test,_get:m._get},v={add:function(e,t){var n={op:"add",path:t+o(this.name),value:this.object[this.name]};e.push(n)},"delete":function(e,t){var n={op:"remove",path:t+o(this.name)};e.push(n)},update:function(e,t){var n={op:"replace",path:t+o(this.name),value:this.object[this.name]};e.push(n)}},w=[];t.intervals;var y=function(){function e(e){this.observers=[],this.obj=e}return e}(),C=function(){function e(e,t){this.callback=e,this.observer=t}return e}();t.unobserve=l,t.observe=c,t.generate=d;var b;b=Object.keys?Object.keys:function(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push(o);return t};var _;_=Array.isArray?Array.isArray:function(e){return e.push&&"number"==typeof e.length},t.apply=p}(M||(M={})),"undefined"!=typeof exports&&(exports.apply=M.apply,exports.observe=M.observe,exports.unobserve=M.unobserve,exports.generate=M.generate),t.PluginHookClass=function(){function e(){this.hooks=t(),this.globalBucket={},this.legacy=o}var t=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeSetRangeEnd:[],beforeDrawBorders:[],beforeChange:[],beforeChangeRender:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeOnCellMouseDown:[],beforeTouchScroll:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterSetCellMeta:[],afterGetColHeader:[],afterGetRowHeader:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],afterCellMetaReset:[],afterIsMultipleSelectionCheck:[],afterDocumentKeyDown:[],afterMomentumScroll:[],modifyColWidth:[],modifyRowHeight:[],modifyRow:[],modifyCol:[]}},o={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};return e.prototype.getBucket=function(e){return e?(e.pluginHookBucket||(e.pluginHookBucket={}),e.pluginHookBucket):this.globalBucket},e.prototype.add=function(e,t,n){if(Array.isArray(t))for(var i=0,r=t.length;r>i;i++)this.add(e,t[i]);else{e in o&&(e=o[e]);var s=this.getBucket(n);"undefined"==typeof s[e]&&(s[e]=[]),t.skip=!1,-1==s[e].indexOf(t)&&s[e].push(t)}return this},e.prototype.once=function(e,t,o){if(Array.isArray(t))for(var n=0,i=t.length;i>n;n++)t[n].runOnce=!0,this.add(e,t[n],o);else t.runOnce=!0,this.add(e,t,o)},e.prototype.remove=function(e,t,n){var i=!1;e in o&&(e=o[e]);var r=this.getBucket(n);if("undefined"!=typeof r[e])for(var s=0,a=r[e].length;a>s;s++)if(r[e][s]==t){r[e][s].skip=!0,i=!0;break}return i},e.prototype.destroy=function(e){var t=this.getBucket(e);for(var o in t)if(t.hasOwnProperty(o))for(var n=0,i=t[o].length;i>n;n++)this.remove(o,t[o],e)},e.prototype.run=function(e,t,n,i,r,s,a,l){return t in o&&(t=o[t]),n=this._runBucket(this.globalBucket,e,t,n,i,r,s,a,l),n=this._runBucket(this.getBucket(e),e,t,n,i,r,s,a,l)},e.prototype._runBucket=function(e,t,o,n,i,r,s,a,l){var c,h,u,d=e[o];if(d)for(h=0,u=d.length;u>h;h++)d[h].skip||(c=d[h].call(t,n,i,r,s,a,l),void 0!==c&&(n=c),d[h].runOnce&&this.remove(o,d[h],e===this.globalBucket?null:t));return n},e.prototype.register=function(e){this.isRegistered(e)||(this.hooks[e]=[])},e.prototype.deregister=function(e){delete this.hooks[e]},e.prototype.isRegistered=function(e){return"undefined"!=typeof this.hooks[e]},e.prototype.getRegistered=function(){return Object.keys(this.hooks)},e}(),t.hooks=new t.PluginHookClass,t.PluginHooks=t.hooks,function(e){function t(){function t(e){var t=document,o=this;o.table=t.createElement("table"),o.theadTh=t.createElement("th"),o.table.appendChild(t.createElement("thead")).appendChild(t.createElement("tr")).appendChild(o.theadTh),o.tableStyle=o.table.style,o.tableStyle.tableLayout="auto",o.tableStyle.width="auto",o.tbody=t.createElement("tbody"),o.table.appendChild(o.tbody),o.container=t.createElement("div"),o.container.className=e.rootElement.className+" hidden",o.containerStyle=o.container.style,o.container.appendChild(o.table)}var n=this,i=5;this.beforeInit=function(){var e=this;e.autoColumnWidths=[],e.getSettings().autoColumnSize!==!1?e.autoColumnSizeTmp||(e.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},e.addHook("beforeRender",o.determineIfChanged),e.addHook("modifyColWidth",o.modifyColWidth),e.addHook("afterDestroy",o.afterDestroy),e.determineColumnWidth=n.determineColumnWidth):e.autoColumnSizeTmp&&(e.removeHook("beforeRender",o.determineIfChanged),e.removeHook("modifyColWidth",o.modifyColWidth),e.removeHook("afterDestroy",o.afterDestroy),delete e.determineColumnWidth,n.afterDestroy.call(e))},this.determineIfChanged=function(e){e&&o.determineColumnsWidth.apply(this,arguments)},this.determineColumnWidth=function(o){var n=this,r=n.autoColumnSizeTmp;r.container||t.call(r,n),r.container.className=n.rootElement.className+" htAutoColumnSize",r.table.className=n.table.className;for(var s=n.countRows(),a={},l=0,c=0;s>c;c++){var h=e.helper.stringify(n.getDataAtCell(c,o)),u=h.length;u>l&&(l=u),a[u]||(a[u]={needed:i,strings:[]}),a[u].needed&&(a[u].strings.push({value:h,row:c}),a[u].needed--)}var d=n.getSettings();d.colHeaders&&n.view.appendColHeader(o,r.theadTh),e.Dom.empty(r.tbody);for(var f in a)if(a.hasOwnProperty(f))for(var p=0,m=a[f].strings.length;m>p;p++){var g=a[f].strings[p].row,v=n.getCellMeta(g,o);v.col=o,v.row=g;var w=n.getCellRenderer(v),y=document.createElement("tr"),C=document.createElement("td");w(n,C,g,o,n.colToProp(o),a[f].strings[p].value,v),c++,y.appendChild(C),r.tbody.appendChild(y)}var b=n.rootElement.parentNode;b.appendChild(r.container);var _=e.Dom.outerWidth(r.table);return b.removeChild(r.container),_},this.determineColumnsWidth=function(){var e=this,t=this.getSettings();if(t.autoColumnSize||!t.colWidths)for(var o=this.countCols(),i=0;o>i;i++)e._getColWidthFromSettings(i)||(this.autoColumnWidths[i]=n.determineColumnWidth.call(e,i))},this.modifyColWidth=function(e,t){return this.autoColumnWidths[t]&&this.autoColumnWidths[t]>e?this.autoColumnWidths[t]:e},this.afterDestroy=function(){var e=this;e.autoColumnSizeTmp&&e.autoColumnSizeTmp.container&&e.autoColumnSizeTmp.container.parentNode&&e.autoColumnSizeTmp.container.parentNode.removeChild(e.autoColumnSizeTmp.container),e.autoColumnSizeTmp=null}}var o=new t;e.hooks.add("beforeInit",o.beforeInit),e.hooks.add("afterUpdateSettings",o.beforeInit)}(t);var L=new n;t.hooks.add("afterInit",function(){L.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){L.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyRow",L.translateRow),t.hooks.add("afterGetColHeader",L.getColHeader),t.hooks.register("beforeColumnSort"),t.hooks.register("afterColumnSort"),function(e){function t(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),e+=" "+t)}function o(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),e+=" "+t)}function n(e,n,i,r){var s=this.getCellMeta(e,n),a=r;s.className&&(a="vertical"===i?t(s.className,r):o(s.className,r)),this.setCellMeta(e,n,"className",a)}function i(e,t,o){if(e.from.row==e.to.row&&e.from.col==e.to.col)n.call(this,e.from.row,e.from.col,t,o);else for(var i=e.from.row;i<=e.to.row;i++)for(var r=e.from.col;r<=e.to.col;r++)n.call(this,i,r,t,o);this.render()}function r(t,o){this.instance=t;var n=this;if(n.menus=[],n.htMenus={},n.triggerRows=[],n.eventManager=e.eventManager(n),this.enabled=!0,this.instance.addHook("afterDestroy",function(){n.destroy()}),this.defaultOptions={items:[{key:"row_above",name:"Insert row above",callback:function(e,t){this.alter("insert_row",t.start.row)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]],o=t.join(",")==e.join(",");return e[0]<0||this.countRows()>=this.getSettings().maxRows||o}},{key:"row_below",name:"Insert row below",callback:function(e,t){this.alter("insert_row",t.end.row+1)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]],o=t.join(",")==e.join(",");return this.getSelected()[0]<0||this.countRows()>=this.getSettings().maxRows||o}},r.SEPARATOR,{key:"col_left",name:"Insert column on the left",callback:function(e,t){this.alter("insert_col",t.start.col)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1],o=t.join(",")==e.join(",");return this.getSelected()[1]<0||this.countCols()>=this.getSettings().maxCols||o}},{key:"col_right",name:"Insert column on the right",callback:function(e,t){this.alter("insert_col",t.end.col+1)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1],o=t.join(",")==e.join(",");return e[1]<0||this.countCols()>=this.getSettings().maxCols||o}},r.SEPARATOR,{key:"remove_row",name:"Remove row",callback:function(e,t){var o=t.end.row-t.start.row+1;this.alter("remove_row",t.start.row,o)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]],o=t.join(",")==e.join(",");return e[0]<0||o}},{key:"remove_col",name:"Remove column",callback:function(e,t){var o=t.end.col-t.start.col+1;this.alter("remove_col",t.start.col,o)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1],o=t.join(",")==e.join(",");return e[1]<0||o}},r.SEPARATOR,{key:"undo",name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},{key:"redo",name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}},r.SEPARATOR,{key:"make_read_only",name:function(){var e="Read only",t=n.checkSelectionReadOnlyConsistency(this);return t&&(e=n.markSelected(e)),e},callback:function(){var e=n.checkSelectionReadOnlyConsistency(this),t=this;this.getSelectedRange().forAll(function(o,n){t.getCellMeta(o,n).readOnly=e?!1:!0}),this.render()}},r.SEPARATOR,{key:"alignment",name:"Alignment",submenu:{items:[{name:function(){var e="Left",t=n.checkSelectionAlignment(this,"htLeft");return t&&(e=n.markSelected(e)),e},callback:function(){i.call(this,this.getSelectedRange(),"horizontal","htLeft")},disabled:!1},{name:function(){var e="Center",t=n.checkSelectionAlignment(this,"htCenter");return t&&(e=n.markSelected(e)),e},callback:function(){i.call(this,this.getSelectedRange(),"horizontal","htCenter")},disabled:!1},{name:function(){var e="Right",t=n.checkSelectionAlignment(this,"htRight");return t&&(e=n.markSelected(e)),e},callback:function(){i.call(this,this.getSelectedRange(),"horizontal","htRight")},disabled:!1},{name:function(){var e="Justify",t=n.checkSelectionAlignment(this,"htJustify");return t&&(e=n.markSelected(e)),e},callback:function(){i.call(this,this.getSelectedRange(),"horizontal","htJustify")},disabled:!1},r.SEPARATOR,{name:function(){var e="Top",t=n.checkSelectionAlignment(this,"htTop");return t&&(e=n.markSelected(e)),e},callback:function(){i.call(this,this.getSelectedRange(),"vertical","htTop")},disabled:!1},{name:function(){var e="Middle",t=n.checkSelectionAlignment(this,"htMiddle");return t&&(e=n.markSelected(e)),e},callback:function(){i.call(this,this.getSelectedRange(),"vertical","htMiddle")},disabled:!1},{name:function(){var e="Bottom",t=n.checkSelectionAlignment(this,"htBottom");return t&&(e=n.markSelected(e)),e},callback:function(){i.call(this,this.getSelectedRange(),"vertical","htBottom")},disabled:!1}]}}]},n.options={},e.helper.extend(n.options,this.options),this.bindMouseEvents(),this.markSelected=function(e){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+e},this.checkSelectionAlignment=function(e,t){var o=!1;return e.getSelectedRange().forAll(function(n,i){var r=e.getCellMeta(n,i).className;return r&&-1!=r.indexOf(t)?(o=!0,!1):void 0}),o},!this.instance.getSettings().allowInsertRow){var s=a(this.defaultOptions.items,"row_above");this.defaultOptions.items.splice(s,1);var l=a(this.defaultOptions.items,"row_above");this.defaultOptions.items.splice(l,1),this.defaultOptions.items.splice(l,1)}if(!this.instance.getSettings().allowInsertColumn){var c=a(this.defaultOptions.items,"col_left");this.defaultOptions.items.splice(c,1);var h=a(this.defaultOptions.items,"col_right");this.defaultOptions.items.splice(h,1),this.defaultOptions.items.splice(h,1)}var u,d,f=!1,p=!1;this.instance.getSettings().allowRemoveRow||(u=a(this.defaultOptions.items,"remove_row"),this.defaultOptions.items.splice(u,1),f=!0),this.instance.getSettings().allowRemoveColumn||(d=a(this.defaultOptions.items,"remove_col"),this.defaultOptions.items.splice(d,1),p=!0),f&&p&&this.defaultOptions.items.splice(d,1),this.checkSelectionReadOnlyConsistency=function(e){var t=!1;return e.getSelectedRange().forAll(function(o,n){return e.getCellMeta(o,n).readOnly?(t=!0,!1):void 0}),t},e.hooks.run(t,"afterContextMenuDefaultOptions",this.defaultOptions)}function s(e,t){for(var o=0,n=e.length;n>o;o++)if(e[o].key===t)return e[o]}function a(e,t){for(var o=0,n=e.length;n>o;o++)if(e[o].key===t)return o}function l(){if(!this.rootElement.className.indexOf("htContextMenu")){for(var e=0,t=0,o=this.getSettings().data.length,n=0;o>n;n++)this.getSettings().data[n].name==r.SEPARATOR.name?e+=2:t+=26;this.view.wt.wtScrollbars.vertical.fixedContainer.style.height=t+e+"px"}}function c(){var t=this,o=t.getSettings().contextMenu,n=e.helper.isObject(o)?o:{};o?(t.contextMenu||(t.contextMenu=new r(t,n)),t.contextMenu.enable()):t.contextMenu&&(t.contextMenu.destroy(),delete t.contextMenu)}r.prototype.createMenu=function(t,o){t&&(t=t.replace(/ /g,"_"),t="htContextSubMenu_"+t);var n;return n=t?document.querySelector(".htContextMenu."+t):document.querySelector(".htContextMenu"),n||(n=document.createElement("DIV"),e.Dom.addClass(n,"htContextMenu"),t&&e.Dom.addClass(n,t),document.getElementsByTagName("body")[0].appendChild(n)),this.menus.indexOf(n)<0&&(this.menus.push(n),o=o||0,this.triggerRows.push(o)),n},r.prototype.bindMouseEvents=function(){function t(t){var o=this.instance.getSettings();this.closeAll(),t.preventDefault(),e.helper.stopPropagation(t);var n=this.instance.getSettings().rowHeaders,i=this.instance.getSettings().colHeaders;if(n||i||"TD"==t.target.nodeName||e.Dom.hasClass(t.target,"current")&&e.Dom.hasClass(t.target,"wtBorder")){var s=this.createMenu(),a=this.getItems(o.contextMenu);this.show(s,a),this.setMenuPosition(t,s),this.eventManager.addEventListener(document.documentElement,"mousedown",e.helper.proxy(r.prototype.closeAll,this))}}var o=e.eventManager(this.instance);o.addEventListener(this.instance.rootElement,"contextmenu",e.helper.proxy(t,this))},r.prototype.bindTableEvents=function(){this._afterScrollCallback=function(){},this.instance.addHook("afterScrollVertically",this._afterScrollCallback),this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)},r.prototype.unbindTableEvents=function(){this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},r.prototype.performAction=function(e,t){var o=this,n=t.getSelected()[0],i=t.getData()[n];if(i.disabled!==!0&&("function"!=typeof i.disabled||i.disabled.call(this.instance)!==!0)&&!i.hasOwnProperty("submenu")){if("function"!=typeof i.callback)return;var s=this.instance.getSelectedRange(),a=r.utils.normalizeSelection(s);i.callback.call(this.instance,i.key,a,e),o.closeAll()}},r.prototype.unbindMouseEvents=function(){this.eventManager.clear();var t=e.eventManager(this.instance);t.removeEventListener(this.instance.rootElement,"contextmenu")},r.prototype.show=function(t,o){var n=this;t.removeAttribute("style"),t.style.display="block";var i={data:o,colHeaders:!1,colWidths:[200],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:e.helper.proxy(this.renderer,this)}],renderAllRows:!0,beforeKeyDown:function(e){n.onBeforeKeyDown(e,r)},afterOnCellMouseOver:function(e,t,o){n.onCellMouseOver(e,t,o,r)}},r=new e(t,i);this.eventManager.removeEventListener(t,"mousedown"),this.eventManager.addEventListener(t,"mousedown",function(e){n.performAction(e,r)}),this.bindTableEvents(),r.listen(),this.htMenus[r.guid]=r},r.prototype.close=function(e){this.hide(e),this.eventManager.clear(),this.unbindTableEvents(),this.instance.listen()},r.prototype.closeAll=function(){for(;this.menus.length>0;){var e=this.menus.pop();e&&this.close(e)}this.triggerRows=[]},r.prototype.closeLastOpenedSubMenu=function(){var e=this.menus.pop();e&&this.hide(e)},r.prototype.hide=function(e){e.style.display="none";var t=this.htMenus[e.id];t.destroy(),delete this.htMenus[e.id]},r.prototype.renderer=function(t,o,n,i,s,a){function l(e){return e.hasOwnProperty("submenu")}function c(e){return new RegExp(r.SEPARATOR.name,"i").test(e.name)}function h(e){return e.disabled===!0||"function"==typeof e.disabled&&e.disabled.call(u.instance)===!0}var u=this,d=t.getData()[n],f=document.createElement("DIV");"function"==typeof a&&(a=a.call(this.instance)),e.Dom.empty(o),o.appendChild(f),c(d)?e.Dom.addClass(o,"htSeparator"):e.Dom.fastInnerHTML(f,a),h(d)?(e.Dom.addClass(o,"htDisabled"),this.eventManager.addEventListener(f,"mouseenter",function(){t.deselectCell()})):l(d)?(e.Dom.addClass(o,"htSubmenu"),this.eventManager.addEventListener(f,"mouseenter",function(){t.selectCell(n,i)})):(e.Dom.removeClass(o,"htSubmenu"),e.Dom.removeClass(o,"htDisabled"),this.eventManager.addEventListener(f,"mouseenter",function(){t.selectCell(n,i)}))},r.prototype.onCellMouseOver=function(e,t,o,n){var i=this.menus.length;if(i>0){var r=this.menus[i-1];r.id!=n.guid&&this.closeLastOpenedSubMenu()}else this.closeLastOpenedSubMenu();if(-1!=o.className.indexOf("htSubmenu")){var s=n.getData()[t.row],a=this.getItems(s.submenu),l=this.createMenu(s.name,t.row),c=o.getBoundingClientRect();this.show(l,a),this.setSubMenuPosition(c,l)}},r.prototype.onBeforeKeyDown=function(t,o){function n(e){var t=e.getCell(0,0);r.utils.isSeparator(t)||r.utils.isDisabled(t)?s(0,0,e):e.selectCell(0,0)}function i(e){var t=e.countRows()-1,o=e.getCell(t,0);r.utils.isSeparator(o)||r.utils.isDisabled(o)?a(t,0,e):e.selectCell(t,0)}function s(e,t,o){var n=e+1,i=n<o.countRows()?o.getCell(n,t):null;i&&(r.utils.isSeparator(i)||r.utils.isDisabled(i)?s(n,t,o):o.selectCell(n,t))}function a(e,t,o){var n=e-1,i=n>=0?o.getCell(n,t):null;i&&(r.utils.isSeparator(i)||r.utils.isDisabled(i)?a(n,t,o):o.selectCell(n,t))}function l(e,t,o,n){var i=e.getData()[n],r=t.getItems(i.submenu),s=t.createMenu(i.name,n),a=o.getBoundingClientRect(),l=t.show(s,r);t.setSubMenuPosition(a,s),l.selectCell(0,0)}e.Dom.enableImmediatePropagation(t);var c=this,h=o.getSelected();switch(t.keyCode){case e.helper.keyCode.ESCAPE:c.closeAll(),t.preventDefault(),t.stopImmediatePropagation();break;case e.helper.keyCode.ENTER:h&&c.performAction(t,o);break;case e.helper.keyCode.ARROW_DOWN:h?s(h[0],h[1],o,c):n(o,c),t.preventDefault(),t.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_UP:h?a(h[0],h[1],o,c):i(o,c),t.preventDefault(),t.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_RIGHT:if(h){var u=h[0],d=o.getCell(h[0],0);r.utils.hasSubMenu(d)&&l(o,c,d,u)}t.preventDefault(),t.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_LEFT:if(h){if(-1!=o.rootElement.className.indexOf("htContextSubMenu_")){c.closeLastOpenedSubMenu();var f=c.menus.length;if(f>0){var p=c.menus[f-1],m=c.triggerRows.pop();o=this.htMenus[p.id],o.selectCell(m,0)}}t.preventDefault(),t.stopImmediatePropagation()}}},r.prototype.getItems=function(t){function o(t){"string"==typeof t?this.name=t:e.helper.extend(this,t)}var n,i;o.prototype=t,t&&t.items&&(t=t.items),t===!0&&(t=this.defaultOptions.items),n=[];for(var r in t)t.hasOwnProperty(r)&&(i="string"==typeof t[r]?s(this.defaultOptions.items,t[r]):s(this.defaultOptions.items,r),i||(i=t[r]),i=new o(i),"object"==typeof t[r]&&e.helper.extend(i,t[r]),i.key||(i.key=r),n.push(i));return n},r.prototype.setSubMenuPosition=function(t,o){var n=e.Dom.getWindowScrollTop(),i=e.Dom.getWindowScrollLeft(),r={top:n+t.top,topRelative:t.top,left:t.left,leftRelative:t.left-i,scrollTop:n,scrollLeft:i,cellHeight:t.height,cellWidth:t.width};this.menuFitsBelowCursor(r,o,document.body.clientWidth)?this.positionMenuBelowCursor(r,o,!0):this.menuFitsAboveCursor(r,o)?this.positionMenuAboveCursor(r,o,!0):this.positionMenuBelowCursor(r,o,!0),this.menuFitsOnRightOfCursor(r,o,document.body.clientWidth)?this.positionMenuOnRightOfCursor(r,o,!0):this.positionMenuOnLeftOfCursor(r,o,!0)},r.prototype.setMenuPosition=function(t,o){var n=e.Dom.getWindowScrollTop(),i=e.Dom.getWindowScrollLeft(),r=t.pageY||t.clientY+n,s=t.pageX||t.clientX+i,a={top:r,topRelative:r-n,left:s,leftRelative:s-i,scrollTop:n,scrollLeft:i,cellHeight:t.target.clientHeight,cellWidth:t.target.clientWidth};this.menuFitsBelowCursor(a,o,document.body.clientHeight)?this.positionMenuBelowCursor(a,o):this.menuFitsAboveCursor(a,o)?this.positionMenuAboveCursor(a,o):this.positionMenuBelowCursor(a,o),this.menuFitsOnRightOfCursor(a,o,document.body.clientWidth)?this.positionMenuOnRightOfCursor(a,o):this.positionMenuOnLeftOfCursor(a,o)},r.prototype.menuFitsAboveCursor=function(e,t){return e.topRelative>=t.offsetHeight},r.prototype.menuFitsBelowCursor=function(e,t,o){return e.topRelative+t.offsetHeight<=o},r.prototype.menuFitsOnRightOfCursor=function(e,t,o){return e.leftRelative+t.offsetWidth<=o},r.prototype.positionMenuBelowCursor=function(e,t){t.style.top=e.top+"px"},r.prototype.positionMenuAboveCursor=function(e,t,o){o?t.style.top=e.top+e.cellHeight-t.offsetHeight+"px":t.style.top=e.top-t.offsetHeight+"px"},r.prototype.positionMenuOnRightOfCursor=function(e,t,o){o?t.style.left=1+e.left+e.cellWidth+"px":t.style.left=1+e.left+"px"},r.prototype.positionMenuOnLeftOfCursor=function(e,t,o){o?t.style.left=e.left-t.offsetWidth+"px":t.style.left=e.left-t.offsetWidth+"px"},r.utils={},r.utils.normalizeSelection=function(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}},r.utils.isSeparator=function(t){return e.Dom.hasClass(t,"htSeparator")},r.utils.hasSubMenu=function(t){return e.Dom.hasClass(t,"htSubmenu")},r.utils.isDisabled=function(t){return e.Dom.hasClass(t,"htDisabled")},r.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())},r.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.closeAll(),this.unbindMouseEvents(),this.unbindTableEvents())},r.prototype.destroy=function(){for(this.closeAll();this.menus.length>0;){var e=this.menus.pop();this.triggerRows.pop(),e&&(this.close(e),this.isMenuEnabledByOtherHotInstance()||this.removeMenu(e))}this.unbindMouseEvents(),this.unbindTableEvents()},r.prototype.isMenuEnabledByOtherHotInstance=function(){for(var e=document.querySelectorAll(".handsontable"),t=!1,o=0,n=e.length;n>o;o++){var i=this.htMenus[e[o].id];if(i&&i.getSettings().contextMenu){t=!0;break}}return t},r.prototype.removeMenu=function(e){e.parentNode&&this.menu.parentNode.removeChild(e)},r.SEPARATOR={name:"---------"},e.hooks.add("afterInit",c),e.hooks.add("afterUpdateSettings",c),e.hooks.add("afterInit",l),e.PluginHooks.register("afterContextMenuDefaultOptions"),e.ContextMenu=r}(t);var $=function(){var e=this,o=e.getSettings().comments;o&&(t.Comments=new i(e),t.Comments.init())},W=function(e,o,n,i,r,s){s.comment&&t.Dom.addClass(e,s.commentedCellClassName)},B=function(e){var o=this;o.getSettings().comments&&(e.items.push(t.ContextMenu.SEPARATOR),e.items.push({key:"commentsAddEdit",name:function(){var e=t.Comments.checkSelectionCommentsConsistency();return e?"Edit Comment":"Add Comment"},callback:function(e,o,n){t.Comments.showComment(this.getSelectedRange())},disabled:function(){return!1}}),e.items.push({key:"commentsRemove",name:function(){return"Delete Comment"},callback:function(e,o,n){t.Comments.removeComment(o.start.row,o.start.col)},disabled:function(){var e=t.Comments.checkSelectionCommentsConsistency();return!e}}))};t.hooks.add("beforeInit",$),t.hooks.add("afterContextMenuDefaultOptions",B),t.hooks.add("afterRenderer",W),function(t){function o(){function o(e){d=this,f=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){u=t;var o=f.getBoundingClientRect();h=o.left,p.style.top=o.top+"px",p.style.left=h+"px",d.rootElement.appendChild(p)}}function n(e,t){var o=e.getBoundingClientRect(),n=6;t>0?p.style.left=o.left+o.width-n+"px":p.style.left=o.left+"px"}function i(){var e=this;
t.Dom.addClass(p,"active"),t.Dom.addClass(m,"active");var o=f.getBoundingClientRect();m.style.width=o.width+"px",m.style.height=e.view.maximumVisibleElementHeight(0)+"px",m.style.top=p.style.top,m.style.left=h+"px",e.rootElement.appendChild(m)}function r(e){m.style.left=h+e+"px"}function s(){t.Dom.removeClass(p,"active"),t.Dom.removeClass(m,"active")}var a,l,c,h,u,d,f,p=document.createElement("DIV"),m=document.createElement("DIV"),g=t.eventManager(this);p.className="manualColumnMover",m.className="manualColumnMoverGuide";var v=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualColumnPositions",e.manualColumnPositions)},w=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","manualColumnPositions",o),o.value},y=function(e){return"BODY"!=e.tagName?"THEAD"==e.parentNode.tagName?!0:(e=e.parentNode,y(e)):!1},C=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:C(e.parentNode):null},b=function(){var h,d=this;g.addEventListener(d.rootElement,"mouseover",function(e){if(y(e.target)){var t=C(e.target);if(t)if(h){var i=d.view.wt.wtTable.getCoords(t).col;i>=0&&(l=i,n(e.target,l-a))}else o.call(d,t)}}),g.addEventListener(d.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualColumnMover")&&(c=t.helper.pageX(e),i.call(d),h=d,a=u,l=u)}),g.addEventListener(e,"mousemove",function(e){h&&r(t.helper.pageX(e)-c)}),g.addEventListener(e,"mouseup",function(e){h&&(s(),h=!1,R(d.manualColumnPositions,d.countCols()),d.manualColumnPositions.splice(l,0,d.manualColumnPositions.splice(a,1)[0]),d.forceFullRender=!0,d.view.render(),v.call(d),t.hooks.run(d,"afterColumnMove",a,l),o.call(d,f))}),d.addHook("afterDestroy",_)},_=function(){g.clear()},R=function(e,t){if(e.length<t)for(var o=e.length;t>o;o++)e[o]=o};this.beforeInit=function(){this.manualColumnPositions=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualColumnMove;if(o){var n=this.getSettings().manualColumnMove,i=w.call(t);"undefined"!=typeof i?this.manualColumnPositions=i:Array.isArray(n)?this.manualColumnPositions=n:this.manualColumnPositions=[],"afterInit"==e&&("undefined"!=typeof t.manualColumnPositionsPluginUsages?t.manualColumnPositionsPluginUsages.push("manualColumnMove"):t.manualColumnPositionsPluginUsages=["manualColumnMove"],b.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))}else{var r=t.manualColumnPositionsPluginUsages?t.manualColumnPositionsPluginUsages.indexOf("manualColumnMove"):-1;r>-1&&(_.call(this),this.manualColumnPositions=[],t.manualColumnPositionsPluginUsages[r]=void 0)}},this.modifyCol=function(e){return this.getSettings().manualColumnMove?("undefined"==typeof this.manualColumnPositions[e]&&R(this.manualColumnPositions,e+1),this.manualColumnPositions[e]):e},this.afterRemoveCol=function(e,t){if(this.getSettings().manualColumnMove){var o,n=this.manualColumnPositions;o=n.splice(e,t),n=n.map(function(e){var t,n=e;for(t=0;t<o.length;t++)e>o[t]&&n--;return n}),this.manualColumnPositions=n}},this.afterCreateCol=function(e,t){if(this.getSettings().manualColumnMove){var o=this.manualColumnPositions;if(o.length){for(var n=[],i=0;t>i;i++)n.push(e+i);e>=o.length?o.concat(n):(o=o.map(function(o){return o>=e?o+t:o}),o.splice.apply(o,[e,0].concat(n))),this.manualColumnPositions=o}}}}var n=new o;t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyCol",n.modifyCol),t.hooks.add("afterRemoveCol",n.afterRemoveCol),t.hooks.add("afterCreateCol",n.afterCreateCol),t.hooks.register("afterColumnMove")}(t),function(t){function o(){function o(e){h=this,a=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){l=t;var o=a.getBoundingClientRect();p=o.left-6,f=parseInt(o.width,10),m.style.top=o.top+"px",m.style.left=p+f+"px",h.rootElement.appendChild(m)}}function n(){m.style.left=p+c+"px"}function i(){var e=this;t.Dom.addClass(m,"active"),t.Dom.addClass(g,"active"),g.style.top=m.style.top,g.style.left=m.style.left,g.style.height=e.view.maximumVisibleElementHeight(0)+"px",e.rootElement.appendChild(g)}function r(){g.style.left=m.style.left}function s(){t.Dom.removeClass(m,"active"),t.Dom.removeClass(g,"active")}var a,l,c,h,u,d,f,p,m=document.createElement("DIV"),g=document.createElement("DIV"),v=t.eventManager(this);m.className="manualColumnResizer",g.className="manualColumnResizerGuide";var w=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualColumnWidths",e.manualColumnWidths)},y=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","manualColumnWidths",o),o.value},C=function(e){return"BODY"!=e.tagName?"THEAD"==e.parentNode.tagName?!0:(e=e.parentNode,C(e)):!1},b=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:b(e.parentNode):null},_=function(){var h,p=this,m=0,g=null;v.addEventListener(p.rootElement,"mouseover",function(e){if(C(e.target)){var t=b(e.target);t&&(h||o.call(p,t))}}),v.addEventListener(p.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualColumnResizer")&&(i.call(p),h=p,null==g&&(g=setTimeout(function(){m>=2&&(u=p.determineColumnWidth.call(p,l),S(l,u),p.forceFullRender=!0,p.view.render(),t.hooks.run(p,"afterColumnResize",l,u)),m=0,g=null},500),p._registerTimeout(g)),m++,d=t.helper.pageX(e),u=f)}),v.addEventListener(e,"mousemove",function(e){h&&(c=f+(t.helper.pageX(e)-d),u=S(l,c),n(),r())}),v.addEventListener(e,"mouseup",function(){h&&(s(),h=!1,u!=f&&(p.forceFullRender=!0,p.view.render(),w.call(p),t.hooks.run(p,"afterColumnResize",l,u)),o.call(p,a))}),p.addHook("afterDestroy",R)},R=function(){v.clear()};this.beforeInit=function(){this.manualColumnWidths=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualColumnResize;if(o){var n=this.getSettings().manualColumnResize,i=y.call(t);"undefined"!=typeof t.manualColumnWidthsPluginUsages?t.manualColumnWidthsPluginUsages.push("manualColumnResize"):t.manualColumnWidthsPluginUsages=["manualColumnResize"],"undefined"!=typeof i?this.manualColumnWidths=i:Array.isArray(n)?this.manualColumnWidths=n:this.manualColumnWidths=[],"afterInit"==e&&(_.call(this),this.manualColumnWidths.length>0&&(this.forceFullRender=!0,this.render()))}else{var r=t.manualColumnWidthsPluginUsages?t.manualColumnWidthsPluginUsages.indexOf("manualColumnResize"):-1;r>-1&&(R.call(this),this.manualColumnWidths=[])}};var S=function(e,o){return o=Math.max(o,20),e=t.hooks.run(h,"modifyCol",e),h.manualColumnWidths[e]=o,o};this.modifyColWidth=function(e,t){return t=this.runHooks("modifyCol",t),this.getSettings().manualColumnResize&&this.manualColumnWidths[t]?this.manualColumnWidths[t]:e}}var n=new o;t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyColWidth",n.modifyColWidth),t.hooks.register("afterColumnResize")}(t),function(t){function o(){function o(e){h=this,a=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){l=t;var o=a.getBoundingClientRect();p=o.top-6,f=parseInt(o.height,10),m.style.left=o.left+"px",m.style.top=p+f+"px",h.rootElement.appendChild(m)}}function n(){m.style.top=p+c+"px"}function i(){var e=this;t.Dom.addClass(m,"active"),t.Dom.addClass(g,"active"),g.style.top=m.style.top,g.style.left=m.style.left,g.style.width=e.view.maximumVisibleElementWidth(0)+"px",e.rootElement.appendChild(g)}function r(){g.style.top=m.style.top}function s(){t.Dom.removeClass(m,"active"),t.Dom.removeClass(g,"active")}var a,l,c,h,u,d,f,p,m=document.createElement("DIV"),g=document.createElement("DIV"),v=t.eventManager(this);m.className="manualRowResizer",g.className="manualRowResizerGuide";var w=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualRowHeights",e.manualRowHeights)},y=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","manualRowHeights",o),o.value},C=function(e){return"BODY"!=e.tagName?"TBODY"==e.parentNode.tagName?!0:(e=e.parentNode,C(e)):!1},b=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:b(e.parentNode):null},_=function(){var h,p=this,m=0,g=null;v.addEventListener(p.rootElement,"mouseover",function(e){if(C(e.target)){var t=b(e.target);t&&(h||o.call(p,t))}}),v.addEventListener(p.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualRowResizer")&&(i.call(p),h=p,null==g&&(g=setTimeout(function(){m>=2&&(S(l,null),p.forceFullRender=!0,p.view.render(),t.hooks.run(p,"afterRowResize",l,u)),m=0,g=null},500),p._registerTimeout(g)),m++,d=t.helper.pageY(e),u=f)}),v.addEventListener(e,"mousemove",function(e){h&&(c=f+(t.helper.pageY(e)-d),u=S(l,c),n(),r())}),v.addEventListener(e,"mouseup",function(e){h&&(s(),h=!1,u!=f&&(p.forceFullRender=!0,p.view.render(),w.call(p),t.hooks.run(p,"afterRowResize",l,u)),o.call(p,a))}),p.addHook("afterDestroy",R)},R=function(){v.clear()};this.beforeInit=function(){this.manualRowHeights=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualRowResize;if(o){var n=this.getSettings().manualRowResize,i=y.call(t);"undefined"!=typeof t.manualRowHeightsPluginUsages?t.manualRowHeightsPluginUsages.push("manualRowResize"):t.manualRowHeightsPluginUsages=["manualRowResize"],"undefined"!=typeof i?this.manualRowHeights=i:Array.isArray(n)?this.manualRowHeights=n:this.manualRowHeights=[],"afterInit"===e?(_.call(this),this.manualRowHeights.length>0&&(this.forceFullRender=!0,this.render())):(this.forceFullRender=!0,this.render())}else{var r=t.manualRowHeightsPluginUsages?t.manualRowHeightsPluginUsages.indexOf("manualRowResize"):-1;r>-1&&(R.call(this),this.manualRowHeights=[],t.manualRowHeightsPluginUsages[r]=void 0)}};var S=function(e,o){return e=t.hooks.run(h,"modifyRow",e),h.manualRowHeights[e]=o,o};this.modifyRowHeight=function(e,t){return this.getSettings().manualRowResize&&(t=this.runHooks("modifyRow",t),void 0!==this.manualRowHeights[t])?this.manualRowHeights[t]:e}}var n=new o;t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyRowHeight",n.modifyRowHeight),t.hooks.register("afterRowResize")}(t),function(){function e(){var e=this,t=e.getSettings().observeChanges;t?(e.observer&&i.call(e),o.call(e),s.call(e)):t||i.call(e)}function o(){var e=this;e.observeChangesActive=!0,e.pauseObservingChanges=function(){e.observeChangesActive=!1},e.resumeObservingChanges=function(){e.observeChangesActive=!0},e.observedData=e.getData(),e.observer=M.observe(e.observedData,function(t){e.observeChangesActive&&(n.call(e,t),e.render()),e.runHooks("afterChangesObserved")})}function n(e){function t(e){var t;return t=n(e),t=o(t)}function o(e){var t=[];return e.filter(function(e){var o=i(e.path);if(-1!=["add","remove"].indexOf(e.op)&&!isNaN(o.col)){if(-1!=t.indexOf(o.col))return!1;t.push(o.col)}return!0})}function n(e){return e.filter(function(e){return!/[/]length/gi.test(e.path)})}function i(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}for(var r=this,s=t(e),a=0,l=s.length;l>a;a++){var c=s[a],h=i(c.path);switch(c.op){case"add":isNaN(h.col)?r.runHooks("afterCreateRow",h.row):r.runHooks("afterCreateCol",h.col);break;case"remove":isNaN(h.col)?r.runHooks("afterRemoveRow",h.row,1):r.runHooks("afterRemoveCol",h.col,1);break;case"replace":r.runHooks("afterChange",[h.row,h.col,null,c.value],"external")}}}function i(){var e=this;e.observer&&(r.call(e),a.call(e))}function r(){var e=this;M.unobserve(e.observedData,e.observer),delete e.observeChangesActive,delete e.pauseObservingChanges,delete e.resumeObservingChanges}function s(){var e=this;e.addHook("afterDestroy",i),e.addHook("afterCreateRow",l),e.addHook("afterRemoveRow",l),e.addHook("afterCreateCol",l),e.addHook("afterRemoveCol",l),e.addHook("afterChange",function(e,t){"loadData"!=t&&l.call(this)})}function a(){var e=this;e.removeHook("afterDestroy",i),e.removeHook("afterCreateRow",l),e.removeHook("afterRemoveRow",l),e.removeHook("afterCreateCol",l),e.removeHook("afterRemoveCol",l),e.removeHook("afterChange",l)}function l(){var e=this;e.pauseObservingChanges(),e.addHookOnce("afterChangesObserved",function(){e.resumeObservingChanges()})}t.hooks.add("afterLoadData",e),t.hooks.add("afterUpdateSettings",e),t.hooks.register("afterChangesObserved")}(),function(e){function o(){function o(){var e=this;for(var t in r)r.hasOwnProperty(t)&&e.addHook(t,r[t])}function n(){var e=this;for(var t in r)r.hasOwnProperty(t)&&e.removeHook(t,r[t])}var i=this;this.init=function(){var t=this,r=t.getSettings().persistentState;return i.enabled=!!r,i.enabled?(t.storage||(t.storage=new e(t.rootElement.id)),t.resetState=i.resetValue,void o.call(t)):void n.call(t)},this.saveValue=function(e,t){var o=this;o.storage.saveValue(e,t)},this.loadValue=function(e,t){var o=this;t.value=o.storage.loadValue(e)},this.resetValue=function(e){var t=this;"undefined"!=typeof e?t.storage.reset(e):t.storage.resetAll()};var r={persistentStateSave:i.saveValue,persistentStateLoad:i.loadValue,persistentStateReset:i.resetValue};for(var s in r)r.hasOwnProperty(s)&&t.hooks.register(s)}var n=new o;t.hooks.add("beforeInit",n.init),t.hooks.add("afterUpdateSettings",n.init)}(r),function(e){e.UndoRedo=function(t){var o=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,t.addHook("afterChange",function(t,n){if(t){var i=new e.UndoRedo.ChangeAction(t);o.done(i)}}),t.addHook("afterCreateRow",function(t,n,i){if(!i){var r=new e.UndoRedo.CreateRowAction(t,n);o.done(r)}}),t.addHook("beforeRemoveRow",function(t,n){var i=o.instance.getData();t=(i.length+t)%i.length;var r=i.slice(t,t+n),s=new e.UndoRedo.RemoveRowAction(t,r);o.done(s)}),t.addHook("afterCreateCol",function(t,n,i){if(!i){var r=new e.UndoRedo.CreateColumnAction(t,n);o.done(r)}}),t.addHook("beforeRemoveCol",function(n,i){var r=o.instance.getData();n=(o.instance.countCols()+n)%o.instance.countCols();for(var s=[],a=0,l=r.length;l>a;a++)s[a]=r[a].slice(n,n+i);var c;Array.isArray(t.getSettings().colHeaders)&&(c=t.getSettings().colHeaders.slice(n,n+s.length));var h=new e.UndoRedo.RemoveColumnAction(n,s,c);o.done(h)})},e.UndoRedo.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)},e.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop();this.ignoreNewActions=!0;var t=this;e.undo(this.instance,function(){t.ignoreNewActions=!1,t.undoneActions.push(e)})}},e.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop();this.ignoreNewActions=!0;var t=this;e.redo(this.instance,function(){t.ignoreNewActions=!1,t.doneActions.push(e)})}},e.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},e.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},e.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},e.UndoRedo.Action=function(){},e.UndoRedo.Action.prototype.undo=function(){},e.UndoRedo.Action.prototype.redo=function(){},e.UndoRedo.ChangeAction=function(e){this.changes=e},e.helper.inherit(e.UndoRedo.ChangeAction,e.UndoRedo.Action),e.UndoRedo.ChangeAction.prototype.undo=function(t,o){for(var n=e.helper.deepClone(this.changes),i=t.countEmptyRows(!0),r=t.countEmptyCols(!0),s=0,a=n.length;a>s;s++)n[s].splice(3,1);t.addHookOnce("afterChange",o),t.setDataAtRowProp(n,null,null,"undo");for(var s=0,a=n.length;a>s;s++)t.getSettings().minSpareRows&&n[s][0]+1+t.getSettings().minSpareRows===t.countRows()&&i==t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(n[s][0]+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&n[s][1]+1+t.getSettings().minSpareCols===t.countCols()&&r==t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(n[s][1]+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())},e.UndoRedo.ChangeAction.prototype.redo=function(t,o){for(var n=e.helper.deepClone(this.changes),i=0,r=n.length;r>i;i++)n[i].splice(2,1);t.addHookOnce("afterChange",o),t.setDataAtRowProp(n,null,null,"redo")},e.UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t},e.helper.inherit(e.UndoRedo.CreateRowAction,e.UndoRedo.Action),e.UndoRedo.CreateRowAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount)},e.UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index+1,this.amount)},e.UndoRedo.RemoveRowAction=function(e,t){this.index=e,this.data=t},e.helper.inherit(e.UndoRedo.RemoveRowAction,e.UndoRedo.Action),e.UndoRedo.RemoveRowAction.prototype.undo=function(e,t){var o=[this.index,0];Array.prototype.push.apply(o,this.data),Array.prototype.splice.apply(e.getData(),o),e.addHookOnce("afterRender",t),e.render()},e.UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length)},e.UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t},e.helper.inherit(e.UndoRedo.CreateColumnAction,e.UndoRedo.Action),e.UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)},e.UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index+1,this.amount)},e.UndoRedo.RemoveColumnAction=function(e,t,o){this.index=e,this.data=t,this.amount=this.data[0].length,this.headers=o},e.helper.inherit(e.UndoRedo.RemoveColumnAction,e.UndoRedo.Action),e.UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){for(var o,n,i=0,r=e.getData().length;r>i;i++)o=e.getSourceDataAtRow(i),n=[this.index,0],Array.prototype.push.apply(n,this.data[i]),Array.prototype.splice.apply(o,n);"undefined"!=typeof this.headers&&(n=[this.index,0],Array.prototype.push.apply(n,this.headers),Array.prototype.splice.apply(e.getSettings().colHeaders,n)),e.addHookOnce("afterRender",t),e.render()},e.UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)}}(t),function(e){function t(){var t=this,s="undefined"==typeof t.getSettings().undo||t.getSettings().undo;s?t.undoRedo||(t.undoRedo=new e.UndoRedo(t),i(t),t.addHook("beforeKeyDown",o),t.addHook("afterChange",n)):t.undoRedo&&(delete t.undoRedo,r(t),t.removeHook("beforeKeyDown",o),t.removeHook("afterChange",n))}function o(e){var t=this,o=(e.ctrlKey||e.metaKey)&&!e.altKey;o&&(89===e.keyCode||e.shiftKey&&90===e.keyCode?(t.undoRedo.redo(),e.stopImmediatePropagation()):90===e.keyCode&&(t.undoRedo.undo(),e.stopImmediatePropagation()))}function n(e,t){var o=this;return"loadData"==t?o.undoRedo.clear():void 0}function i(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function r(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}e.hooks.add("afterInit",t),e.hooks.add("afterUpdateSettings",t)}(t),s.prototype.setBoundaries=function(e){this.boundaries=e},s.prototype.setCallback=function(e){this.callback=e},s.prototype.check=function(e,t){var o=0,n=0;t<this.boundaries.top?n=t-this.boundaries.top:t>this.boundaries.bottom&&(n=t-this.boundaries.bottom),e<this.boundaries.left?o=e-this.boundaries.left:e>this.boundaries.right&&(o=e-this.boundaries.right),this.callback(o,n)};var F,V;if("undefined"!=typeof t){var j=function(t){t.dragToScrollListening=!1;var o=t.view.wt.wtScrollbars.vertical.scrollHandler;F=new s,o!==e&&(F.setBoundaries(o.getBoundingClientRect()),F.setCallback(function(e,t){0>e?o.scrollLeft-=50:e>0&&(o.scrollLeft+=50),0>t?o.scrollTop-=20:t>0&&(o.scrollTop+=20)}),t.dragToScrollListening=!0)};t.hooks.add("afterInit",function(){var e=this,o=t.eventManager(this);o.addEventListener(document,"mouseup",function(){e.dragToScrollListening=!1}),o.addEventListener(document,"mousemove",function(t){e.dragToScrollListening&&F.check(t.clientX,t.clientY)})}),t.hooks.add("afterDestroy",function(){var e=t.eventManager(this);e.clear()}),t.hooks.add("afterOnCellMouseDown",function(){j(this)}),t.hooks.add("afterOnCellCornerMouseDown",function(){j(this)}),t.plugins.DragToScroll=s}if(function(e,t,o){function n(n){function i(){n.isListening()&&n.selection.empty()}function r(e){var t,i,r,s,a,l,c,h,f,p;n.isListening()&&n.selection.isSelected()&&(t=e,i=o.parse(t),r=n.getSelected(),s=new u(r[0],r[1]),a=new u(r[2],r[3]),l=new d(s,s,a),c=l.getTopLeftCorner(),h=l.getBottomRightCorner(),f=c,p=new u(Math.max(h.row,i.length-1+c.row),Math.max(h.col,i[0].length-1+c.col)),n.addHookOnce("afterChange",function(e,t){e&&e.length&&this.selectCell(f.row,f.col,p.row,p.col)}),n.populateFromArray(f.row,f.col,i,p.row,p.col,"paste",n.getSettings().pasteMode))}function s(t){var o;if(n.getSelected()){if(e.helper.isCtrlKey(t.keyCode))return a.setCopyableText(),void t.stopImmediatePropagation();o=(t.ctrlKey||t.metaKey)&&!t.altKey,t.keyCode==e.helper.keyCode.A&&o&&n._registerTimeout(setTimeout(e.helper.proxy(a.setCopyableText,a),0))}}var a=this;this.copyPasteInstance=t.getInstance(),this.copyPasteInstance.onCut(i),this.copyPasteInstance.onPaste(r),n.addHook("beforeKeyDown",s),this.destroy=function(){this.copyPasteInstance.removeCallback(i),this.copyPasteInstance.removeCallback(r),this.copyPasteInstance.destroy(),n.removeHook("beforeKeyDown",s)},n.addHook("afterDestroy",e.helper.proxy(this.destroy,this)),this.triggerPaste=e.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=e.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var t=n.getSettings(),o=t.copyRowsLimit,i=t.copyColsLimit,r=n.getSelectedRange(),s=r.getTopLeftCorner(),a=r.getBottomRightCorner(),l=s.row,c=s.col,h=a.row,u=a.col,d=Math.min(h,l+o-1),f=Math.min(u,c+i-1);n.copyPaste.copyPasteInstance.copyable(n.getCopyableData(l,c,d,f)),(h!==d||u!==f)&&e.hooks.run(n,"afterCopyLimit",h-l+1,u-c+1,o,i)}}function i(){var e=this,t=e.getSettings().copyPaste!==!1;t&&!e.copyPaste?e.copyPaste=new n(e):!t&&e.copyPaste&&(e.copyPaste.destroy(),delete e.copyPaste)}e.hooks.add("afterInit",i),e.hooks.add("afterUpdateSettings",i),e.hooks.register("afterCopyLimit")}(t,I,SheetClip),function(e){function t(){var t=this,o=!!t.getSettings().search;o?t.search=new e.Search(t):delete t.search}e.Search=function(t){this.query=function(o,n,i){var r=t.countRows(),s=t.countCols(),a=[];n||(n=e.Search.global.getDefaultCallback()),i||(i=e.Search.global.getDefaultQueryMethod());for(var l=0;r>l;l++)for(var c=0;s>c;c++){var h=t.getDataAtCell(l,c),u=t.getCellMeta(l,c),d=u.search.callback||n,f=u.search.queryMethod||i,p=f(o,h);if(p){var m={row:l,col:c,data:h};a.push(m)}d&&d(t,l,c,h,p)}return a}},e.Search.DEFAULT_CALLBACK=function(e,t,o,n,i){e.getCellMeta(t,o).isSearchResult=i},e.Search.DEFAULT_QUERY_METHOD=function(e,t){return"undefined"!=typeof e&&null!=e&&e.toLowerCase&&0!==e.length?"undefined"==typeof t||null==t?!1:-1!=t.toString().toLowerCase().indexOf(e.toLowerCase()):!1},e.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",e.Search.global=function(){var t=e.Search.DEFAULT_CALLBACK,o=e.Search.DEFAULT_QUERY_METHOD,n=e.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return t},setDefaultCallback:function(e){t=e},getDefaultQueryMethod:function(){return o},setDefaultQueryMethod:function(e){o=e},getDefaultSearchResultClass:function(){return n},setDefaultSearchResultClass:function(e){n=e}}}(),e.SearchCellDecorator=function(t,o,n,i,r,s,a){var l="object"==typeof a.search&&a.search.searchResultClass||e.Search.global.getDefaultSearchResultClass();a.isSearchResult?e.Dom.addClass(o,l):e.Dom.removeClass(o,l)};var o=e.renderers.cellDecorator;e.renderers.cellDecorator=function(t,n,i,r,s,a,l){o.apply(this,arguments),e.SearchCellDecorator.apply(this,arguments)},e.hooks.add("afterInit",t),e.hooks.add("afterUpdateSettings",t)}(t),l.prototype.canMergeRange=function(e){return!e.isSingle()},l.prototype.mergeRange=function(e){if(this.canMergeRange(e)){var t=e.getTopLeftCorner(),o=e.getBottomRightCorner(),n={};n.row=t.row,n.col=t.col,n.rowspan=o.row-t.row+1,n.colspan=o.col-t.col+1,this.mergedCellInfoCollection.setInfo(n)}},l.prototype.mergeOrUnmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.from.row,e.from.col);t?this.unmergeSelection(e.from):this.mergeSelection(e)},l.prototype.mergeSelection=function(e){this.mergeRange(e)},l.prototype.unmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.row,e.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)},l.prototype.applySpanProperties=function(e,t,o){var n=this.mergedCellInfoCollection.getInfo(t,o);n?n.row===t&&n.col===o?(e.setAttribute("rowspan",n.rowspan),e.setAttribute("colspan",n.colspan)):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"))},l.prototype.modifyTransform=function(e,t,o){var n=function(e,t){return t.row>=e.row&&t.row<=e.row+e.rowspan-1?!0:!1},i=function(e,t){return t.col>=e.col&&t.col<=e.col+e.colspan-1?!0:!1},r=function(e){return new u(t.to.row+e.row,t.to.col+e.col)},s={row:o.row,col:o.col};if("modifyTransformStart"==e){this.lastDesiredCoords||(this.lastDesiredCoords=new u(null,null));for(var a,l=new u(t.highlight.row,t.highlight.col),c=this.mergedCellInfoCollection.getInfo(l.row,l.col),h=0,f=this.mergedCellInfoCollection.length;f>h;h++){var p=this.mergedCellInfoCollection[h];if(p=new u(p.row+p.rowspan-1,p.col+p.colspan-1),t.includes(p)){a=!0;break}}if(c){var m=new u(c.row,c.col),g=new u(c.row+c.rowspan-1,c.col+c.colspan-1),v=new d(m,m,g);v.includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new u(null,null)),s.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-l.row:s.row,s.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-l.col:s.col,o.row>0?s.row=c.row+c.rowspan-1-l.row+o.row:o.row<0&&(s.row=l.row-c.row+o.row),o.col>0?s.col=c.col+c.colspan-1-l.col+o.col:o.col<0&&(s.col=l.col-c.col+o.col)}var w=new u(t.highlight.row+s.row,t.highlight.col+s.col),y=this.mergedCellInfoCollection.getInfo(w.row,w.col);y&&(this.lastDesiredCoords=w,s={row:y.row-l.row,col:y.col-l.col})}else if("modifyTransformEnd"==e)for(var h=0,f=this.mergedCellInfoCollection.length;f>h;h++){var C=this.mergedCellInfoCollection[h],m=new u(C.row,C.col),g=new u(C.row+C.rowspan-1,C.col+C.colspan-1),b=new d(m,m,g),_=t.getBordersSharedWith(b);if(b.isEqual(t))t.setDirection("NW-SE");else if(_.length>0){var R=t.highlight.isEqual(b.from);_.indexOf("top")>-1?t.to.isSouthEastOf(b.from)&&R?t.setDirection("NW-SE"):t.to.isSouthWestOf(b.from)&&R&&t.setDirection("NE-SW"):_.indexOf("bottom")>-1&&(t.to.isNorthEastOf(b.from)&&R?t.setDirection("SW-NE"):t.to.isNorthWestOf(b.from)&&R&&t.setDirection("SE-NW"))}var w=r(s),S=n(C,w),E=i(C,w);t.includesRange(b)&&(b.includes(w)||S||E)&&(S&&(s.row<0?s.row-=C.rowspan-1:s.row>0&&(s.row+=C.rowspan-1)),E&&(s.col<0?s.col-=C.colspan-1:s.col>0&&(s.col+=C.colspan-1)))}0!==s.row&&(o.row=s.row),0!==s.col&&(o.col=s.col)},"undefined"==typeof t)throw new Error("Handsontable is not defined");var z=function(){var e=this,t=e.getSettings().mergeCells;t&&(e.mergeCells||(e.mergeCells=new l(t)))},G=function(){var e=this;e.mergeCells&&(e.view.wt.wtTable.getCell=function(t){if(e.getSettings().mergeCells){var o=e.mergeCells.mergedCellInfoCollection.getInfo(t.row,t.col);o&&(t=o)}return k.prototype.getCell.call(this,t)})},U=function(e){if(this.mergeCells){var t=(e.ctrlKey||e.metaKey)&&!e.altKey;t&&77===e.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),e.stopImmediatePropagation())}},q=function(e){this.getSettings().mergeCells&&(e.items.push(t.ContextMenu.SEPARATOR),e.items.push({key:"mergeCells",name:function(){var e=this.getSelected(),t=this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1]);return t?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render()},disabled:function(){return!1}}))},W=function(e,t,o,n,i,r){this.mergeCells&&this.mergeCells.applySpanProperties(e,t,o)},K=function(e){return function(t){var o=this.getSettings().mergeCells;if(o){var n=this.getSelectedRange();if(this.mergeCells.modifyTransform(e,n,t),"modifyTransformEnd"===e){var i=this.countRows(),r=this.countCols();n.from.row<0?n.from.row=0:n.from.row>0&&n.from.row>=i&&(n.from.row=n.from-1),n.from.col<0?n.from.col=0:n.from.col>0&&n.from.col>=r&&(n.from.col=r-1)}}}},Y=function(e){this.lastDesiredCoords=null;var t=this.getSettings().mergeCells;if(t){var o=this.getSelectedRange();o.highlight=new u(o.highlight.row,o.highlight.col),o.to=e;var n=!1;do{n=!1;for(var i=0,r=this.mergeCells.mergedCellInfoCollection.length;r>i;i++){var s=this.mergeCells.mergedCellInfoCollection[i],a=new u(s.row,s.col),l=new u(s.row+s.rowspan-1,s.col+s.colspan-1),c=new d(a,a,l);o.expandByRange(c)&&(e.row=o.to.row,e.col=o.to.col,n=!0)}}while(n)}},X=function(e,t){if(t&&"area"==t){var o=this.getSettings().mergeCells;if(o)for(var n=this.getSelectedRange(),i=new d(n.from,n.from,n.from),r=new d(n.to,n.to,n.to),s=0,a=this.mergeCells.mergedCellInfoCollection.length;a>s;s++){var l=this.mergeCells.mergedCellInfoCollection[s],c=new u(l.row,l.col),h=new u(l.row+l.rowspan-1,l.col+l.colspan-1),f=new d(c,c,h);i.expandByRange(f)&&(e[0]=i.from.row,e[1]=i.from.col),r.expandByRange(f)&&(e[2]=r.from.row,e[3]=r.from.col)}}},J=function(e,t,o){var n=this.getSettings().mergeCells;if(n){var i=this.mergeCells.mergedCellInfoCollection.getInfo(e,t);!i||i.row==e&&i.col==t||(o.copyable=!1)}},Q=function(e){var t=this.getSettings().mergeCells;if(t)for(var o,n=this.countCols(),i=0;n>i;i++){if(o=this.mergeCells.mergedCellInfoCollection.getInfo(e.startRow,i),o&&o.row<e.startRow)return e.startRow=o.row,Q.call(this,e);if(o=this.mergeCells.mergedCellInfoCollection.getInfo(e.endRow,i)){var r=o.row+o.rowspan-1;if(r>e.endRow)return e.endRow=r,Q.call(this,e)}}},Z=function(e){var t=this.getSettings().mergeCells;if(t)for(var o,n=this.countRows(),i=0;n>i;i++){if(o=this.mergeCells.mergedCellInfoCollection.getInfo(i,e.startColumn),o&&o.col<e.startColumn)return e.startColumn=o.col,Z.call(this,e);if(o=this.mergeCells.mergedCellInfoCollection.getInfo(i,e.endColumn)){var r=o.col+o.colspan-1;if(r>e.endColumn)return e.endColumn=r,Z.call(this,e)}}},ee=function(e){if(e&&this.mergeCells){var t=this.mergeCells.mergedCellInfoCollection,o=this.getSelectedRange();for(var n in t)if(o.highlight.row==t[n].row&&o.highlight.col==t[n].col&&o.to.row==t[n].row+t[n].rowspan-1&&o.to.col==t[n].col+t[n].colspan-1)return!1}return e};t.hooks.add("beforeInit",z),t.hooks.add("afterInit",G),t.hooks.add("beforeKeyDown",U),t.hooks.add("modifyTransformStart",K("modifyTransformStart")),t.hooks.add("modifyTransformEnd",K("modifyTransformEnd")),t.hooks.add("beforeSetRangeEnd",Y),t.hooks.add("beforeDrawBorders",X),t.hooks.add("afterIsMultipleSelection",ee),t.hooks.add("afterRenderer",W),t.hooks.add("afterContextMenuDefaultOptions",q),t.hooks.add("afterGetCellMeta",J),t.hooks.add("afterViewportRowCalculatorOverride",Q),t.hooks.add("afterViewportColumnCalculatorOverride",Z),t.MergeCells=l,function(){function e(){}var o,n=function(e){return"boolean"==typeof e&&e===!0?!0:"object"==typeof e&&e.length>0?!0:!1},i=function(){n(this.getSettings().customBorders)&&(this.customBorders||(o=this,this.customBorders=new e))},r=function(e){for(var t=0;t<o.view.wt.selections.length;t++)if(o.view.wt.selections[t].settings.className==e)return t;return-1},s=function(e){var t={row:e.row,col:e.col},n=new E(e,new d(t,t,t)),i=r(e.className);i>=0?o.view.wt.selections[i]=n:o.view.wt.selections.push(n)},a=function(e,t,o){var n=p(e,t);n=m(n,o),this.setCellMeta(e,t,"borders",n),s(n)},l=function(e){for(var t=e.range,o=t.from.row;o<=t.to.row;o++)for(var n=t.from.col;n<=t.to.col;n++){var i=p(o,n),r=0;o==t.from.row&&(r++,e.hasOwnProperty("top")&&(i.top=e.top)),o==t.to.row&&(r++,e.hasOwnProperty("bottom")&&(i.bottom=e.bottom)),n==t.from.col&&(r++,e.hasOwnProperty("left")&&(i.left=e.left)),n==t.to.col&&(r++,e.hasOwnProperty("right")&&(i.right=e.right)),r>0&&(this.setCellMeta(o,n,"borders",i),s(i))}},c=function(e,t){return"border_row"+e+"col"+t},h=function(){return{width:1,color:"#000"}},u=function(){return{hide:!0}},f=function(){return{width:1,color:"#000",cornerVisible:!1}},p=function(e,t){return{className:c(e,t),border:f(),row:e,col:t,top:u(),right:u(),bottom:u(),left:u()}},m=function(e,t){return t.hasOwnProperty("border")&&(e.border=t.border),
t.hasOwnProperty("top")&&(e.top=t.top),t.hasOwnProperty("right")&&(e.right=t.right),t.hasOwnProperty("bottom")&&(e.bottom=t.bottom),t.hasOwnProperty("left")&&(e.left=t.left),e},g=function(e){for(var t=document.querySelectorAll("."+e),o=0;o<t.length;o++)if(t[o]&&"TD"!=t[o].nodeName){var n=t[o].parentNode;n.parentNode&&n.parentNode.removeChild(n)}},v=function(e,t){var o=c(e,t);g(o),this.removeCellMeta(e,t,"borders")},w=function(e,t,o,n){var i=this.getCellMeta(e,t).borders;i&&void 0!=i.border||(i=p(e,t)),n?i[o]=u():i[o]=h(),this.setCellMeta(e,t,"borders",i);var r=c(e,t);g(r),s(i),this.render()},y=function(e,t,o){if(e.from.row==e.to.row&&e.from.col==e.to.col)"noBorders"==t?v.call(this,e.from.row,e.from.col):w.call(this,e.from.row,e.from.col,t,o);else switch(t){case"noBorders":for(var n=e.from.col;n<=e.to.col;n++)for(var i=e.from.row;i<=e.to.row;i++)v.call(this,i,n);break;case"top":for(var r=e.from.col;r<=e.to.col;r++)w.call(this,e.from.row,r,t,o);break;case"right":for(var s=e.from.row;s<=e.to.row;s++)w.call(this,s,e.to.col,t);break;case"bottom":for(var a=e.from.col;a<=e.to.col;a++)w.call(this,e.to.row,a,t);break;case"left":for(var l=e.from.row;l<=e.to.row;l++)w.call(this,l,e.from.col,t)}},C=function(e,t){var o=!1;return e.getSelectedRange().forAll(function(n,i){var r=e.getCellMeta(n,i).borders;if(r){if(!t)return o=!0,!1;if(!r[t].hasOwnProperty("hide"))return o=!0,!1}}),o},b=function(e){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+e},_=function(e){this.getSettings().customBorders&&(e.items.push(t.ContextMenu.SEPARATOR),e.items.push({key:"borders",name:"Borders",submenu:{items:{top:{name:function(){var e="Top",t=C(this,"top");return t&&(e=b(e)),e},callback:function(){var e=C(this,"top");y.call(this,this.getSelectedRange(),"top",e)},disabled:!1},right:{name:function(){var e="Right",t=C(this,"right");return t&&(e=b(e)),e},callback:function(){var e=C(this,"right");y.call(this,this.getSelectedRange(),"right",e)},disabled:!1},bottom:{name:function(){var e="Bottom",t=C(this,"bottom");return t&&(e=b(e)),e},callback:function(){var e=C(this,"bottom");y.call(this,this.getSelectedRange(),"bottom",e)},disabled:!1},left:{name:function(){var e="Left",t=C(this,"left");return t&&(e=b(e)),e},callback:function(){var e=C(this,"left");y.call(this,this.getSelectedRange(),"left",e)},disabled:!1},remove:{name:"Remove border(s)",callback:function(){y.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!C(this)}}}}}))};t.hooks.add("beforeInit",i),t.hooks.add("afterContextMenuDefaultOptions",_),t.hooks.add("afterInit",function(){var e=this.getSettings().customBorders;if(e){for(var t=0;t<e.length;t++)e[t].range?l.call(this,e[t]):a.call(this,e[t].row,e[t].col,e[t]);this.render(),this.view.wt.draw(!0)}}),t.CustomBorders=e}(),function(t){function o(){function o(e){V=this,d=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){u=t;var o=d.getBoundingClientRect();h=o.top,f.style.top=h+"px",f.style.left=o.left+"px",V.rootElement.appendChild(f)}}function n(e,t){var o=e.getBoundingClientRect(),n=6;t>0?f.style.top=o.top+o.height-n+"px":f.style.top=o.top+"px"}function i(){var e=this;t.Dom.addClass(f,"active"),t.Dom.addClass(p,"active");var o=d.getBoundingClientRect();p.style.width=e.view.maximumVisibleElementWidth(0)+"px",p.style.height=o.height+"px",p.style.top=h+"px",p.style.left=f.style.left,e.rootElement.appendChild(p)}function r(e){p.style.top=h+e+"px"}function s(){t.Dom.removeClass(f,"active"),t.Dom.removeClass(p,"active")}var a,l,c,h,u,d,f=document.createElement("DIV"),p=document.createElement("DIV"),m=t.eventManager(this);f.className="manualRowMover",p.className="manualRowMoverGuide";var g=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualRowPositions",e.manualRowPositions)},v=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","manualRowPositions",o),o.value},w=function(e){return"BODY"!=e.tagName?"TBODY"==e.parentNode.tagName?!0:(e=e.parentNode,w(e)):!1},y=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:y(e.parentNode):null},C=function(){var h,f=this;m.addEventListener(f.rootElement,"mouseover",function(e){if(w(e.target)){var t=y(e.target);t&&(h?(l=f.view.wt.wtTable.getCoords(t).row,n(t,l-a)):o.call(f,t))}}),m.addEventListener(f.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualRowMover")&&(c=t.helper.pageY(e),i.call(f),h=f,a=u,l=u)}),m.addEventListener(e,"mousemove",function(e){h&&r(t.helper.pageY(e)-c)}),m.addEventListener(e,"mouseup",function(e){h&&(s(),h=!1,_(f.manualRowPositions,f.countRows()),f.manualRowPositions.splice(l,0,f.manualRowPositions.splice(a,1)[0]),f.forceFullRender=!0,f.view.render(),g.call(f),t.hooks.run(f,"afterRowMove",a,l),o.call(f,d))}),f.addHook("afterDestroy",b)},b=function(){m.clear()},_=function(e,t){if(e.length<t)for(var o=e.length;t>o;o++)e[o]=o};this.beforeInit=function(){this.manualRowPositions=[]},this.init=function(e){var t=this,o=!!t.getSettings().manualRowMove;if(o){var n=t.getSettings().manualRowMove,i=v.call(t);"undefined"!=typeof t.manualRowPositionsPluginUsages?t.manualRowPositionsPluginUsages.push("manualColumnMove"):t.manualRowPositionsPluginUsages=["manualColumnMove"],"undefined"!=typeof i?this.manualRowPositions=i:Array.isArray(n)?this.manualRowPositions=n:this.manualRowPositions=[],"afterInit"===e&&(C.call(this),this.manualRowPositions.length>0&&(t.forceFullRender=!0,t.render()))}else{var r=t.manualRowPositionsPluginUsages?t.manualRowPositionsPluginUsages.indexOf("manualColumnMove"):-1;r>-1&&(b.call(this),t.manualRowPositions=[],t.manualRowPositionsPluginUsages[r]=void 0)}},this.modifyRow=function(e){var t=this;return t.getSettings().manualRowMove?("undefined"==typeof t.manualRowPositions[e]&&_(this.manualRowPositions,e+1),t.manualRowPositions[e]):e}}var n=new o;t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyRow",n.modifyRow),t.hooks.register("afterRowMove")}(t),function(t){function o(o){this.instance=o,this.addingStarted=!1;var n,i,r=!1,s=this,a=t.eventManager(o),l=function(e){return o.autofill?void(o.autofill.handle&&o.autofill.handle.isDragged&&(o.autofill.handle.isDragged>1&&o.autofill.apply(),o.autofill.handle.isDragged=0,r=!1)):!0};a.addEventListener(document,"mouseup",function(e){l(e)}),a.addEventListener(document,"mousemove",function(o){if(!s.instance.autofill)return 0;var n=t.Dom.offset(s.instance.table).top-(e.pageYOffset||document.documentElement.scrollTop)+t.Dom.outerHeight(s.instance.table),i=t.Dom.offset(s.instance.table).left-(e.pageXOffset||document.documentElement.scrollLeft)+t.Dom.outerWidth(s.instance.table);s.addingStarted===!1&&s.instance.autofill.handle.isDragged>0&&o.clientY>n&&o.clientX<=i?(this.mouseDragOutside=!0,s.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&setTimeout(function(){s.addingStarted=!1,s.instance.alter("insert_row")},200)}),n=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown,this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(e){o.autofill.handle.isDragged=1,r=!0,n(e)},i=this.instance.view.wt.wtSettings.settings.onCellMouseOver,this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(e,t,n,s){o.autofill&&r&&!o.view.isMouseDown()&&o.autofill.handle&&o.autofill.handle.isDragged&&(o.autofill.handle.isDragged++,o.autofill.showBorder(t),o.autofill.checkIfNewRowNeeded()),i(e,t,n,s)},this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){o.autofill.selectAdjacent()}}o.prototype.init=function(){this.handle={}},o.prototype.disable=function(){this.handle.disabled=!0},o.prototype.selectAdjacent=function(){var e,t,o,n,i;e=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),t=this.instance.getData();e:for(o=e[2]+1;o<this.instance.countRows();o++){for(i=e[1];i<=e[3];i++)if(t[o][i])break e;(t[o][e[1]-1]||t[o][e[3]+1])&&(n=o)}n&&(this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(new u(e[0],e[1])),this.instance.view.wt.selections.fill.add(new u(n,e[3])),this.apply())},o.prototype.apply=function(){var e,o,n,i,r;if(this.handle.isDragged=0,e=this.instance.view.wt.selections.fill.getCorners()){var s=function(e,t,o,n){var i,r,s,a=o.length,l=o?o[0].length:0,c=[],h=t.row-e.row,u=t.col-e.col,d=[];if(-1!==["down","up"].indexOf(n)){for(var f=0;u>=f;f++)i=parseInt(o[0][f],10),r=parseInt(o[a-1][f],10),s=("down"===n?r-i:i-r)/(a-1)||0,d.push(s);c.push(d)}if(-1!==["right","left"].indexOf(n))for(var p=0;h>=p;p++)i=parseInt(o[p][0],10),r=parseInt(o[p][l-1],10),s=("right"===n?r-i:i-r)/(l-1)||0,d=[],d.push(s),c.push(d);return c};this.instance.view.wt.selections.fill.clear(),o=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners();var a;if(e[0]===o[0]&&e[1]<o[1]?(a="left",n=new u(e[0],e[1]),i=new u(e[2],o[1]-1)):e[0]===o[0]&&e[3]>o[3]?(a="right",n=new u(e[0],o[3]+1),i=new u(e[2],e[3])):e[0]<o[0]&&e[1]===o[1]?(a="up",n=new u(e[0],e[1]),i=new u(o[0]-1,e[3])):e[2]>o[2]&&e[1]===o[1]&&(a="down",n=new u(o[2]+1,e[1]),i=new u(e[2],e[3])),n&&n.row>-1&&n.col>-1){var l={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to};r=this.instance.getData(l.from.row,l.from.col,l.to.row,l.to.col);var c=s(n,i,r,a);t.hooks.run(this.instance,"beforeAutofill",n,i,r),this.instance.populateFromArray(n.row,n.col,r,i.row,i.col,"autofill",null,a,c),this.instance.selection.setRangeStart(new u(e[0],e[1])),this.instance.selection.setRangeEnd(new u(e[2],e[3]))}else this.instance.selection.refreshBorders()}},o.prototype.showBorder=function(e){var t=this.instance.getSelectedRange().getTopLeftCorner(),o=this.instance.getSelectedRange().getBottomRightCorner();if("horizontal"!==this.instance.getSettings().fillHandle&&(o.row<e.row||t.row>e.row))e=new u(e.row,o.col);else{if("vertical"===this.instance.getSettings().fillHandle)return;e=new u(o.row,e.col)}this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to),this.instance.view.wt.selections.fill.add(e),this.instance.view.render()},o.prototype.checkIfNewRowNeeded=function(){var e,t,o=this.instance.countRows(),n=this;this.instance.view.wt.selections.fill.cellRange&&this.addingStarted===!1&&(t=this.instance.getSelected(),e=this.instance.view.wt.selections.fill.getCorners(),t[2]<o-1&&e[2]===o-1&&(this.addingStarted=!0,this.instance._registerTimeout(setTimeout(function(){n.instance.alter("insert_row"),n.addingStarted=!1},200))))},t.hooks.add("afterInit",function(){var e=new o(this);"undefined"!=typeof this.getSettings().fillHandle&&(e.handle&&this.getSettings().fillHandle===!1?e.disable():e.handle||this.getSettings().fillHandle===!1||(this.autofill=e,this.autofill.init()))}),t.Autofill=o}(t);var te=function(e){var o=[],n={rows:0,cols:0},i={rows:0,cols:0},r=[],s=[],a={groupIndicatorContainer:"htGroupIndicatorContainer",groupIndicator:function(e){return"ht"+e+"Group"},groupStart:"htGroupStart",collapseButton:"htCollapseButton",expandButton:"htExpandButton",collapseGroupId:function(e){return"htCollapse-"+e},collapseFromLevel:function(e,t){return"htCollapse"+e+"FromLevel-"+t},clickable:"clickable",levelTrigger:"htGroupLevelTrigger"},l=function(e,t){return function(o,n){return"undefined"==typeof t||"asc"===t?o[e]-n[e]:n[e]-o[e]}},c=function(e,t){for(var o=[];t>=e;)o.push(e++);return o},h=function(e,t,o){var n=[],i={row:null,col:null};if("cols"==e)for(;o>=t;)i={row:-1,col:t++},n.push(i);else for(;o>=t;)i={row:t++,col:-1},n.push(i);for(var r=d(n),s=0,a=0,l=0;l<r.length;l++)s+=r[l].filter(function(e){return e.rows}).length,a+=r[l].filter(function(e){return e.cols}).length;return{total:{rows:s,cols:a},groups:r}},d=function(e){for(var t=[],o=0;o<e.length;o++)t.push(f(e[o]));return t},f=function(e,t,n){for(var i=e.row,r=e.col,s=-1===i?0:i,a=-1===r?0:r,l=[],c=0;c<o.length;c++){var h=o[c],u=h.id,d=(h.level,h.rows||[]),f=h.cols||[];-1===l.indexOf(u)&&(-1!==d.indexOf(s)||-1!==f.indexOf(a))&&l.push(h)}-1===r?l=l.concat(v()):-1===i&&(l=l.concat(y())),t&&(l=l.filter(function(e){return e.level===t})),n&&("cols"===n?l=l.filter(function(e){return e.cols}):"rows"===n&&(l=l.filter(function(e){return e.rows})));var p=[];return l.filter(function(e){return-1===p.indexOf(e.id)?(p.push(e.id),e):void 0})},p=function(e){for(var t=0,n=o.length;n>t;t++)if(o[t].id==e)return o[t];return!1},m=function(e,t){for(var n=0,i=o.length;i>n;n++)if(o[n].level==t&&o[n].rows&&o[n].rows.indexOf(e)>-1)return o[n];return!1},g=function(e,t){for(var n=0,i=o.length;i>n;n++)if(o[n].level==t&&o[n].cols&&o[n].cols.indexOf(e)>-1)return o[n];return!1},v=function(){for(var e=[],t=0,n=o.length;n>t;t++)Array.isArray(o[t].cols)&&e.push(o[t]);return e},w=function(e){for(var t=[],n=0,i=o.length;i>n;n++)o[n].cols&&o[n].level===e&&t.push(o[n]);return t},y=function(){for(var e=[],t=0,n=o.length;n>t;t++)Array.isArray(o[t].rows)&&e.push(o[t]);return e},C=function(e){for(var t=[],n=0,i=o.length;i>n;n++)o[n].rows&&o[n].level===e&&t.push(o[n]);return t},b=function(e){var t=0;return e.length&&e.forEach(function(e){if(e=e.filter(function(e){return e.cols}),e.length){var o=e.sort(l("level","desc")),n=o[0].level;n>t&&(t=n)}}),t},_=function(e){var t=0;return e.length&&e.forEach(function(e){if(e=e.filter(function(e){return e.rows}),e.length){var o=e.sort(l("level","desc")),n=o[0].level;n>t&&(t=n)}}),t},R=function(e,t){var r=h("cols",e,t),s=b(r.groups);s===i.cols?i.cols++:s>i.cols&&(i.cols=s+1),n.cols||(n.cols=v().length),n.cols++,o.push({id:"c"+n.cols,level:s+1,cols:c(e,t),hidden:0})},S=function(e,t){var r=h("rows",e,t),s=_(r.groups);i.rows=Math.max(i.rows,s+1),n.rows||(n.rows=y().length),n.rows++,o.push({id:"r"+n.rows,level:s+1,rows:c(e,t),hidden:0})},E=function(e,t){for(var o,n=0,i=t.length;i>n;n++)if(t[n].hidden=e,o=t[n].level,r[o]||(r[o]=[]),s[o]||(s[o]=[]),t[n].rows)for(var a=0,l=t[n].rows.length;l>a;a++)e>0?r[o][t[n].rows[a]]=!0:r[o][t[n].rows[a]]=void 0;else if(t[n].cols)for(var a=0,c=t[n].cols.length;c>a;a++)e>0?s[o][t[n].cols[a]]=!0:s[o][t[n].cols[a]]=void 0},T=function(e,o,n,i){var r,s;switch(e){case"rows":r=m(o+1,n).id,s=t.Grouping.getGroupLevelsByRows();break;case"cols":r=g(o+1,n).id,s=t.Grouping.getGroupLevelsByCols()}return!!(s[o+1]&&s[o+1].indexOf(n)>-1&&i==r)},k=function(e,o,n,i){var r,s;switch(e){case"rows":r=m(o-1,n).id,s=t.Grouping.getGroupLevelsByRows();break;case"cols":r=g(o-1,n).id,s=t.Grouping.getGroupLevelsByCols()}return!!(s[o-1]&&s[o-1].indexOf(n)>-1&&i==r)},x=function(o,n,a,l){if(0===n)return!1;var c,h,u=k(o,n,a,l),d=T(o,n,a,l),f=!1;switch(o){case"rows":c=t.Grouping.getGroupLevelsByRows(),h=e.countRows();for(var p=0;p<=i.rows;p++)if(r[p]&&r[p][n+1]){f=!0;break}break;case"cols":c=t.Grouping.getGroupLevelsByCols(),h=e.countCols();for(var p=0;p<=i.cols;p++)if(s[p]&&s[p][n+1]){f=!0;break}}if(u){if(n==h-1)return!0;if(!d||d&&f)return!0;if(!c[n+1])return!0}return!1},D=function(t){var o;switch(t){case"rows":o=i.rows;for(var n=0;o>=n;n++)if(r[n]&&r[n][e.countRows()-1])return!0;break;case"cols":o=i.cols;for(var n=0;o>=n;n++)if(s[n]&&s[n][e.countCols()-1])return!0}return!1},A=function(o,n,a,l){var c,h,u,d=p(l),f=!1,m=function(e){for(var t=!1,o="rows"==e?r:s,a=0;a<=i[e];a++){for(u=n;d[e].indexOf(u)>-1;)t=!(!o[a]||!o[a][u]),u--;if(t)break}return t},g=k(o,n,a,l),v=T(o,n,a,l);switch(o){case"rows":c=t.Grouping.getGroupLevelsByRows(),h=e.countRows(),f=m(o);break;case"cols":c=t.Grouping.getGroupLevelsByCols(),h=e.countCols(),f=m(o)}if(n==h-1)return!1;if(0===n){if(v)return!0}else if(!g||g&&f){if(v)return!0}else if(!c[n-1]&&v)return!0;return!1},O=function(e,o,n,i,r){var s;switch(e){case"rows":s=m(o-1,n).id;break;case"cols":s=g(o-1,n).id}if(!s)return null;if(o>0&&k(e,o-1,n,s)&&s!=i){var l=document.createElement("DIV");return t.Dom.addClass(l,a.expandButton),l.id="htExpand-"+s,l.appendChild(document.createTextNode("+")),l.setAttribute("data-level",n),l.setAttribute("data-type",e),l.setAttribute("data-hidden","1"),r.appendChild(l),l}return null},H=function(e){for(var t=y(),o=v(),n=0,i=t.length;i>n;n++)if(t[n].rows.indexOf(e.row)>-1&&t[n].hidden)return!0;if(null===e.col)return!1;for(var n=0,r=o.length;r>n;n++)if(o[n].cols.indexOf(e.col)>-1&&o[n].hidden)return!0;return!1};return{getGroups:function(){return o},getLevels:function(){return i},instance:e,baseSpareRows:e.getSettings().minSpareRows,baseSpareCols:e.getSettings().minSpareCols,getRowGroups:y,getColGroups:v,init:function(){var o=e.getSettings().groups;o&&Array.isArray(o)&&t.Grouping.initGroups(o)},initGroups:function(e){o=[],e.forEach(function(e){var t=[],o=!1,n=!1;Array.isArray(e.rows)?(t=e.rows,o=!0):Array.isArray(e.cols)&&(t=e.cols,n=!0);var i=t[0],r=t[t.length-1];o?S(i,r):n&&R(i,r)})},resetGroups:function(){o=[],n={rows:0,cols:0},i={rows:0,cols:0};var e;for(var r in a)if("function"!=typeof a[r]){e=document.querySelectorAll("."+a[r]);for(var s=0,l=e.length;l>s;s++)t.Dom.removeClass(e[s],a[r])}for(var c=["htGroupColClosest","htGroupCol"],r=0,h=c.length;h>r;r++){e=document.querySelectorAll("."+c[r]);for(var s=0,l=e.length;l>s;s++)t.Dom.removeClass(e[s],c[r])}},updateGroups:function(){var e=this.getSettings().groups;t.Grouping.resetGroups(),t.Grouping.initGroups(e)},afterGetRowHeader:function(e,o){for(var n=!1,i=0,s=r.length;s>i;i++)r[i]&&r[i][e]===!0&&(n=!0);n?t.Dom.addClass(o.parentNode,"hidden"):!n&&t.Dom.hasClass(o.parentNode,"hidden")&&t.Dom.removeClass(o.parentNode,"hidden")},afterGetColHeader:function(o,n){var i=this.view.wt.wtSettings.getSetting("rowHeaders").length,r=e.rootElement.querySelectorAll("colgroup col:nth-child("+parseInt(o+i+1,10)+")");if(0!==r.length){for(var a=!1,l=0,c=s.length;c>l;l++)s[l]&&s[l][o]===!0&&(a=!0);if(a)for(var l=0,h=r.length;h>l;l++)t.Dom.addClass(r[l],"hidden");else if(!a&&t.Dom.hasClass(r[0],"hidden"))for(var l=0,h=r.length;h>l;l++)t.Dom.removeClass(r[l],"hidden")}},groupIndicatorsFactory:function(e,o){var r,s,l,c,h,u,d,f;switch(o){case"horizontal":r=t.Grouping.getGroupLevelsByCols(),s=function(e){return Array.prototype.indexOf.call(e.parentNode.parentNode.childNodes,e.parentNode)+1},l=function(e,t){return g(e,t).id},c="cols",h=function(e,t){return g(e-1,t)},u="columnHeaders",d=function(e){if(1===e.length){var o=e[0];e[0]=function(e,n,i){-1>e?v()(e,n,i):(t.Dom.removeClass(n,a.groupIndicatorContainer),o(e,n,i))}}return function(){return e}},f=!0;break;case"vertical":r=t.Grouping.getGroupLevelsByRows(),s=function(e){return t.Dom.index(e)+1},l=function(e,t){return m(e,t).id},c="rows",h=function(e,t){return m(e-1,t)},u="rowHeaders",d=function(e){return e}}var p=function(e){var o=document.createElement("div");return e.appendChild(o),{button:o,addClass:function(e){t.Dom.addClass(o,e)}}},v=function(){var e=o.charAt(0).toUpperCase()+o.slice(1);return function(o,n,i){i++;for(var s,u;s=n.lastChild;)n.removeChild(s);t.Dom.addClass(n,a.groupIndicatorContainer);var d=l(o,i);if(o>-1&&r[o]&&r[o].indexOf(i)>-1&&(u=p(n),u.addClass(a.groupIndicator(e)),A(c,o,i,d)&&u.addClass(a.groupStart),x(c,o,i,d)&&(u.button.appendChild(document.createTextNode("-")),u.addClass(a.collapseButton),u.button.id=a.collapseGroupId(d),u.button.setAttribute("data-level",i),u.button.setAttribute("data-type",c))),f){var m=t.Dom.index(n.parentNode);if(-1===o||-1>o&&m===t.Grouping.getLevels().cols+1||0===m&&0===t.Grouping.getLevels().cols)if(u=p(n),u.addClass(a.levelTrigger),-1===o)u.button.id=a.collapseFromLevel("Cols",i),u.button.appendChild(document.createTextNode(i));else if(-1>o&&m===t.Grouping.getLevels().cols+1||0===m&&0===t.Grouping.getLevels().cols){var g=t.Dom.index(n)+1;u.button.id=a.collapseFromLevel("Rows",g),u.button.appendChild(document.createTextNode(g))}}var v=O(c,o,i,d,n);if(o>0){var w=h(o-1,i);v&&w.hidden&&t.Dom.addClass(v,a.clickable)}oe()}};if(e=d(e),n[c]>0)for(var w=0;w<i[c]+1;w++)Array.isArray(e)||(e="function"==typeof e?e():new Array(e)),e.unshift(v())},getGroupLevelsByRows:function(){for(var e=y(),t=[],o=0,n=e.length;n>o;o++)if(e[o].rows)for(var i=0,r=e[o].rows.length;r>i;i++)t[e[o].rows[i]]||(t[e[o].rows[i]]=[]),t[e[o].rows[i]].push(e[o].level);return t},getGroupLevelsByCols:function(){for(var e=v(),t=[],o=0,n=e.length;n>o;o++)if(e[o].cols)for(var i=0,r=e[o].cols.length;r>i;i++)t[e[o].cols[i]]||(t[e[o].cols[i]]=[]),t[e[o].cols[i]].push(e[o].level);return t},toggleGroupVisibility:function(o,n,r){if(t.Dom.hasClass(o.target,a.expandButton)||t.Dom.hasClass(o.target,a.collapseButton)||t.Dom.hasClass(o.target,a.levelTrigger)){var s,l,c,h,u=o.target,d=u.id.split("-"),f=[],m=function(e){e&&(u=e),d=u.id.split("-"),s=d[1],l=parseInt(u.getAttribute("data-level"),10),c=u.getAttribute("data-type"),h=parseInt(u.getAttribute("data-hidden")),h=isNaN(h)?1:h?0:1,u.setAttribute("data-hidden",h.toString()),f.push(p(s))};if(u.className.indexOf(a.levelTrigger)>-1){for(var g,v=[],y=[],b=u.id.indexOf("Rows")>-1?"rows":"cols",_=1,R=i[b];R>=_;_++)if(g="rows"==b?C(_):w(_),_>=parseInt(d[1],10))for(var S=0,T=g.length;T>S;S++)y.push(g[S]);else for(var S=0,T=g.length;T>S;S++)v.push(g[S]);E(!0,y),E(!1,v)}else m(),E(h,f);c=c||b;var k=D(c),x=c.charAt(0).toUpperCase()+c.slice(1),A=t.Grouping["baseSpare"+x];k?0==A&&(e.alter("insert_"+c.slice(0,-1),e["count"+x]()),t.Grouping["dummy"+c.slice(0,-1)]=!0):0==A&&t.Grouping["dummy"+c.slice(0,-1)]&&(e.alter("remove_"+c.slice(0,-1),e["count"+x]()-1),t.Grouping["dummy"+c.slice(0,-1)]=!1),e.render(),o.stopImmediatePropagation()}},modifySelectionFactory:function(e){var t,o=this.instance,n=new u(0,0),i=function(e,t){var o=0;switch(e){case"down":for(;H(t);)o++,t.row+=1;break;case"up":for(;H(t);)o--,t.row-=1;break;case"right":for(;H(t);)o++,t.col+=1;break;case"left":for(;H(t);)o--,t.col-=1}return o},r=function(e,t){e.row>0?H(t)&&(e.row+=i("down",t)):e.row<0&&H(t)&&(e.row+=i("up",t)),e.col>0?H(t)&&(e.col+=i("right",t)):e.col<0&&H(t)&&(e.col+=i("left",t))};switch(e){case"start":return function(e){t=o.getSelected(),n.row=t[0]+e.row,n.col=t[1]+e.col,r(e,n)};case"end":return function(e){t=o.getSelected(),n.row=t[2]+e.row,n.col=t[3]+e.col,r(e,n)}}},modifyRowHeight:function(t,o){return e.view.wt.wtTable.rowFilter&&H({row:o,col:null})?0:void 0},validateGroups:function(){for(var t=function(e,t){return e[0]<t[0]&&e[1]<t[1]&&t[0]<=e[1]||e[0]>t[0]&&t[1]<e[1]&&e[0]<=t[1]?!0:void 0},o=e.getSettings().groups,n=[],i=[],r=0,s=o.length;s>r;r++)if(o[r].rows){if(1===o[r].rows.length)throw new Error("Grouping error:  Group {"+o[r].rows[0]+"} is invalid. Cannot define single-entry groups.");if(0===o[r].rows.length)throw new Error("Grouping error:  Cannot define empty groups.");i.push(o[r].rows);for(var a=0,l=i.length;l>a;a++)if(t(o[r].rows,i[a]))throw new Error("Grouping error:  ranges {"+o[r].rows[0]+", "+o[r].rows[1]+"} and {"+i[a][0]+", "+i[a][1]+"} are overlapping.")}else if(o[r].cols){if(1===o[r].cols.length)throw new Error("Grouping error:  Group {"+o[r].cols[0]+"} is invalid. Cannot define single-entry groups.");if(0===o[r].cols.length)throw new Error("Grouping error:  Cannot define empty groups.");n.push(o[r].cols);for(var a=0,c=n.length;c>a;a++)if(t(o[r].cols,n[a]))throw new Error("Grouping error:  ranges {"+o[r].cols[0]+", "+o[r].cols[1]+"} and {"+n[a][0]+", "+n[a][1]+"} are overlapping.")}return!0},afterGetRowHeaderRenderers:function(e){t.Grouping.groupIndicatorsFactory(e,"vertical")},afterGetColumnHeaderRenderers:function(e){t.Grouping.groupIndicatorsFactory(e,"horizontal")},hookProxy:function(o,n){return function(){return e.getSettings().groups?n?t.Grouping[o](n).apply(this,arguments):t.Grouping[o].apply(this,arguments):void 0}}}},$=function(){var e=this,o=!!e.getSettings().groups;if(o){var n={};t.Grouping=new te(e),e.getSettings().rowHeaders||(n.rowHeaders=!0),e.getSettings().colHeaders||(n.colHeaders=!0),(n.colHeaders||n.rowHeaders)&&e.updateSettings(n);var i=t.Grouping.validateGroups();if(!i)return;e.addHook("beforeInit",t.Grouping.hookProxy("init")),e.addHook("afterUpdateSettings",t.Grouping.hookProxy("updateGroups")),e.addHook("afterGetColumnHeaderRenderers",t.Grouping.hookProxy("afterGetColumnHeaderRenderers")),e.addHook("afterGetRowHeaderRenderers",t.Grouping.hookProxy("afterGetRowHeaderRenderers")),e.addHook("afterGetRowHeader",t.Grouping.hookProxy("afterGetRowHeader")),e.addHook("afterGetColHeader",t.Grouping.hookProxy("afterGetColHeader")),e.addHook("beforeOnCellMouseDown",t.Grouping.hookProxy("toggleGroupVisibility")),e.addHook("modifyTransformStart",t.Grouping.hookProxy("modifySelectionFactory","start")),e.addHook("modifyTransformEnd",t.Grouping.hookProxy("modifySelectionFactory","end")),e.addHook("modifyRowHeight",t.Grouping.hookProxy("modifyRowHeight"))}},oe=function(){for(var e=document.querySelectorAll("colgroup"),o=0,n=e.length;n>o;o++){var i=e[o].querySelectorAll("col.rowHeader");if(0===i.length)return;for(var r=0,s=i.length+1;s>r;r++){if(2==s)return;r<t.Grouping.getLevels().rows+1&&(r==t.Grouping.getLevels().rows?t.Dom.addClass(i[r],"htGroupColClosest"):t.Dom.addClass(i[r],"htGroupCol"))}}};t.hooks.add("beforeInit",$),t.hooks.add("afterUpdateSettings",function(){this.getSettings().groups&&!t.Grouping?$.call(this,arguments):!this.getSettings().groups&&t.Grouping&&(t.Grouping.resetGroups(),t.Grouping=void 0)}),t.plugins.Grouping=te,function(e){function t(){this.zeroClipboardInstance=null,this.instance=null}t.prototype.prepareZeroClipboard=function(){this.swfPath&&ZeroClipboard.config({swfPath:this.swfPath})},t.prototype.copy=function(){return this.instance.copyPaste.setCopyableText(),this.instance.copyPaste.copyPasteInstance.elTextarea.value},t.prototype.addToContextMenu=function(t){this.getSettings().contextMenuCopyPaste&&t.items.unshift({key:"copy",name:"Copy"},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()}},e.ContextMenu.SEPARATOR)},t.prototype.setupZeroClipboard=function(t){var n=this;if(this.cmInstance=t,e.Dom.hasClass(this.cmInstance.rootElement,"htContextMenu"))for(var i=t.getData(),r=0,s=i.length;s>r;r++)if("copy"===i[r].key){this.zeroClipboardInstance=new ZeroClipboard(t.getCell(r,0)),this.zeroClipboardInstance.off(),this.zeroClipboardInstance.on("copy",function(e){var t=e.clipboardData;t.setData("text/plain",n.copy()),n.instance.getSettings().outsideClickDeselects=n.outsideClickDeselectsCache}),o.bindEvents();break}},t.prototype.bindEvents=function(){var t=this;if(t.cmInstance){var o=new e.eventManager(this.instance),n=function(o){var n=t.cmInstance.rootElement.querySelector("td.current");n&&e.Dom.removeClass(n,"current"),t.outsideClickDeselectsCache=t.instance.getSettings().outsideClickDeselects,t.instance.getSettings().outsideClickDeselects=!1},i=function(o){var n=t.cmInstance.rootElement.querySelector("td.zeroclipboard-is-hover");n&&e.Dom.removeClass(n,"zeroclipboard-is-hover"),t.instance.getSettings().outsideClickDeselects=t.outsideClickDeselectsCache};o.removeEventListener(document,"mouseenter",function(){n()}),o.addEventListener(document,"mouseenter",function(e){n()}),o.removeEventListener(document,"mouseleave",function(){i()}),o.addEventListener(document,"mouseleave",function(e){i()})}},t.prototype.init=function(){if(this.getSettings().contextMenuCopyPaste){if("object"==typeof this.getSettings().contextMenuCopyPaste&&(o.swfPath=this.getSettings().contextMenuCopyPaste.swfPath),"undefined"==typeof ZeroClipboard)throw new Error("To be able to use the Copy/Paste feature from the context menu, you need to manualy include ZeroClipboard.js file to your website.");try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){if("undefined"==typeof navigator.mimeTypes["application/x-shockwave-flash"])throw new Error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}o.instance=this,o.prepareZeroClipboard()}};var o=new t;e.hooks.add("afterRender",function(){o.setupZeroClipboard(this)}),e.hooks.add("afterInit",o.init),e.hooks.add("afterContextMenuDefaultOptions",o.addToContextMenu),e.ContextMenuCopyPaste=t}(t),function(e){function t(t){this.instance=t,this.dragged=[],this.eventManager=e.eventManager(t),this.bindTouchEvents()}t.prototype.getCurrentRangeCoords=function(e,t,o,n,i){var r=e.getTopLeftCorner(),s=e.getBottomRightCorner(),a=e.getBottomLeftCorner(),l=e.getTopRightCorner(),c={start:null,end:null};switch(o){case"NE-SW":switch(n){case"NE-SW":case"NW-SE":c="topLeft"==i?{start:new u(t.row,e.highlight.col),end:new u(a.row,t.col)}:{start:new u(e.highlight.row,t.col),end:new u(t.row,r.col)};break;case"SE-NW":"bottomRight"==i&&(c={start:new u(s.row,t.col),end:new u(t.row,r.col)})}break;case"NW-SE":switch(n){case"NE-SW":"topLeft"==i?c={start:t,end:a}:c.end=t;break;case"NW-SE":"topLeft"==i?c={start:t,end:s}:c.end=t;break;case"SE-NW":"topLeft"==i?c={start:t,end:r}:c.end=t;break;case"SW-NE":"topLeft"==i?c={start:t,end:l}:c.end=t}break;case"SW-NE":switch(n){case"NW-SE":c="bottomRight"==i?{start:new u(t.row,r.col),end:new u(a.row,t.col)}:{start:new u(r.row,t.col),end:new u(t.row,s.col)};break;case"SW-NE":c="topLeft"==i?{start:new u(e.highlight.row,t.col),end:new u(t.row,s.col)}:{start:new u(t.row,r.col),end:new u(r.row,t.col)};break;case"SE-NW":"bottomRight"==i?c={start:new u(t.row,l.col),end:new u(r.row,t.col)}:"topLeft"==i&&(c={start:a,end:t})}break;case"SE-NW":switch(n){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"==i&&(c.end=t);break;case"SE-NW":"topLeft"==i?c.end=t:c={start:t,end:r}}}return c},t.prototype.bindTouchEvents=function(){var t=this,o=function(e){if(1==this.dragged.length)return this.dragged=[],!0;var t=this.dragged.indexOf(e);return-1==t?!1:void(0===t?this.dragged=this.dragged.slice(0,1):1==t&&(this.dragged=this.dragged.slice(-1)))};this.eventManager.addEventListener(this.instance.rootElement,"touchstart",function(o){if(e.Dom.hasClass(o.target,"topLeftSelectionHandle-HitArea")){t.dragged.push("topLeft");var n=t.instance.getSelectedRange();return t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},o.preventDefault(),!1}if(e.Dom.hasClass(o.target,"bottomRightSelectionHandle-HitArea")){t.dragged.push("bottomRight");var n=t.instance.getSelectedRange();return t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},o.preventDefault(),!1}}),this.eventManager.addEventListener(this.instance.rootElement,"touchend",function(n){return e.Dom.hasClass(n.target,"topLeftSelectionHandle-HitArea")?(o.call(t,"topLeft"),t.touchStartRange=void 0,n.preventDefault(),!1):e.Dom.hasClass(n.target,"bottomRightSelectionHandle-HitArea")?(o.call(t,"bottomRight"),t.touchStartRange=void 0,n.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.instance.rootElement,"touchmove",function(o){var n=e.Dom.getWindowScrollTop(),i=e.Dom.getWindowScrollLeft();if(t.dragged.length>0){var r=document.elementFromPoint(o.touches[0].screenX-i,o.touches[0].screenY-n);if(!r)return;if("TD"==r.nodeName||"TH"==r.nodeName){var s=t.instance.getCoords(r);-1==s.col&&(s.col=0);var a=t.instance.getSelectedRange(),l=a.getWidth(),c=a.getHeight(),h=a.getDirection();1==l&&1==c&&t.instance.selection.setRangeEnd(s);var u=t.getCurrentRangeCoords(a,s,t.touchStartRange.direction,h,t.dragged[0]);null!=u.start&&t.instance.selection.setRangeStart(u.start),t.instance.selection.setRangeEnd(u.end)}o.preventDefault()}})},t.prototype.isDragged=function(){return 0===this.dragged.length?!1:!0};var o=function(){var o=this;e.plugins.multipleSelectionHandles=new t(o)};e.hooks.add("afterInit",o)}(t);var ne=function(e){function o(e){}return o.prototype.init=function(e){this.instance=e,this.bindEvents(),this.scrollbars=[this.instance.view.wt.wtScrollbars.vertical,this.instance.view.wt.wtScrollbars.horizontal,this.instance.view.wt.wtScrollbars.corner],this.clones=[this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.holder.parentNode,this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.holder.parentNode,this.instance.view.wt.wtScrollbars.corner.clone.wtTable.holder.parentNode]},o.prototype.bindEvents=function(){var e=this;this.instance.addHook("beforeTouchScroll",function(){t.freezeOverlays=!0;for(var o=0,n=e.clones.length;n>o;o++)t.Dom.addClass(e.clones[o],"hide-tween")}),this.instance.addHook("afterMomentumScroll",function(){t.freezeOverlays=!1;for(var o=0,n=e.clones.length;n>o;o++)t.Dom.removeClass(e.clones[o],"hide-tween");for(var o=0,n=e.clones.length;n>o;o++)t.Dom.addClass(e.clones[o],"show-tween");setTimeout(function(){for(var o=0,n=e.clones.length;n>o;o++)t.Dom.removeClass(e.clones[o],"show-tween")},400);for(var o=0,n=e.scrollbars.length;n>o;o++)e.scrollbars[o].refresh(),e.scrollbars[o].resetFixedPosition()})},o}(),ie=new ne;if(t.hooks.add("afterInit",function(){
ie.init.call(ie,this)}),function(e){function t(t){function o(o){o.items.push(e.ContextMenu.SEPARATOR,{key:"freeze_column",name:function(){var e=t.getSelected()[1];return e>p-1?"Freeze this column":"Unfreeze this column"},disabled:function(){var e=t.getSelected();return e[1]!==e[3]},callback:function(){var e=t.getSelected()[1];e>p-1?c(e):h(e)}})}function n(){t.updateSettings({fixedColumnsLeft:p+1}),p++}function i(){t.updateSettings({fixedColumnsLeft:p-1}),p--}function r(e){t.manualColumnPositions&&0!==t.manualColumnPositions.length||t.manualColumnPositions||(t.manualColumnPositions=[]),e?t.manualColumnPositions[e]||s(e+1):s(t.countCols())}function s(e){if(t.manualColumnPositions.length<e)for(var o=t.manualColumnPositions.length;e>o;o++)t.manualColumnPositions[o]=o}function a(e,o,n,i){null==n&&(n=e),"freeze"===i?t.manualColumnPositions.splice(p,0,t.manualColumnPositions.splice(o,1)[0]):"unfreeze"===i&&t.manualColumnPositions.splice(n,0,t.manualColumnPositions.splice(o,1)[0])}function l(e){for(var t=p,o=u(t),n=u(e);n>o;)t++,o=u(t);return t-1}function c(e){if(!(p-1>=e)){var t=u(e)||e;r(t),a(t,e,null,"freeze"),n()}}function h(e){if(!(e>p-1)){var t=l(e),o=u(e)||e;r(o),a(o,e,t,"unfreeze"),i()}}function u(e){return t.manualColumnPositions[e]}function d(e){return this.manualColumnPositionsPluginUsages.length>1?e:u(e)}function f(){t.addHook("modifyCol",d),t.addHook("afterContextMenuDefaultOptions",o)}var p=t.getSettings().fixedColumnsLeft,m=function(){"undefined"!=typeof t.manualColumnPositionsPluginUsages?t.manualColumnPositionsPluginUsages.push("manualColumnFreeze"):t.manualColumnPositionsPluginUsages=["manualColumnFreeze"],f()};return{init:m,freezeColumn:c,unfreezeColumn:h,helpers:{addFixedColumn:n,removeFixedColumn:i,checkPositionData:r,modifyColumnOrder:a,getBestColumnReturnPosition:l}}}var o=function(){if(this.getSettings().manualColumnFreeze){var o;e.plugins.manualColumnFreeze=t,this.manualColumnFreeze=new t(this),o=this.manualColumnFreeze,o.init.call(this)}};e.hooks.add("beforeInit",o)}(t),c.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE,this.fixed=this.instance.wtTable.hider,this.fixedContainer=this.instance.wtTable.holder,this.scrollHandler=this.getScrollableElement(this.TABLE)},c.prototype.makeClone=function(e){var t=document.createElement("DIV");t.className="ht_clone_"+e+" handsontable",t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.overflow="hidden";var o=document.createElement("TABLE");return o.className=this.instance.wtTable.TABLE.className,t.appendChild(o),this.instance.wtTable.holder.parentNode.appendChild(t),new m({cloneSource:this.instance,cloneOverlay:this,table:o})},c.prototype.getScrollableElement=function(t){for(var o=t.parentNode;o&&o.style;){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;if(this instanceof _&&"visible"!==o.style.overflowX&&""!==o.style.overflowX)return o;o=o.parentNode}return e},c.prototype.refresh=function(e){this.clone&&this.clone.draw(e)},c.prototype.destroy=function(){var e=t.eventManager(this.clone);e.clear()},h.prototype.appear=function(e){var o,n,i,r,s,a,l,c,h,d,f,p;if(!this.disabled){var m,g,v,w,y,C,_,S=this.instance,E=function(){return!this.instance.selections.area.cellRange||v==this.instance.selections.area.cellRange.to.row&&w==this.instance.selections.area.cellRange.to.col?!1:!0},T=function(e,t,o,n){var i=parseInt(this.selectionHandles.styles.topLeft.width,10),r=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(e-i,10)+"px",this.selectionHandles.styles.topLeft.left=parseInt(t-i,10)+"px",this.selectionHandles.styles.topLeftHitArea.top=parseInt(e-r/4*3,10)+"px",this.selectionHandles.styles.topLeftHitArea.left=parseInt(t-r/4*3,10)+"px",this.selectionHandles.styles.bottomRight.top=parseInt(e+n,10)+"px",this.selectionHandles.styles.bottomRight.left=parseInt(t+o,10)+"px",this.selectionHandles.styles.bottomRightHitArea.top=parseInt(e+n-r/4,10)+"px",this.selectionHandles.styles.bottomRightHitArea.left=parseInt(t+o-r/4,10)+"px",this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",E.call(this)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),m==this.instance.wtSettings.getSetting("fixedRowsTop")||g==this.instance.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")};for(C=S.cloneOverlay instanceof R||S.cloneOverlay instanceof b?S.getSetting("fixedRowsTop"):S.wtTable.getRenderedRowsCount(),y=0;C>y;y++)if(_=S.wtTable.rowFilter.renderedToSource(y),_>=e[0]&&_<=e[2]){m=_;break}for(y=C-1;y>=0;y--)if(_=S.wtTable.rowFilter.renderedToSource(y),_>=e[0]&&_<=e[2]){v=_;break}for(C=S.wtTable.getRenderedColumnsCount(),y=0;C>y;y++)if(_=S.wtTable.columnFilter.renderedToSource(y),_>=e[1]&&_<=e[3]){g=_;break}for(y=C-1;y>=0;y--)if(_=S.wtTable.columnFilter.renderedToSource(y),_>=e[1]&&_<=e[3]){w=_;break}if(void 0===m||void 0===g)return void this.disappear();o=m!==v||g!==w,n=S.wtTable.getCell(new u(m,g)),i=o?S.wtTable.getCell(new u(v,w)):n,r=t.Dom.offset(n),s=o?t.Dom.offset(i):r,a=t.Dom.offset(S.wtTable.TABLE),c=r.top,f=s.top+t.Dom.outerHeight(i)-c,d=r.left,p=s.left+t.Dom.outerWidth(i)-d,l=c-a.top-1,h=d-a.left-1;var k=t.Dom.getComputedStyle(n);parseInt(k.borderTopWidth,10)>0&&(l+=1,f=f>0?f-1:0),parseInt(k.borderLeftWidth,10)>0&&(h+=1,p=p>0?p-1:0),this.topStyle.top=l+"px",this.topStyle.left=h+"px",this.topStyle.width=p+"px",this.topStyle.display="block",this.leftStyle.top=l+"px",this.leftStyle.left=h+"px",this.leftStyle.height=f+"px",this.leftStyle.display="block";var x=Math.floor(this.settings.border.width/2);if(this.bottomStyle.top=l+f-x+"px",this.bottomStyle.left=h+"px",this.bottomStyle.width=p+"px",this.bottomStyle.display="block",this.rightStyle.top=l+"px",this.rightStyle.left=h+p-x+"px",this.rightStyle.height=f+1+"px",this.rightStyle.display="block",t.mobileBrowser||!this.hasSetting(this.settings.border.cornerVisible)||E.call(this))this.cornerStyle.display="none";else if(this.cornerStyle.top=l+f-4+"px",this.cornerStyle.left=h+p-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="block",!S.cloneOverlay&&w===S.wtTable.getRenderedColumnsCount()-1){var D=t.Dom.getScrollableElement(S.wtTable.TABLE),A=i.offsetLeft+t.Dom.outerWidth(i)>=t.Dom.innerWidth(D);A&&(this.cornerStyle.borderRightWidth="0px",this.cornerStyle.width=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2)+"px")}t.mobileBrowser&&T.call(this,l,h,p,f)}},h.prototype.disappear=function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",t.mobileBrowser&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")},h.prototype.hasSetting=function(e){return"function"==typeof e?e():!!e},u.prototype.isValid=function(e){return this.row<0||this.col<0?!1:this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns")?!1:!0},u.prototype.isEqual=function(e){return e===this?!0:this.row===e.row&&this.col===e.col},u.prototype.isSouthEastOf=function(e){return this.row>=e.row&&this.col>=e.col},u.prototype.isNorthWestOf=function(e){return this.row<=e.row&&this.col<=e.col},u.prototype.isSouthWestOf=function(e){return this.row>=e.row&&this.col<=e.col},u.prototype.isNorthEastOf=function(e){return this.row<=e.row&&this.col>=e.col},e.WalkontableCellCoords=u,d.prototype.isValid=function(e){return this.from.isValid(e)&&this.to.isValid(e)},d.prototype.isSingle=function(){return this.from.row===this.to.row&&this.from.col===this.to.col},d.prototype.getHeight=function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},d.prototype.getWidth=function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},d.prototype.includes=function(e){var t=this.getTopLeftCorner(),o=this.getBottomRightCorner();return e.row<0&&(e.row=0),e.col<0&&(e.col=0),t.row<=e.row&&o.row>=e.row&&t.col<=e.col&&o.col>=e.col},d.prototype.includesRange=function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())},d.prototype.isEqual=function(e){return Math.min(this.from.row,this.to.row)==Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(e.from.col,e.to.col)},d.prototype.overlaps=function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())},d.prototype.isSouthEastOf=function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)},d.prototype.isNorthWestOf=function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)},d.prototype.expand=function(e){var t=this.getTopLeftCorner(),o=this.getBottomRightCorner();return e.row<t.row||e.col<t.col||e.row>o.row||e.col>o.col?(this.from=new u(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new u(Math.max(o.row,e.row),Math.max(o.col,e.col)),!0):!1},d.prototype.expandByRange=function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getTopLeftCorner(),o=this.getBottomRightCorner(),n=(this.getTopRightCorner(),this.getBottomLeftCorner(),e.getTopLeftCorner()),i=e.getBottomRightCorner(),r=Math.min(t.row,n.row),s=Math.min(t.col,n.col),a=Math.max(o.row,i.row),l=Math.max(o.col,i.col),c=new u(r,s),h=new u(a,l),f=new d(c,c,h).isCorner(this.from,e),p=e.isEqual(new d(c,c,h));return f&&!p&&(this.from.col>c.col&&(c.col=l,h.col=s),this.from.row>c.row&&(c.row=a,h.row=r)),this.from=c,this.to=h,!0},d.prototype.getDirection=function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0},d.prototype.setDirection=function(e){switch(e){case"NW-SE":this.from=this.getTopLeftCorner(),this.to=this.getBottomRightCorner();break;case"NE-SW":this.from=this.getTopRightCorner(),this.to=this.getBottomLeftCorner();break;case"SE-NW":this.from=this.getBottomRightCorner(),this.to=this.getTopLeftCorner();break;case"SW-NE":this.from=this.getBottomLeftCorner(),this.to=this.getTopRightCorner()}},d.prototype.getTopLeftCorner=function(){return new u(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},d.prototype.getBottomRightCorner=function(){return new u(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},d.prototype.getTopRightCorner=function(){return new u(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},d.prototype.getBottomLeftCorner=function(){return new u(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},d.prototype.isCorner=function(e,t){return t&&t.includes(e)&&(this.getTopLeftCorner().isEqual(new u(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new u(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new u(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new u(t.to.row,t.to.col)))?!0:e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner())},d.prototype.getOppositeCorner=function(e,t){if(!(e instanceof u))return!1;if(t&&t.includes(e)){if(this.getTopLeftCorner().isEqual(new u(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new u(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new u(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new u(t.to.row,t.to.col)))return this.getTopLeftCorner()}return e.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():e.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():e.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():e.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0},d.prototype.getBordersSharedWith=function(e){if(!this.includesRange(e))return[];var t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},n=[];return t.top==o.top&&n.push("top"),t.right==o.right&&n.push("right"),t.bottom==o.bottom&&n.push("bottom"),t.left==o.left&&n.push("left"),n},d.prototype.getInner=function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),o=[],n=e.row;n<=t.row;n++)for(var i=e.col;i<=t.col;i++)this.from.row===n&&this.from.col===i||this.to.row===n&&this.to.col===i||o.push(new u(n,i));return o},d.prototype.getAll=function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),o=[],n=e.row;n<=t.row;n++)for(var i=e.col;i<=t.col;i++)e.row===n&&e.col===i?o.push(e):t.row===n&&t.col===i?o.push(t):o.push(new u(n,i));return o},d.prototype.forAll=function(e){for(var t=this.getTopLeftCorner(),o=this.getBottomRightCorner(),n=t.row;n<=o.row;n++)for(var i=t.col;i<=o.col;i++){var r=e(n,i);if(r===!1)return}},e.WalkontableCellRange=d,f.prototype.offsetted=function(e){return e+this.offset},f.prototype.unOffsetted=function(e){return e-this.offset},f.prototype.renderedToSource=function(e){return this.offsetted(e)},f.prototype.sourceToRendered=function(e){return this.unOffsetted(e)},f.prototype.offsettedTH=function(e){return e-this.countTH},f.prototype.unOffsettedTH=function(e){return e+this.countTH},f.prototype.visibleRowHeadedColumnToSourceColumn=function(e){return this.renderedToSource(this.offsettedTH(e))},f.prototype.sourceColumnToVisibleRowHeadedColumn=function(e){return this.unOffsettedTH(this.sourceToRendered(e))},p.prototype.getContainerSize=function(){return"function"==typeof this.containerSizeFn?this.containerSizeFn():this.containerSizeFn},p.prototype.getSize=function(e){return this.cellSizes[e]+(this.cellStretch[e]||0)},p.prototype.stretch=function(){var e=this.getContainerSize(),t=0;if(this.remainingSize=this.cellSizesSum-e,this.cellStretch.length=0,"all"===this.strategy){if(this.remainingSize<0){for(var o,n=e/this.cellSizesSum;t<this.cellCount-1;)o=Math.floor(n*this.cellSizes[t]),this.remainingSize+=o-this.cellSizes[t],this.cellStretch[t]=o-this.cellSizes[t],t++;this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0}}else"last"===this.strategy&&this.remainingSize<0&&e!==1/0&&(this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0)},p.prototype.countVisible=function(){return this.visibleCellCount},p.prototype.isLastIncomplete=function(){var e=this.instance.wtTable.getFirstVisibleRow(),o=this.instance.wtTable.getLastVisibleColumn(),n=this.instance.wtTable.getCell(new u(e,o)),i=t.Dom.offset(n),r=t.Dom.outerWidth(n),s=i.left+r,a=this.instance.wtScrollbars.vertical.getScrollPosition(),l=this.instance.wtViewport.getViewportWidth(),c=a+l;return c>=s},m.prototype.draw=function(e){return this.drawInterrupted=!1,e||t.Dom.isVisible(this.wtTable.TABLE)?(this.wtTable.draw(e),this):void(this.drawInterrupted=!0)},m.prototype.getCell=function(e,t){if(t){var o=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedColumnsLeft");return e.row<o&&e.col<n?this.wtScrollbars.corner.clone.wtTable.getCell(e):e.row<o?this.wtScrollbars.vertical.clone.wtTable.getCell(e):e.col<n?this.wtScrollbars.horizontal.clone.wtTable.getCell(e):this.wtTable.getCell(e)}return this.wtTable.getCell(e)},m.prototype.update=function(e,t){return this.wtSettings.update(e,t)},m.prototype.scrollVertical=function(e){return this.wtScrollbars.vertical.scrollTo(e),this.getSetting("onScrollVertically"),this},m.prototype.scrollHorizontal=function(e){return this.wtScrollbars.horizontal.scrollTo(e),this.getSetting("onScrollHorizontally"),this},m.prototype.scrollViewport=function(e){return this.wtScroll.scrollViewport(e),this},m.prototype.getViewport=function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},m.prototype.getSetting=function(e,t,o,n,i){return this.wtSettings.getSetting(e,t,o,n,i)},m.prototype.hasSetting=function(e){return this.wtSettings.has(e)},m.prototype.destroy=function(){this.wtScrollbars.destroy(),this.wtEvent&&this.wtEvent.destroy()},g.prototype=new c,g.prototype.destroy=function(){c.prototype.destroy.call(this),clearTimeout(this.lastTimeout)},v.prototype.parentCell=function(e){var o={},n=this.instance.wtTable.TABLE,i=t.Dom.closest(e,["TD","TH"],n);return i&&t.Dom.isChildOf(i,n)?(o.coords=this.instance.wtTable.getCoords(i),o.TD=i):t.Dom.hasClass(e,"wtBorder")&&t.Dom.hasClass(e,"current")?(o.coords=this.instance.selections.current.cellRange.highlight,o.TD=this.instance.wtTable.getCell(o.coords)):t.Dom.hasClass(e,"wtBorder")&&t.Dom.hasClass(e,"area")&&this.instance.selections.area.cellRange&&(o.coords=this.instance.selections.area.cellRange.to,o.TD=this.instance.wtTable.getCell(o.coords)),o},e.requestAnimFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t,o){return e.setTimeout(t,1e3/60)}}(),e.cancelRequestAnimFrame=function(){return e.cancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout}(),e.getComputedStyle||!function(){var t,o={getPropertyValue:function(e){return"float"==e&&(e="styleFloat"),t.currentStyle[e.toUpperCase()]||null}};e.getComputedStyle=function(e){return t=e,o}}(),!String.prototype.trim){var re=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(re,"")}}y.prototype.offsetted=function(e){return e+this.offset},y.prototype.unOffsetted=function(e){return e-this.offset},y.prototype.renderedToSource=function(e){return this.offsetted(e)},y.prototype.sourceToRendered=function(e){return this.unOffsetted(e)},y.prototype.offsettedTH=function(e){return e-this.countTH},y.prototype.visibleColHeadedRowToSourceRow=function(e){return this.renderedToSource(this.offsettedTH(e))},y.prototype.sourceRowToVisibleColHeadedRow=function(e){return this.unOffsettedTH(this.sourceToRendered(e))},C.prototype.scrollViewport=function(e){if(this.instance.drawn){var t=this.instance.getSetting("totalRows"),o=this.instance.getSetting("totalColumns");if(e.row<0||e.row>t-1)throw new Error("row "+e.row+" does not exist");if(e.col<0||e.col>o-1)throw new Error("column "+e.col+" does not exist");e.row>this.instance.wtTable.getLastVisibleRow()?this.instance.wtScrollbars.vertical.scrollTo(e.row,!0):e.row>=this.instance.getSetting("fixedRowsTop")&&e.row<this.instance.wtTable.getFirstVisibleRow()&&this.instance.wtScrollbars.vertical.scrollTo(e.row),e.col>this.instance.wtTable.getLastVisibleColumn()?this.instance.wtScrollbars.horizontal.scrollTo(e.col,!0):e.col>this.instance.getSetting("fixedColumnsLeft")&&e.col<this.instance.wtTable.getFirstVisibleColumn()&&this.instance.wtScrollbars.horizontal.scrollTo(e.col)}},b.prototype=new c,b.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var o,n,i=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){var r=this.instance.wtTable.holder.getBoundingClientRect(),s=Math.ceil(r.top),a=Math.ceil(r.left),l=Math.ceil(r.bottom),c=Math.ceil(r.right);o=0>a&&c-i.offsetWidth>0?-a+"px":"0",n=0>s&&l-i.offsetHeight>0?-s+"px":"0"}else t.freezeOverlays||(o=this.instance.wtScrollbars.horizontal.getScrollPosition()+"px",n=this.instance.wtScrollbars.vertical.getScrollPosition()+"px");t.Dom.setOverlayPosition(i,o,n),i.style.width=t.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px",i.style.height=t.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},_.prototype=new c,_.prototype.resetFixedPosition=function(){var o,n;if(this.instance.wtTable.holder.parentNode){var i=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){var r=this.instance.wtTable.holder.getBoundingClientRect(),s=Math.ceil(r.left),a=Math.ceil(r.right);o=0>s&&a-i.offsetWidth>0?-s+"px":"0",n=this.instance.wtTable.hider.style.top}else t.freezeOverlays||(o=this.getScrollPosition()+"px",n=this.instance.wtTable.hider.style.top);t.Dom.setOverlayPosition(i,o,n),i.style.height=t.Dom.outerHeight(this.clone.wtTable.TABLE)+"px",i.style.width=t.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px"}},_.prototype.refresh=function(e){this.applyToDOM(),c.prototype.refresh.call(this,e)},_.prototype.getScrollPosition=function(){return t.Dom.getScrollLeft(this.scrollHandler)},_.prototype.setScrollPosition=function(o){this.scrollHandler===e?e.scrollTo(o,t.Dom.getWindowScrollTop()):this.scrollHandler.scrollLeft=o},_.prototype.onScroll=function(){this.instance.getSetting("onScrollHorizontally")},_.prototype.sumCellSizes=function(e,t){for(var o=0;t>e;)o+=this.instance.wtTable.getStretchedColumnWidth(e)||this.instance.wtSettings.defaultColumnWidth,e++;return o},_.prototype.applyToDOM=function(){var e=this.instance.getSetting("totalColumns"),t=this.instance.wtViewport.getRowHeaderWidth();if(this.fixedContainer.style.width=t+this.sumCellSizes(0,e)+"px","number"==typeof this.instance.wtViewport.columnsRenderCalculator.startPosition)this.fixed.style.left=this.instance.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.fixed.style.left="0"}this.fixed.style.right=""},_.prototype.scrollTo=function(e,t){var o=this.getTableParentOffset();if(t)o+=this.sumCellSizes(0,e+1),o-=this.instance.wtViewport.getViewportWidth();else{var n=this.instance.getSetting("fixedColumnsLeft");o+=this.sumCellSizes(n,e)}this.setScrollPosition(o)},_.prototype.getTableParentOffset=function(){return this.scrollHandler===e?this.instance.wtTable.holderOffset.left:0},R.prototype=new c,R.prototype.resetFixedPosition=function(){var o,n;if(this.instance.wtTable.holder.parentNode){var i=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){var r=this.instance.wtTable.holder.getBoundingClientRect(),s=Math.ceil(r.top),a=Math.ceil(r.bottom);o=this.instance.wtTable.hider.style.left,n=0>s&&a-i.offsetHeight>0?-s+"px":"0"}else t.freezeOverlays||(n=this.getScrollPosition()+"px",o=this.instance.wtTable.hider.style.left);t.Dom.setOverlayPosition(i,o,n),this.instance.wtScrollbars.horizontal.scrollHandler===e?i.style.width=this.instance.wtViewport.getWorkspaceActualWidth()+"px":i.style.width=t.Dom.outerWidth(this.clone.wtTable.TABLE)+"px",i.style.height=t.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},R.prototype.getScrollPosition=function(){return t.Dom.getScrollTop(this.scrollHandler)},R.prototype.setScrollPosition=function(o){this.scrollHandler===e?e.scrollTo(t.Dom.getWindowScrollLeft(),o):this.scrollHandler.scrollTop=o},R.prototype.onScroll=function(){this.instance.getSetting("onScrollVertically")},R.prototype.sumCellSizes=function(e,t){for(var o=0;t>e;)o+=this.instance.wtTable.getRowHeight(e)||this.instance.wtSettings.settings.defaultRowHeight,e++;return o},R.prototype.refresh=function(e){this.applyToDOM(),c.prototype.refresh.call(this,e)},R.prototype.applyToDOM=function(){var e=this.instance.getSetting("totalRows"),t=this.instance.wtViewport.getColumnHeaderHeight();if(this.fixedContainer.style.height=t+this.sumCellSizes(0,e)+"px","number"==typeof this.instance.wtViewport.rowsRenderCalculator.startPosition)this.fixed.style.top=this.instance.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.fixed.style.top="0"}this.fixed.style.bottom=""},R.prototype.scrollTo=function(e,t){var o=this.getTableParentOffset();if(t)o+=this.sumCellSizes(0,e+1),o-=this.instance.wtViewport.getViewportHeight(),o+=1;else{var n=this.instance.getSetting("fixedRowsTop");o+=this.sumCellSizes(n,e)}this.setScrollPosition(o)},R.prototype.getTableParentOffset=function(){return this.scrollHandler===e?this.instance.wtTable.holderOffset.top:0},S.prototype.registerListeners=function(){var o=this;this.refreshAll=function(){if(o.instance.drawn){if(!o.instance.wtTable.holder.parentNode)return void o.destroy();o.instance.draw(!0),o.vertical.onScroll(),o.horizontal.onScroll()}};var n=t.eventManager(o.instance);n.addEventListener(this.vertical.scrollHandler,"scroll",this.refreshAll),this.vertical.scrollHandler!==this.horizontal.scrollHandler&&n.addEventListener(this.horizontal.scrollHandler,"scroll",this.refreshAll),this.vertical.scrollHandler!==e&&this.horizontal.scrollHandler!==e&&n.addEventListener(e,"scroll",this.refreshAll)},S.prototype.destroy=function(){var o=t.eventManager(this.instance);this.vertical&&(this.vertical.destroy(),o.removeEventListener(this.vertical.scrollHandler,"scroll",this.refreshAll)),this.horizontal&&(this.horizontal.destroy(),o.removeEventListener(this.horizontal.scrollHandler,"scroll",this.refreshAll)),o.removeEventListener(e,"scroll",this.refreshAll),this.corner&&this.corner.destroy(),this.debug&&this.debug.destroy()},S.prototype.refresh=function(e){this.horizontal&&this.horizontal.refresh(e),this.vertical&&this.vertical.refresh(e),this.corner&&this.corner.refresh(e),this.debug&&this.debug.refresh(e)},S.prototype.applyToDOM=function(){this.horizontal&&this.horizontal.applyToDOM(),this.vertical&&this.vertical.applyToDOM()},E.prototype.getBorder=function(e){return this.instanceBorders[e.guid]?this.instanceBorders[e.guid]:void(this.instanceBorders[e.guid]=new h(e,this.settings))},E.prototype.isEmpty=function(){return null===this.cellRange},E.prototype.add=function(e){this.isEmpty()?this.cellRange=new d(e,e,e):this.cellRange.expand(e)},E.prototype.replace=function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1},E.prototype.clear=function(){this.cellRange=null},E.prototype.getCorners=function(){var e=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[e.row,e.col,t.row,t.col]},E.prototype.addClassAtCoords=function(e,o,n,i){var r=e.wtTable.getCell(new u(o,n));"object"==typeof r&&t.Dom.addClass(r,i)},E.prototype.draw=function(e){var o,n,i,r,s,a=this,l=e.wtTable.getRenderedRowsCount(),c=e.wtTable.getRenderedColumnsCount();if(this.isEmpty())return void(this.settings.border&&(r=this.getBorder(e),r&&r.disappear()));o=this.getCorners();for(var h=0;c>h;h++)i=e.wtTable.columnFilter.renderedToSource(h),i>=o[1]&&i<=o[3]&&(s=e.wtTable.getColumnHeader(i),s&&a.settings.highlightColumnClassName&&t.Dom.addClass(s,a.settings.highlightColumnClassName));for(var u=0;l>u;u++){n=e.wtTable.rowFilter.renderedToSource(u),n>=o[0]&&n<=o[2]&&(s=e.wtTable.getRowHeader(n),s&&a.settings.highlightRowClassName&&t.Dom.addClass(s,a.settings.highlightRowClassName));for(var h=0;c>h;h++)i=e.wtTable.columnFilter.renderedToSource(h),n>=o[0]&&n<=o[2]&&i>=o[1]&&i<=o[3]?a.settings.className&&a.addClassAtCoords(e,n,i,a.settings.className):n>=o[0]&&n<=o[2]?a.settings.highlightRowClassName&&a.addClassAtCoords(e,n,i,a.settings.highlightRowClassName):i>=o[1]&&i<=o[3]&&a.settings.highlightColumnClassName&&a.addClassAtCoords(e,n,i,a.settings.highlightColumnClassName)}e.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&(r=this.getBorder(e),r&&r.appear(o))},T.prototype.update=function(e,t){if(void 0===t)for(var o in e)e.hasOwnProperty(o)&&(this.settings[o]=e[o]);else this.settings[e]=t;return this.instance},T.prototype.getSetting=function(e,t,o,n,i){return"function"==typeof this.settings[e]?this.settings[e](t,o,n,i):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]},T.prototype.has=function(e){return!!this.settings[e]},k.prototype.isWorkingOnClone=function(){return!!this.instance.cloneSource},k.prototype.draw=function(e){if(this.isWorkingOnClone()||(this.holderOffset=t.Dom.offset(this.holder),e=this.instance.wtViewport.createRenderCalculators(e)),e)this.isWorkingOnClone()||this.instance.wtViewport.createVisibleCalculators(),this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!0);else{this.isWorkingOnClone()?this.tableOffset=this.instance.cloneSource.wtTable.tableOffset:this.tableOffset=t.Dom.offset(this.TABLE);var o;o=this.instance.cloneOverlay instanceof g||this.instance.cloneOverlay instanceof R||this.instance.cloneOverlay instanceof b?0:this.instance.wtViewport.rowsRenderCalculator.startRow;var n;n=this.instance.cloneOverlay instanceof g||this.instance.cloneOverlay instanceof _||this.instance.cloneOverlay instanceof b?0:this.instance.wtViewport.columnsRenderCalculator.startColumn,this.rowFilter=new y(o,this.instance.getSetting("totalRows"),this.instance.getSetting("columnHeaders").length),this.columnFilter=new f(n,this.instance.getSetting("totalColumns"),this.instance.getSetting("rowHeaders").length),this._doDraw()}return this.refreshSelections(e),this.isWorkingOnClone()||(this.instance.wtScrollbars.vertical.resetFixedPosition(),this.instance.wtScrollbars.horizontal.resetFixedPosition(),this.instance.wtScrollbars.corner.resetFixedPosition()),this.instance.drawn=!0,this},k.prototype._doDraw=function(){var e=new x(this);e.render()},k.prototype.removeClassFromCells=function(e){for(var o=this.TABLE.querySelectorAll("."+e),n=0,i=o.length;i>n;n++)t.Dom.removeClass(o[n],e)},k.prototype.refreshSelections=function(e){var t,o;if(this.instance.selections){if(o=this.instance.selections.length,e)for(t=0;o>t;t++)this.instance.selections[t].settings.className&&this.removeClassFromCells(this.instance.selections[t].settings.className),this.instance.selections[t].settings.highlightRowClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightRowClassName),this.instance.selections[t].settings.highlightColumnClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightColumnClassName);for(t=0;o>t;t++)this.instance.selections[t].draw(this.instance,e)}},k.prototype.getCell=function(e){if(this.isRowBeforeRenderedRows(e.row))return-1;if(this.isRowAfterRenderedRows(e.row))return-2;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e.row)];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e.col)]:void 0},k.prototype.getColumnHeader=function(e,t){t||(t=0);var o=this.THEAD.childNodes[t];return o?o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]:void 0},k.prototype.getRowHeader=function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return t?t.childNodes[0]:void 0},k.prototype.getCoords=function(e){var o=e.parentNode,n=t.Dom.index(o);return n=o.parentNode===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(n):this.rowFilter.renderedToSource(n),new u(n,this.columnFilter.visibleRowHeadedColumnToSourceColumn(e.cellIndex))},k.prototype.getTrForRow=function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]},k.prototype.getFirstRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.startRow},k.prototype.getFirstVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.startRow},k.prototype.getFirstRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.startColumn},k.prototype.getFirstVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.startColumn},k.prototype.getLastRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.endRow},k.prototype.getLastVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.endRow},k.prototype.getLastRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.endColumn},k.prototype.getLastVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.endColumn;
},k.prototype.isRowBeforeRenderedRows=function(e){return this.rowFilter.sourceToRendered(e)<0&&e>=0},k.prototype.isRowAfterViewport=function(e){return e>this.getLastVisibleRow()},k.prototype.isRowAfterRenderedRows=function(e){return e>this.getLastRenderedRow()},k.prototype.isColumnBeforeViewport=function(e){return this.columnFilter.sourceToRendered(e)<0&&e>=0},k.prototype.isColumnAfterViewport=function(e){return e>this.getLastVisibleColumn()},k.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.getLastRenderedRow()},k.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn},k.prototype.getRenderedColumnsCount=function(){return this.instance.cloneOverlay instanceof g?this.instance.getSetting("totalColumns"):this.instance.cloneOverlay instanceof _||this.instance.cloneOverlay instanceof b?this.instance.getSetting("fixedColumnsLeft"):this.instance.wtViewport.columnsRenderCalculator.count},k.prototype.getRenderedRowsCount=function(){return this.instance.cloneOverlay instanceof g?this.instance.getSetting("totalRows"):this.instance.cloneOverlay instanceof R||this.instance.cloneOverlay instanceof b?this.instance.getSetting("fixedRowsTop"):this.instance.wtViewport.rowsRenderCalculator.count},k.prototype.getVisibleRowsCount=function(){return this.instance.wtViewport.rowsVisibleCalculator.count},k.prototype.allRowsInViewport=function(){return this.instance.getSetting("totalRows")==this.getVisibleRowsCount()},k.prototype.getRowHeight=function(e){var t=this.instance.wtSettings.settings.rowHeight(e),o=this.instance.wtViewport.oversizedRows[e];return void 0!==o&&(t=t?Math.max(t,o):o),t},k.prototype.getColumnHeaderHeight=function(e){var t=this.instance.wtSettings.settings.defaultRowHeight,o=this.instance.wtViewport.oversizedColumnHeaders[e];return void 0!==o&&(t=t?Math.max(t,o):o),t},k.prototype.getVisibleColumnsCount=function(){return this.instance.wtViewport.columnsVisibleCalculator.count},k.prototype.allColumnsInViewport=function(){return this.instance.getSetting("totalColumns")==this.getVisibleColumnsCount()},k.prototype.getColumnWidth=function(e){var t=this.instance.wtSettings.settings.columnWidth;"function"==typeof t?t=t(e):"object"==typeof t&&(t=t[e]);var o=this.instance.wtViewport.oversizedCols[e];return void 0!==o&&(t=t?Math.max(t,o):o),t},k.prototype.getStretchedColumnWidth=function(e){var t,o=this.getColumnWidth(e)||this.instance.wtSettings.settings.defaultColumnWidth,n=this.instance.wtViewport.columnsRenderCalculator;return n&&(t=n.getStretchedColumnWidth(e,o),t&&(o=t)),o},x.prototype.render=function(){this.wtTable.isWorkingOnClone()||this.instance.getSetting("beforeDraw",!0),this.rowHeaders=this.instance.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.instance.getSetting("fixedRowsTop"),this.columnHeaders=this.instance.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var e,t,o=this.instance.getSetting("totalRows"),n=this.instance.getSetting("totalColumns"),i=!1,r=this.wtTable.getRenderedRowsCount();if(n>0&&(this.adjustAvailableNodes(),i=!0,this.renderColGroups(),this.renderColumnHeaders(),e=this.wtTable.getRenderedColumnsCount(),this.renderRows(o,r,e),this.wtTable.isWorkingOnClone()?this.adjustColumnHeaderHeights():(t=this.instance.wtViewport.getWorkspaceWidth(),this.instance.wtViewport.containerWidth=null),this.adjustColumnWidths(e)),i||this.adjustAvailableNodes(),this.removeRedundantRows(r),!this.wtTable.isWorkingOnClone()){if(this.markOversizedRows(),this.instance.wtViewport.createVisibleCalculators(),this.instance.wtScrollbars.applyToDOM(),t!==this.instance.wtViewport.getWorkspaceWidth()){this.instance.wtViewport.containerWidth=null;for(var s=this.wtTable.getFirstRenderedColumn(),a=this.wtTable.getLastRenderedColumn(),l=s;a>l;l++){var c=this.wtTable.getStretchedColumnWidth(l),h=this.columnFilter.sourceToRendered(l);this.COLGROUP.childNodes[h+this.rowHeaderCount].style.width=c+"px"}}this.instance.wtScrollbars.refresh(!1),this.instance.getSetting("onDraw",!0)}},x.prototype.removeRedundantRows=function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},x.prototype.renderRows=function(e,t,o){for(var n,i,r=0,s=this.rowFilter.renderedToSource(r),a=this.wtTable.isWorkingOnClone();e>s&&s>=0;){if(r>1e3)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(void 0!==t&&r===t)break;if(i=this.getOrCreateTrForRow(r,i),this.renderRowHeaders(s,i),this.adjustColumns(i,o+this.rowHeaderCount),n=this.renderCells(s,i,o),a||this.resetOversizedRow(s),i.firstChild){var l=this.instance.wtTable.getRowHeight(s);l?i.firstChild.style.height=l+"px":i.firstChild.style.height=""}r++,s=this.rowFilter.renderedToSource(r)}},x.prototype.resetOversizedRow=function(e){this.instance.wtViewport.oversizedRows&&this.instance.wtViewport.oversizedRows[e]&&(this.instance.wtViewport.oversizedRows[e]=void 0)},x.prototype.markOversizedRows=function(){for(var e,o,n,i,r=this.instance.wtTable.TBODY.childNodes.length;r;)r--,n=this.instance.wtTable.rowFilter.renderedToSource(r),e=this.instance.wtTable.getRowHeight(n),i=this.instance.wtTable.getTrForRow(n),o=t.Dom.innerHeight(i)-1,(!e&&this.instance.wtSettings.settings.defaultRowHeight<o||o>e)&&(this.instance.wtViewport.oversizedRows[n]=o)},x.prototype.adjustColumnHeaderHeights=function(){for(var e=this.instance.getSetting("columnHeaders"),t=0,o=e.length;o>t;t++)if(this.instance.wtViewport.oversizedColumnHeaders[t]){if(0===this.instance.wtTable.THEAD.childNodes[t].childNodes.length)return;this.instance.wtTable.THEAD.childNodes[t].childNodes[0].style.height=this.instance.wtViewport.oversizedColumnHeaders[t]+"px"}},x.prototype.markIfOversizedColumnHeader=function(e){var o,n,i,r,s=(0!==this.instance.wtTable.THEAD.childNodes.length?this.instance.wtTable.THEAD.childNodes[0].childNodes.length:0,this.instance.getSetting("columnHeaders")),a=s.length,l=a;for(o=this.instance.wtTable.columnFilter.renderedToSource(e);l;)l--,n=this.instance.wtTable.getColumnHeaderHeight(l),i=this.instance.wtTable.getColumnHeader(o,l),i&&(r=t.Dom.innerHeight(i)-1,(!n&&this.instance.wtSettings.settings.defaultRowHeight<r||r>n)&&(this.instance.wtViewport.oversizedColumnHeaders[l]=r))},x.prototype.renderCells=function(e,o,n){for(var i,r,s=0;n>s;s++)r=this.columnFilter.renderedToSource(s),i=0===s?o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]:i.nextSibling,"TH"==i.nodeName&&(i=this.utils.replaceThWithTd(i,o)),t.Dom.hasClass(i,"hide")||(i.className=""),i.removeAttribute("style"),this.instance.wtSettings.settings.cellRenderer(e,r,i);return i},x.prototype.adjustColumnWidths=function(e){var t;this.instance.wtViewport.columnsRenderCalculator.refreshStretching(this.instance.wtViewport.getViewportWidth());for(var o=0;e>o;o++)t=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(o)),this.COLGROUP.childNodes[o+this.rowHeaderCount].style.width=t+"px"},x.prototype.appendToTbody=function(e){this.TBODY.appendChild(e),this.wtTable.tbodyChildrenLength++},x.prototype.getOrCreateTrForRow=function(e,t){var o;return e>=this.wtTable.tbodyChildrenLength?(o=this.createRow(),this.appendToTbody(o)):o=0===e?this.TBODY.firstChild:t.nextSibling,o},x.prototype.createRow=function(){for(var e=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)e.appendChild(document.createElement("TH"));return e},x.prototype.renderRowHeader=function(e,t,o){o.className="",o.removeAttribute("style"),this.rowHeaders[t](e,o,t)},x.prototype.renderRowHeaders=function(e,t){for(var o=t.firstChild,n=0;n<this.rowHeaderCount;n++)o?"TD"==o.nodeName&&(o=this.utils.replaceTdWithTh(o,t)):(o=document.createElement("TH"),t.appendChild(o)),this.renderRowHeader(e,n,o),o=o.nextSibling},x.prototype.adjustAvailableNodes=function(){this.adjustColGroups(),this.adjustThead()},x.prototype.renderColumnHeaders=function(){if(this.columnHeaderCount)for(var e,t,o=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(e=this.getTrForColumnHeaders(n),t=-1*this.rowHeaderCount;o>t;t++){var i=this.columnFilter.renderedToSource(t);this.renderColumnHeader(n,i,e.childNodes[t+this.rowHeaderCount]),this.wtTable.isWorkingOnClone()||this.markIfOversizedColumnHeader(t)}},x.prototype.adjustColGroups=function(){for(var e=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<e+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>e+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--},x.prototype.adjustThead=function(){var e=this.wtTable.getRenderedColumnsCount(),o=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=0,i=this.columnHeaders.length;i>n;n++){for(o=this.THEAD.childNodes[n],o||(o=document.createElement("TR"),this.THEAD.appendChild(o)),this.theadChildrenLength=o.childNodes.length;this.theadChildrenLength<e+this.rowHeaderCount;)o.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>e+this.rowHeaderCount;)o.removeChild(o.lastChild),this.theadChildrenLength--}var r=this.THEAD.childNodes.length;if(r>this.columnHeaders.length)for(var n=this.columnHeaders.length;r>n;n++)this.THEAD.removeChild(this.THEAD.lastChild)}else o&&t.Dom.empty(o)},x.prototype.getTrForColumnHeaders=function(e){var t=this.THEAD.childNodes[e];return t},x.prototype.renderColumnHeader=function(e,t,o){return o.className="",o.removeAttribute("style"),this.columnHeaders[e](t,o,e)},x.prototype.renderColGroups=function(){for(var e=0;e<this.wtTable.colgroupChildrenLength;e++)e<this.rowHeaderCount?t.Dom.addClass(this.COLGROUP.childNodes[e],"rowHeader"):t.Dom.removeClass(this.COLGROUP.childNodes[e],"rowHeader")},x.prototype.adjustColumns=function(e,t){for(var o=e.childNodes.length;t>o;){var n=document.createElement("TD");e.appendChild(n),o++}for(;o>t;)e.removeChild(e.lastChild),o--},x.prototype.removeRedundantColumns=function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},x.utils={},x.utils.replaceTdWithTh=function(e,t){var o;return o=document.createElement("TH"),t.insertBefore(o,e),t.removeChild(e),o},x.utils.replaceThWithTd=function(e,t){var o=document.createElement("TD");return t.insertBefore(o,e),t.removeChild(e),o},D.prototype.getWorkspaceHeight=function(){var o=this.instance.wtScrollbars.vertical.scrollHandler;if(o===e)return document.documentElement.clientHeight;var n=t.Dom.outerHeight(o),i=n>0&&o.clientHeight>0?o.clientHeight:1/0;return i},D.prototype.getWorkspaceWidth=function(){var o,n,i=this.instance.getSetting("totalColumns"),r=this.instance.wtScrollbars.horizontal.scrollHandler,s=this.instance.getSetting("stretchH");return o=t.freezeOverlays?Math.min(document.documentElement.offsetWidth-this.getWorkspaceOffset().left,document.documentElement.offsetWidth):Math.min(this.getContainerFillWidth(),document.documentElement.offsetWidth-this.getWorkspaceOffset().left,document.documentElement.offsetWidth),r===e&&i>0&&this.sumColumnWidths(0,i-1)>o?document.documentElement.clientWidth:r!==e&&(n=this.instance.wtScrollbars.horizontal.scrollHandler.style.overflow,"scroll"==n||"hidden"==n||"auto"==n)?Math.max(o,r.clientWidth):"none"!==s&&s?o:Math.max(o,t.Dom.outerWidth(this.instance.wtTable.TABLE))},D.prototype.sumColumnWidths=function(e,t){for(var o=0;t>e;)o+=this.instance.wtTable.getColumnWidth(e)||this.instance.wtSettings.defaultColumnWidth,e++;return o},D.prototype.getContainerFillWidth=function(){if(this.containerWidth)return this.containerWidth;for(var e,t,o=this.instance.wtTable.holder;o.parentNode!=document.body&&null!=o.parentNode&&-1===o.className.indexOf("handsontable");)o=o.parentNode;return t=document.createElement("DIV"),t.style.width="100%",t.style.height="1px",o.appendChild(t),e=t.offsetWidth,this.containerWidth=e,o.removeChild(t),e},D.prototype.getWorkspaceOffset=function(){return t.Dom.offset(this.instance.wtTable.TABLE)},D.prototype.getWorkspaceActualHeight=function(){return t.Dom.outerHeight(this.instance.wtTable.TABLE)},D.prototype.getWorkspaceActualWidth=function(){return t.Dom.outerWidth(this.instance.wtTable.TABLE)||t.Dom.outerWidth(this.instance.wtTable.TBODY)||t.Dom.outerWidth(this.instance.wtTable.THEAD)},D.prototype.getColumnHeaderHeight=function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=t.Dom.outerHeight(this.instance.wtTable.THEAD)),this.columnHeaderHeight},D.prototype.getViewportHeight=function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var t=this.getColumnHeaderHeight();return t>0&&(e-=t),e},D.prototype.getRowHeaderWidth=function(){if(this.instance.cloneSource)return this.instance.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth)){var e=this.instance.getSetting("rowHeaders");if(e.length){var o=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var n=0,i=e.length;i>n;n++)o?(this.rowHeaderWidth+=t.Dom.outerWidth(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth},D.prototype.getViewportWidth=function(){var e,t=this.getWorkspaceWidth();return t===1/0?t:(e=this.getRowHeaderWidth(),e>0?t-e:t)},D.prototype.createRowsCalculator=function(e){this.rowHeaderWidth=NaN;var t;t=this.instance.wtSettings.settings.renderAllRows?1/0:this.getViewportHeight();var o=this.instance.wtScrollbars.vertical.getScrollPosition()-this.instance.wtScrollbars.vertical.getTableParentOffset();0>o&&(o=0);var n=this.instance.getSetting("fixedRowsTop");if(n){var i=this.instance.wtScrollbars.vertical.sumCellSizes(0,n);o+=i,t-=i}var r=this;return new O(t,o,this.instance.getSetting("totalRows"),function(e){return r.instance.wtTable.getRowHeight(e)},e?null:this.instance.wtSettings.settings.viewportRowCalculatorOverride,e?!0:!1)},D.prototype.createColumnsCalculator=function(e){this.columnHeaderHeight=NaN;var t=this.getViewportWidth(),o=this.instance.wtScrollbars.horizontal.getScrollPosition()-this.instance.wtScrollbars.vertical.getTableParentOffset();0>o&&(o=0);var n=this.instance.getSetting("fixedColumnsLeft");if(n){var i=this.instance.wtScrollbars.horizontal.sumCellSizes(0,n);o+=i,t-=i}var r=this;return new A(t,o,this.instance.getSetting("totalColumns"),function(e){return r.instance.wtTable.getColumnWidth(e)},e?null:this.instance.wtSettings.settings.viewportColumnCalculatorOverride,e?!0:!1,this.instance.getSetting("stretchH"))},D.prototype.createRenderCalculators=function(e){if(e){var t=this.createRowsCalculator(!0),o=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e},D.prototype.createVisibleCalculators=function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)},D.prototype.areAllProposedVisibleRowsAlreadyRendered=function(e){return this.rowsVisibleCalculator?e.startRow<this.rowsRenderCalculator.startRow||e.startRow===this.rowsRenderCalculator.startRow&&e.startRow>0?!1:e.endRow>this.rowsRenderCalculator.endRow||e.endRow===this.rowsRenderCalculator.endRow&&e.endRow<this.instance.getSetting("totalRows")-1?!1:!0:!1},D.prototype.areAllProposedVisibleColumnsAlreadyRendered=function(e){return this.columnsVisibleCalculator?e.startColumn<this.columnsRenderCalculator.startColumn||e.startColumn===this.columnsRenderCalculator.startColumn&&e.startColumn>0?!1:e.endColumn>this.columnsRenderCalculator.endColumn||e.endColumn===this.columnsRenderCalculator.endColumn&&e.endColumn<this.instance.getSetting("totalColumns")-1?!1:!0:!1},e.jQuery&&!function(e,t,o){t.fn.handsontable=function(e){var t,n,i,r,s,a=this.first(),l=a.data("handsontable");if("string"!=typeof e)return s=e||{},l?l.updateSettings(s):(l=new o.Core(a[0],s),a.data("handsontable",l),l.init()),a;if(i=[],arguments.length>1)for(t=1,n=arguments.length;n>t;t++)i.push(arguments[t]);if(l){if("undefined"==typeof l[e])throw new Error("Handsontable do not provide action: "+e);r=l[e].apply(l,i),"destroy"===e&&a.removeData()}return r}}(e,jQuery,t)}(window,Handsontable),/*!
 * numeral.js
 * version : 1.5.3
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */
function(){function e(e){this._value=e}function t(e,t,o,n){var i,r,s=Math.pow(10,t);return r=(o(e*s)/s).toFixed(t),n&&(i=new RegExp("0{1,"+n+"}$"),r=r.replace(i,"")),r}function o(e,t,o){var n;return n=t.indexOf("$")>-1?i(e,t,o):t.indexOf("%")>-1?r(e,t,o):t.indexOf(":")>-1?s(e,t):l(e._value,t,o)}function n(e,t){var o,n,i,r,s,l=t,c=["KB","MB","GB","TB","PB","EB","ZB","YB"],h=!1;if(t.indexOf(":")>-1)e._value=a(t);else if(t===g)e._value=0;else{for("."!==p[m].delimiters.decimal&&(t=t.replace(/\./g,"").replace(p[m].delimiters.decimal,".")),o=new RegExp("[^a-zA-Z]"+p[m].abbreviations.thousand+"(?:\\)|(\\"+p[m].currency.symbol+")?(?:\\))?)?$"),n=new RegExp("[^a-zA-Z]"+p[m].abbreviations.million+"(?:\\)|(\\"+p[m].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+p[m].abbreviations.billion+"(?:\\)|(\\"+p[m].currency.symbol+")?(?:\\))?)?$"),r=new RegExp("[^a-zA-Z]"+p[m].abbreviations.trillion+"(?:\\)|(\\"+p[m].currency.symbol+")?(?:\\))?)?$"),s=0;s<=c.length&&!(h=t.indexOf(c[s])>-1?Math.pow(1024,s+1):!1);s++);e._value=(h?h:1)*(l.match(o)?Math.pow(10,3):1)*(l.match(n)?Math.pow(10,6):1)*(l.match(i)?Math.pow(10,9):1)*(l.match(r)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(t.replace(/[^0-9\.]+/g,"")),e._value=h?Math.ceil(e._value):e._value}return e._value}function i(e,t,o){var n,i,r=t.indexOf("$"),s=t.indexOf("("),a=t.indexOf("-"),c="";return t.indexOf(" $")>-1?(c=" ",t=t.replace(" $","")):t.indexOf("$ ")>-1?(c=" ",t=t.replace("$ ","")):t=t.replace("$",""),i=l(e._value,t,o),1>=r?i.indexOf("(")>-1||i.indexOf("-")>-1?(i=i.split(""),n=1,(s>r||a>r)&&(n=0),i.splice(n,0,p[m].currency.symbol+c),i=i.join("")):i=p[m].currency.symbol+c+i:i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,c+p[m].currency.symbol),i=i.join("")):i=i+c+p[m].currency.symbol,i}function r(e,t,o){var n,i="",r=100*e._value;return t.indexOf(" %")>-1?(i=" ",t=t.replace(" %","")):t=t.replace("%",""),n=l(r,t,o),n.indexOf(")")>-1?(n=n.split(""),n.splice(-1,0,i+"%"),n=n.join("")):n=n+i+"%",n}function s(e){var t=Math.floor(e._value/60/60),o=Math.floor((e._value-60*t*60)/60),n=Math.round(e._value-60*t*60-60*o);return t+":"+(10>o?"0"+o:o)+":"+(10>n?"0"+n:n)}function a(e){var t=e.split(":"),o=0;return 3===t.length?(o+=60*Number(t[0])*60,o+=60*Number(t[1]),o+=Number(t[2])):2===t.length&&(o+=60*Number(t[0]),o+=Number(t[1])),Number(o)}function l(e,o,n){var i,r,s,a,l,c,h=!1,u=!1,d=!1,f="",v=!1,w=!1,y=!1,C=!1,b=!1,_="",R="",S=Math.abs(e),E=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],T="",k=!1;if(0===e&&null!==g)return g;if(o.indexOf("(")>-1?(h=!0,o=o.slice(1,-1)):o.indexOf("+")>-1&&(u=!0,o=o.replace(/\+/g,"")),o.indexOf("a")>-1&&(v=o.indexOf("aK")>=0,w=o.indexOf("aM")>=0,y=o.indexOf("aB")>=0,C=o.indexOf("aT")>=0,b=v||w||y||C,o.indexOf(" a")>-1?(f=" ",o=o.replace(" a","")):o=o.replace("a",""),S>=Math.pow(10,12)&&!b||C?(f+=p[m].abbreviations.trillion,e/=Math.pow(10,12)):S<Math.pow(10,12)&&S>=Math.pow(10,9)&&!b||y?(f+=p[m].abbreviations.billion,e/=Math.pow(10,9)):S<Math.pow(10,9)&&S>=Math.pow(10,6)&&!b||w?(f+=p[m].abbreviations.million,e/=Math.pow(10,6)):(S<Math.pow(10,6)&&S>=Math.pow(10,3)&&!b||v)&&(f+=p[m].abbreviations.thousand,e/=Math.pow(10,3))),o.indexOf("b")>-1)for(o.indexOf(" b")>-1?(_=" ",o=o.replace(" b","")):o=o.replace("b",""),s=0;s<=E.length;s++)if(i=Math.pow(1024,s),r=Math.pow(1024,s+1),e>=i&&r>e){_+=E[s],i>0&&(e/=i);break}return o.indexOf("o")>-1&&(o.indexOf(" o")>-1?(R=" ",o=o.replace(" o","")):o=o.replace("o",""),R+=p[m].ordinal(e)),o.indexOf("[.]")>-1&&(d=!0,o=o.replace("[.]",".")),a=e.toString().split(".")[0],l=o.split(".")[1],c=o.indexOf(","),l?(l.indexOf("[")>-1?(l=l.replace("]",""),l=l.split("["),T=t(e,l[0].length+l[1].length,n,l[1].length)):T=t(e,l.length,n),a=T.split(".")[0],T=T.split(".")[1].length?p[m].delimiters.decimal+T.split(".")[1]:"",d&&0===Number(T.slice(1))&&(T="")):a=t(e,null,n),a.indexOf("-")>-1&&(a=a.slice(1),k=!0),c>-1&&(a=a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p[m].delimiters.thousands)),0===o.indexOf(".")&&(a=""),(h&&k?"(":"")+(!h&&k?"-":"")+(!k&&u?"+":"")+a+T+(R?R:"")+(f?f:"")+(_?_:"")+(h&&k?")":"")}function c(e,t){p[e]=t}function h(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function u(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){var o=h(e),n=h(t);return o>n?o:n},-(1/0))}var d,f="1.5.3",p={},m="en",g=null,v="0,0",w="undefined"!=typeof module&&module.exports;d=function(t){return d.isNumeral(t)?t=t.value():0===t||"undefined"==typeof t?t=0:Number(t)||(t=d.fn.unformat(t)),new e(Number(t))},d.version=f,d.isNumeral=function(t){return t instanceof e},d.language=function(e,t){if(!e)return m;if(e=e.toLowerCase(),e&&!t){if(!p[e])throw new Error("Unknown language : "+e);m=e}return(t||!p[e])&&c(e,t),d},d.languageData=function(e){if(!e)return p[m];if(!p[e])throw new Error("Unknown language : "+e);return p[e]},d.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),d.zeroFormat=function(e){g="string"==typeof e?e:null},d.defaultFormat=function(e){v="string"==typeof e?e:"0.0"},d.validate=function(e,t){var o,n,i,r,s,a,l,c;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",e)),e=e.trim(),""===e)return!1;e=e.replace(/^[+-]?/,"");try{l=d.languageData(t)}catch(h){l=d.languageData(d.language())}return i=l.currency.symbol,s=l.abbreviations,o=l.delimiters.decimal,n="."===l.delimiters.thousands?"\\.":l.delimiters.thousands,c=e.match(/^[^\d]+/),null!==c&&(e=e.substr(1),c[0]!==i)?!1:(c=e.match(/[^\d]+$/),null!==c&&(e=e.slice(0,-1),c[0]!==s.thousand&&c[0]!==s.million&&c[0]!==s.billion&&c[0]!==s.trillion)?!1:e.match(/^\d+$/)?!0:(a=new RegExp(n+"{2}"),e.match(/[^\d.,]/g)?!1:(r=e.split(o),r.length>2?!1:r.length<2?!!r[0].match(/^\d+.*\d$/)&&!r[0].match(a):1===r[0].length?!!r[0].match(/^\d+$/)&&!r[0].match(a)&&!!r[1].match(/^\d+$/):!!r[0].match(/^\d+.*\d$/)&&!r[0].match(a)&&!!r[1].match(/^\d+$/))))},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var o,n,i=this.length>>>0,r=!1;for(1<arguments.length&&(n=t,r=!0),o=0;i>o;++o)this.hasOwnProperty(o)&&(r?n=e(n,this[o],o,this):(n=this[o],r=!0));if(!r)throw new TypeError("Reduce of empty array with no initial value");return n}),d.fn=e.prototype={clone:function(){return d(this)},format:function(e,t){return o(this,e?e:v,void 0!==t?t:Math.round)},unformat:function(e){return"[object Number]"===Object.prototype.toString.call(e)?e:n(this,e?e:v)},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){function t(e,t,n,i){return e+o*t}var o=u.call(null,this._value,e);return this._value=[this._value,e].reduce(t,0)/o,this},subtract:function(e){function t(e,t,n,i){return e-o*t}var o=u.call(null,this._value,e);return this._value=[e].reduce(t,this._value*o)/o,this},multiply:function(e){function t(e,t,o,n){var i=u(e,t);return e*i*(t*i)/(i*i)}return this._value=[this._value,e].reduce(t,1),this},divide:function(e){function t(e,t,o,n){var i=u(e,t);return e*i/(t*i)}return this._value=[this._value,e].reduce(t),this},difference:function(e){return Math.abs(d(this._value).subtract(e).value())}},w&&(module.exports=d),"undefined"==typeof ender&&(this.numeral=d),"function"==typeof define&&define.amd&&define([],function(){return d})}.call(this),Rumali.plugins=function(){var e,t=function(){var e=document.createElement("div");e.setAttribute("id","rumali_loading_overlay"),e.style.display="none",document.body.insertBefore(e,document.getElementById("navbar_default"));var t=document.createElement("div");t.className="rumali-loading-text",t.innerHTML="Loading..",document.getElementById("rumali_loading_overlay").appendChild(t),$(document).ajaxStart(function(t){e.style.opacity=1,e.style.display="block"}),$(document).ajaxStop(function(t){e.style.opacity=0,setTimeout(function(){e.style.display="none"},250)})};t(),this.rumiLocales={getPossibleColumnOperations:function(){var e={string:[{name:"Change to Uppercase",id:"uppercase"},{name:"Change to Lowercase",id:"lowercase"},{name:"Capitalize first letter",id:"titlecase"},{name:"divider",id:"divider"},{name:"Remove spaces before and after data",id:"trim"},{name:"Collapse consecutive white spaces",id:"whitespace"},{name:"divider",id:"divider"},{name:"Remove Character",id:"removechar"},{name:"Replace",id:"mergetoclean"}],"boolean":[],integer:[],"double":[],date:[]};return e}},$(document).on("click","#filter_toggle",function(){var t=$("#filter_toggle :checked").attr("value");if(t==e)return!1;if(e=t,Rumali.gridoperation.getSelectedColumnIndex()!==!1)var o,n=Rumali.gridoperation.getSelectedColumnIndex(),i=self.column_datatype[n+1];else var i=selected_datatype;switch(o="integer"==i||"double"==i?"range":"value"){case"value":break;case"range":var r=parseFloat($("#min_value").val()),s=parseFloat($("#max_value").val()),a=$("#filter_toggle :checked").val();Rumali.executeAfterRangeFilter(),global_brush.extent([r,s]),brush.call(global_brush),"in"==a?pyk_histogram.addFilter([[{column_name:new_column_name,condition_type:"range",condition:{min:r,max:s,not:!1},override_filter:!0,next:"AND"}]],!0,!0):pyk_histogram.addFilter([[{column_name:new_column_name,condition_type:"range",condition:{min:r,max:s,not:!0},override_filter:!0,next:"AND"}]],!0,!0)}}),this.toTitleCase=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}};var that,PYKMODEL,grid,new_column_name,new_column_value_index,data_distribution;Rumali.pykGrid=function(){var e=!1;this.appendGrid=function(t,o){function n(e,t,o,n,i,r,s){if("integer"==self.column_datatype[n+1]||"double"==self.column_datatype[n+1]?Handsontable.NumericCell.renderer.apply(this,arguments):"boolean"==self.column_datatype[n+1]?Handsontable.CheckboxCell.renderer.apply(this,arguments):Handsontable.TextCell.renderer.apply(this,arguments),0>=o){s.format="",Handsontable.TextCell.renderer.apply(this,arguments);self.original_column_names[n+1];$(t).removeClass("htInvalid"),$(t).addClass("hover-tootip"),t.style.fontWeight="bold",t.style.color="#1B668B",t.style.background="#f0f0f0"}else o%2!=0&&$("#highlight-row").hasClass("check")&&(t.style.background="#A9F5A9");$("#highlight-cell").hasClass("check")&&(""==r||null==r||void 0==r)&&(t.style.background="#F5A9A9")}Rumali.gridoperation.isChecked=!1,$container=$("#grid_show"),$("#grid_show").height(700),"map"==data_store_action_name&&$("#grid_show").height(150);!gon.mode;$("#grid_show").handsontable({data:self.json_data,rowHeaders:!0,colHeaders:!0,fixedRowsTop:1,readOnly:!0,manualColumnMove:!0,stretchH:"all",outsideClickDeselects:!1,afterValidate:function(e,t,o,n,i){},afterSelectionEnd:function(n,i,r,s){var a=$container.handsontable("getInstance");0==n&&r==self.json_data.length-1?(a.updateSettings({contextMenu:t}),e=!0):0==i&&s==self.column_datatype.length-2?(a.updateSettings({contextMenu:o}),e=!0):1==e&&(a.updateSettings({contextMenu:!1}),e=!1)},afterCreateRow:function(e,t){self.json_data[e].push(null)},contextMenu:!1,myPlugin:!1,cells:function(e,t,o){return{renderer:n}}});var i=!1;Rumali.gridoperation.showFilterCount();var r=$container.handsontable("getInstance");r.addHook("afterOnCellMouseDown",function(e,t,o){if(-1==t.row&&-1!=t.col&&0==e.button){var n=$("#grid_show").handsontable("getSelected")[1],r=self.columns_header[n+1];new_column_name=r,new_column_value_index=n,Rumali.gridoperation.columnHeaderSelected(t.col),Rumali.gridoperation.getAzaxcall(),i=!0}else i&&Rumali.gridoperation.columnHeaderDeselected()}),r.addHook("afterColumnMove",function(e,t){var o=self.columns_header[e+1],n=self.columns_header[t],i={};i.column_name=o,i.after=n,Rumali.api.postAjaxcall(i,"/column/move")}),r.addHook("beforeChange",function(e,t){return e.length>1?(alert("Multiple cell editing is not allowed"),!1):void 0}),r.addHook("afterChange",function(e,t){if(null==e||"loadData"==t)return!1;var o=e[0][0],n=e[0][1],i=e[0][2],r=e[0][3];if(i!=r)if(null==self.json_data[o][0]){if(""==r)return!1;for(var s={},a=self.json_data[o],l=a.length,c=0;l>c;c++)null==a[c]&&(a[c]="");console.log(a),s.data=a,s.token=gon.token,Rumali.api.rowAddApiCall(s,function(e){self.json_data[o][0]=e.id},function(){self.json_data[o][0]=null,self.json_data[o][n]=null})}else{var h,s={};0==o?(h="column/change_name",s.new_original_column_name=r,s.column_name=self.columns_header[n]):(h="cell/update",s.row_id=self.json_data[o][0],s.value=r,s.column_name=self.columns_header[n]),console.log(r,"new"),console.log(i,"old"),s.token=gon.token,Rumali.api.columnAndCellChangeApiCall(s,h,function(e){if(0==o){divg1.changeColumnName(i,e.column_name),self.json_data[o][n]=e.column_name,$container.handsontable("render");var t=new Rumali.categorizeColumns;t.init()}},function(){self.json_data[o][n]=i,0==o&&($container.handsontable("render"),$container.handsontable("selectCell",o,n-1),alert("column name change failed"))})}}),r.addHook("beforeRemoveRow",function(e,t){for(var o=[],n={};t>0;)o.push(self.json_data[e][0]),t--,e++;n.row_id=o,n.token=gon.token,Rumali.api.rowDeleteApiCall(n)}),r.addHook("afterOnCellMouseDown",function(e,t){-1!=t.row&&Rumali.gridoperation.columnHeaderDeselected()})},this.getShowPage=function(){function e(){self.column_datatype=Rumali.gridoperation.changeToColumnsType(self.column_datatype);var e=$("#grid_show").handsontable("getInstance");columns=Rumali.gridoperation.getColumnsWithType(self.column_datatype),e.updateSettings({data:self.json_data,columns:columns}),Rumali.gridoperation.getAzaxcall()}function t(){n+=1,2==n&&(e(),n=0)}var o={},n=0;grid_show.executeOnFilter=function(){json_data=grid_show.flushToGet(),void 0!=json_data&&(self.json_data=json_data.data,t())};try{grid_show.call()}catch(i){console.log(i)}try{grid_columns.call()}catch(i){console.log(i+"error in pagination count not available")}o.original_names=!0,o.data_types=!0,o.token=gon.token,o.sub_types=!0,Rumali.api.originalColumnName(o,function(e){self.column_datatype=e,t()})}},Rumali.pykgrid=new Rumali.pykGrid,Rumali.histogram=function(e,t,o,n,i){function r(){brush_extent=d3.event.target.extent(),n=brush_extent[0],i=brush_extent[1],i!=n&&a(i,n)}var s=5;n||(n=0,$("#min_value").val("Min")),i||(i=0,$("#max_value").val("Max")),$("#histogram-chart").empty();var a=function(t,o){new_column_name=e,$("#filter_toggle").show(),Rumali.executeAfterHistogramFilter();var n=$("#min_value").attr("data-prev_val"),i=$("#max_value").attr("data-prev_val"),r=parseFloat(o).toFixed(2),s=parseFloat(t).toFixed(2);if($("#min_value").val(r),$("#max_value").val(s),$("#min_value").attr("data-prev_val",r),$("#max_value").attr("data-prev_val",s),n!=r||i!=s){var a=$("#filter_toggle :checked").val(),l=!1;"notin"==a&&(l=!0),pyk_histogram.addFilter([[{column_name:new_column_name,condition_type:"range",condition:{min:o,max:t,not:l},override_filter:!0,next:"AND"}]],!0,!0)}};if("integer"===t||"double"===t){$("#histogram-chart").show(),$("#histogram-chart").html("<span style='float:left'><h5 style='margin-top: 0px; font-size: 14px; padding-top: 0px;'>Filter by value</h5></span><a id='reset'><u>Reset</u></a>");var l=[];for(var c in o)c&&!isNaN(c)&&"undefined"!==c&&l.push({key:parseFloat(c),value:parseInt(o[c],10)});var h=d3.extent(l,function(e){return e.key}),u=h[0],d=h[1]+parseFloat(((h[1]-h[0])/10).toFixed(2)),f=(h[1]-h[0])/s,p=[],m=h[0],g=h[0]+f,v=h[0]-1,w=0;0==n||0==i?($("#min_value").val(parseFloat(u).toFixed(2)),$("#min_value").attr("data-val",parseFloat(u).toFixed(2)),$("#max_value").val(parseFloat(d).toFixed(2)),$("#max_value").attr("data-val",parseFloat(d).toFixed(2)),$("#filter_toggle").hide(),$("#min_value").attr("placeholder",parseFloat(u).toFixed(2)),$("#max_value").attr("placeholder",parseFloat(d).toFixed(2))):($("#min_value").val(parseFloat(n).toFixed(2)),$("#max_value").val(parseFloat(i).toFixed(2)),$("#filter_toggle").show());for(var y=0;s>y;y++)w=l.filter(function(e){return e.key<=g&&e.key>v}),p.push({key:m,value:d3.sum(w,function(e){return e.value})}),v=g,g+=f,m+=f;var C=d3.extent(p,function(e){return e.value}),b=parseFloat(((C[1]-C[0])/10).toFixed(2)),_=0,R=C[1]+b,S=d3.format(",.0f"),E={top:10,right:20,bottom:30,left:10},T=250-E.left-E.right,k=120-E.top-E.bottom,x=d3.scale.linear().domain([u,d]).range([0,T]),D=d3.scale.linear().domain([_,R]).range([k,0]),A=d3.svg.axis().scale(x).ticks(3).orient("bottom");svg=d3.select("#histogram-chart").append("svg").attr("width",T+E.left+E.right).attr("height",k+E.top+E.bottom).append("g").attr("transform","translate("+E.left+","+E.top+")");var O=svg.selectAll(".bar").data(p).enter().append("g").attr("class","bar").attr("transform",function(e){return"translate("+x(e.key)+","+D(e.value)+")"});O.append("rect").attr("x",1).attr("width",T/(s+1)).attr("height",function(e){return k-D(e.value)}),O.append("text").attr("dy",".75em").attr("y",-12).attr("x",T/s/2).attr("text-anchor","middle").text(function(e){return S(e.value)}),svg.append("g").attr("class","x axis").attr("transform","translate(0,"+k+")").call(A);var H=u,P=d;n&&n>0?(H=n,P=i):(H=0,P=0),global_brush=d3.svg.brush().x(x).extent([H,P]).on("brushend",r),brush=svg.append("g").attr("class","brush").call(global_brush),brush.selectAll("rect").attr("height",k);var N=function(e){var t=+("e"==e),o=t?1:-1,n=k/3;return"M"+.5*o+","+n+"A6,6 0 0 "+t+" "+6.5*o+","+(n+6)+"V"+(2*n-6)+"A6,6 0 0 "+t+" "+.5*o+","+2*n+"ZM"+2.5*o+","+(n+8)+"V"+(2*n-8)+"M"+4.5*o+","+(n+8)+"V"+(2*n-8)};brush.selectAll(".resize").append("path").attr("d",N),$("#pyk_histogram").show(),$("#histogram_min_max").show(),$("#merge").hide()}else if("date"===t){return!1;var l,c,h,u,d,f,p,m,g,v,w,y,C,b,_,R,S,E,T,k,x,D,A,O,N}else $("#histogram_min_max").hide()};var check_histogram_min_max_values=function(){var e=parseFloat($("#min_value").attr("data-val")),t=parseFloat($("#max_value").attr("data-val")),o=parseFloat($("#min_value").attr("data-prev_val")),n=parseFloat($("#max_value").attr("data-prev_val")),i=parseFloat($("#min_value").val()),r=parseFloat($("#max_value").val());if($("#min_value").attr("data-prev_val",i),$("#max_value").attr("data-prev_val",r),(o!=i||n!=r)&&t>i&&i>=e&&r>e&&t>=r&&r>i){var s=$("#filter_toggle :checked").val(),a=!1;"notin"==s&&(a=!0),Rumali.executeAfterHistogramFilter(i,r),pyk_histogram.addFilter([[{column_name:new_column_name,condition_type:"range",condition:{min:i,max:r,not:a},override_filter:!0,next:"AND"}]],!0,!0)}};Rumali.sidebarHistogram=function(){$(document).on("blur",".histogram-val",function(){$("#filter_toggle").show(),check_histogram_min_max_values()})},$(document).on("click","#reset",function(){d3.select("rect.extent").attr("x",0).attr("width",0),d3.selectAll("g.resize").style("display","none"),divg1.destroyColumn(new_column_name),Rumali.gridoperation.showFilterCount()}),Rumali.sidebarUnique=function(){function e(e,t){var o=$("#"+t);o.find("tr").each(function(t,o){var n=$(o).find("td");if(n.length>0){var i=!1;n.each(function(t,o){var n=new RegExp(e,"i");return n.test($(o).text())?(i=!0,!1):void 0}),1==i?o.style.display="block":o.style.display="none"}})}$(document).on("click",".sort-unique",function(e){var t=$(this).attr("id");$("#dropdownsortvalue").html("Sort Value by "+Rumali.plugin.toTitleCase(t)+" <span class='caret'></span>"),Rumali.countUniqueValues(data_distribution,t),Rumali.gridoperation.resetFilterElements(),e.preventDefault()}),$(document).on("click",".sort-unique-modal",function(e){var t=$(this).attr("id");$("#dropdownsortvalue_modal").html("Sort Value by "+Rumali.plugin.toTitleCase(t)+" <span class='caret'></span>"),Rumali.countUniqueValuesOnModal(data_distribution,t),Rumali.gridoperation.resetFilterElements(),e.preventDefault()}),Rumali.countUniqueValues=function(e,t,o,n){if(Rumali.gridoperation.getSelectedColumnIndex()!==!1)var r=Rumali.gridoperation.getSelectedColumnIndex(),s=self.column_datatype[r+1],a=new_column_name;else{var s=n,a=o;new_column_name=o}var l,c=[],h="<table class='table table-condensed' id ='unique_values' >";Rumali.countUniqueValuesOnModal(e,t),c="name"==t?Object.keys(e).sort():Object.keys(e).sort(function(t,o){return e[o]-e[t]}),$("#grid_unique_values").empty(),$("#unique-values").empty();for(i in c)l=c[i],"t"==l?l="true":"f"==l&&(l="false"),h+="<tr>",h+="<td style='border: none; padding-top: 0px; padding-bottom: 0px; width: 10px;'>",h+="<input type='checkbox'  data-id ='"+a+c[i]+"' class='check-value' value='"+c[i]+"' /></td>",h+="<td style='font-size: 12px; border: none; padding-top: 0px; padding-bottom: 0px;'>"+l,h+="</td><td style='font-weight: bold; border: none; padding-top: 0px; padding-bottom: 0px;'>"+e[c[i]]+"</td></tr>";h+="</table>",$("#unique-values").append(Object.keys(e).length+" Unique value"),$("#unique-values").show(),$("#grid_unique_values").append(h),("string"==s||"date"==s)&&$("#merge").show()},Rumali.countUniqueValuesOnModal=function(e,t){var o=[],n=new_column_name,r="<table class='table table-condensed' id='unique-values-modal'>";o="name"==t?Object.keys(e).sort():Object.keys(e).sort(function(t,o){return e[o]-e[t]}),$("#unique_value_formodal").empty();for(i in o)r+="<tr>",r+="<td style='border: none; padding-top: 0px; padding-bottom: 0px; width: 10px;'>",r+="<input type='checkbox'  data-id ='"+n+o[i]+"' class='modal-check-value' value='"+o[i]+"' /></td>",r+="<td style='font-size: 12px; border: none; padding-top: 0px; padding-bottom: 0px;'>"+o[i],r+="</td><td style='font-weight: bold; border: none; padding-top: 0px; padding-bottom: 0px;'>"+e[o[i]]+"</td></tr>";r+="</table>",$("#unique_value_formodal").append(r)},$(document).on("click",".check-value",function(){var e=[],t=[],o=$("#filter_toggle :checked").val();e.push($(this).val()),col_name=new_column_name,$(".check-value:checked").each(function(e,o){t.push($(this).val())}),Rumali.executeAfterUniquevalueFilter(),"in"==o?column_values_filter.addFilter([[{column_name:col_name,condition_type:"values","in":e,next:"AND",selected_dom_id:$(this).attr("data-id")}]],!0,!0):column_values_filter.addFilter([[{column_name:col_name,condition_type:"values",not_in:e,next:"AND",selected_dom_id:$(this).attr("data-id")}]],!0,!0)}),$("#search_box").keyup(function(){e($(this).val(),"unique_values")}),$("#search_box_modal").keyup(function(){e($(this).val(),"unique-values-modal")})},Rumali.chartView=function(){Rumali.loadChartFromDropdown()},Rumali.showAndEditGridPage=function(){var e,t,o,n,i=function(){o=$(".d3-pykcharts")[0],t=o.dataset.datacast_identifier,e=Rumali.object.datacast_url+t,getJSON(e,s)},r=function(e){n=gon.chart_config,n.data=e,n.colHeaders=findKeyArray(e[0]),$(".d3-pykcharts").handsontable(n)},s=function(e){var t,n,i,s=e;"true"===o.dataset.filter_present?($("#filter_container").show(),t=renderFilter(s,o.dataset.filter_column_name,"filter_show"),$("#filter_container").html(t),$("#filter_show").change(function(){n=$("#filter_show option:selected").val(),i=filterChart(s,o.dataset.filter_column_name,n),r(i)}),$("select#filter_show").prop("selectedIndex",0),n=$("#filter_show option:selected").val(),i=filterChart(s,o.dataset.filter_column_name,n),r(i)):($("#filter_container").hide(),i=s,r(i))};i()},Rumali.showAndEditBoxPage=function(){var e,t,o,n,i,r=function(){o=$(".card_with_value")[0],t=o.dataset.datacast_identifier,e=Rumali.object.datacast_url+t,getJSON(e,s)},s=function(e){n=e,i=o.id,renderHTMLForCard(n,i,"col-sm-4")};r()},Rumali.loadChartFromDropdown=function(){var e,t,o={},n="",i={},r="",s={},a=function(){s=JSON.parse(gon.default_theme),$("#id_manual_chart_filter").attr("disabled",!0),$("#id_manual_chart_filter").attr("checked",!1),g(),$("#core_datacasts").change(function(){v(),0!==this.selectedIndex?(n="new_data",$("#id_manual_chart_filter").attr("disabled",!1),$("#id_manual_chart_filter").attr("checked",!1),g(),l(this.options[this.selectedIndex])):($("#id_manual_chart_filter").attr("disabled",!0),$("#id_manual_chart_filter").attr("checked",!1),g()),b()}),m(),C()},l=function(e,n){var i,r,s,a,l,c,h,d,f=[],p=[];o=e,"undefined"!=typeof e.dataset.metrics?(s=JSON.parse(e.dataset.metrics),d=s.sort().join(","),"undefined"!=typeof n&&(s=_.without(s,n)),a=s.sort().join(",")):(s=[],a=""),"undefined"!=typeof e.dataset.metrics?(l=JSON.parse(e.dataset.dimensions),h=l.sort().join(","),"undefined"!=typeof n&&(l=_.without(l,n)),c=l.sort().join(",")):(l=[],c=""),t=h!==c?"d":d!==a?"m":"",$("#chart_selector_list img").each(function(){var e=$(this)[0];"undefined"==typeof e.dataset.dimensions_alias||"undefined"===e.dataset.metrics_alias||0===e.dataset.dimensions_alias.length||0===e.dataset.metrics_alias.length?($(this).removeClass("disabled"),$(this).addClass("enabled"),$(this).unbind("click"),$(this).click(u)):(f=e.dataset.metrics_alias,p=e.dataset.dimensions_alias,i=JSON.parse(f).sort().join(","),r=JSON.parse(p).sort().join(","),a===i&&c===r?($(this).removeClass("disabled"),$(this).addClass("enabled"),$(this).unbind("click"),$(this).click(u)):($(this).removeClass("enabled"),$(this).addClass("disabled"),$(this).prop("onclick",null).off("click")))}),$("#chart_selector_list img")[0].click()},c=function(t){var o,n,i={};d(),"handsontable"===e.dataset.api?($("#table_show").show(),i={readOnly:!0,fixedRowsTop:0,manualColumnMove:!0,outsideClickDeselects:!1,contextMenu:!1},i.data=t,i.colHeaders=findKeyArray(t[0]),$("#table_show").handsontable(i)):"one-number-indicator"===e.dataset.api?($("#box_show").show(),renderHTMLForCard(t,"box_show","col-sm-4")):($("#chart_show").show(),i=$.extend({},s),o=getApiFromString(e.dataset.api),i.selector="#chart_show",i.data=t,i.chart_width=.6*$(window).width(),i.chart_height=450,i.map_code="world",n=new o(i),n.execute())},h=function(e){p(),i=e,c(e)},u=function(){var t=[];if("new_data"===n){var i=Rumali.object.datacast_url;i+=o.value,e=this,r="",getJSON(i,h)}else e=this,t=f(),c(t)},d=function(){$("#table_show").hide(),$("#chart_show").hide(),$("#box_show").hide()},f=function(){var e,t,o=[],n=-1;if(""!==r){for(t=$("#filter_show option:selected").text(),e=0;e<i.length;e++)if(t===i[e][r]){o[++n]={};for(var s in i[e])s!==r&&(o[n][s]=i[e][s])}return o}return o=i},p=function(){var e=JSON.parse(o.dataset.metrics).concat(JSON.parse(o.dataset.dimensions));return $("#core_datacasts_filter").find("option").remove().end(),$("#core_datacasts_filter").append($("<option>",{value:"Select filter column",text:"Select filter column"})),$.each(e,function(e,t){$("#core_datacasts_filter").append($("<option>",{value:t,text:t}))}),$("select#core_datacasts_filter").prop("selectedIndex",0),$("#core_datacasts_filter").unbind("change"),$("#core_datacasts_filter").change(function(){0!==this.selectedIndex&&(n="existing_data",r=this.options[this.selectedIndex].text,y(r),l(o,this.options[this.selectedIndex].text))}),e},m=function(){var e=document.getElementById("core_datacasts");$("#id_manual_chart_filter").unbind("change"),$("#id_manual_chart_filter").change(function(){g(),v(),w(),l(e.options[e.selectedIndex])})},g=function(){is_datacast_filter_enable=$("#id_manual_chart_filter").is(":checked"),is_datacast_filter_enable?$("#core_datacasts_filter").show():$("#core_datacasts_filter").hide()},v=function(){$("#filter_show").hide()},w=function(){n="existing_data",r=""},y=function(t){$("#filter_show").show(),unique_filter_html=renderFilter(i,t,"filter_show"),$("#filter_show").html(unique_filter_html),$("#filter_show").unbind("change"),$("#filter_show").change(function(){n="existing_data",u.call(e)})},C=function(){$("#core_viz_name").change(function(){b()})},b=function(){$("#core_viz_name").val().length>0&&$("#core_datacasts option:selected").index()>0&&"undefined"!=typeof e.dataset?$("#core_viz_submit").prop("disabled",!1):$("#core_viz_submit").prop("disabled",!0)};$("#core_viz_submit").on("click",function(o){$("#core_viz_core_datacast_identifier").val($("#core_datacasts :selected").val()),$("#core_viz_ref_chart_combination_code").val(e.dataset.combination_code),$("#core_viz_filter_column_d_or_m").val(t)}),a()},Rumali.JsonDataPage=function(){$("#embed-code-display").length>0&&embed_url&&(setTimeout(function(){initClipBoard("#copy-link","#embed-code-display")},1e3),$("#embed-code-display").text('<iframe src="'+embed_url+'" height=400 width=575 frameborder="0" scrolling="no"></iframe>'));var e=gon.data_file;"json"==gon.dataformat&&(e=JSON.parse(gon.data_file)),$("#chart_container_display").text(JSON.stringify(e,null,"	")),$("#core_viz_data_format_update").click(function(){var e=$("#data_format_toggle :checked").val()||"csv";$("#core_viz_dataformat").val(e)}),$("#data_format_toggle").on("change",function(){$("#core_viz_data_format_update").trigger("click")})},function(e){"undefined"==typeof e.fn.each2&&e.extend(e.fn,{each2:function(t){for(var o=e([0]),n=-1,i=this.length;++n<i&&(o.context=o[0]=this[n])&&t.call(o[0],n,o)!==!1;);return this}})}(jQuery),function(e,t){function o(t){var o=e(document.createTextNode(""));t.before(o),o.before(t),o.remove()}function n(e){function t(e){return B[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function i(e,t){for(var o=0,n=t.length;n>o;o+=1)if(s(e,t[o]))return o;return-1}function r(){var t=e(W);t.appendTo(document.body);var o={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),o}function s(e,o){return e===o?!0:e===t||o===t?!1:null===e||null===o?!1:e.constructor===String?e+""==o+"":o.constructor===String?o+""==e+"":!1}function a(e,t,o){var n,i,r;if(null===e||e.length<1)return[];for(n=e.split(t),i=0,r=n.length;r>i;i+=1)n[i]=o(n[i]);return n}function l(e){return e.outerWidth(!1)-e.width()}function c(o){var n="keyup-change-value";o.on("keydown",function(){e.data(o,n)===t&&e.data(o,n,o.val())}),o.on("keyup",function(){var i=e.data(o,n);i!==t&&o.val()!==i&&(e.removeData(o,n),o.trigger("keyup-change"))})}function h(o){o.on("mousemove",function(o){var n=L;(n===t||n.x!==o.pageX||n.y!==o.pageY)&&e(o.target).trigger("mousemove-filtered",o)})}function u(e,o,n){n=n||t;var i;return function(){var t=arguments;window.clearTimeout(i),i=window.setTimeout(function(){o.apply(n,t)},e)}}function d(e,t){var o=u(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){i(e.target,t.get())>=0&&o(e)})}function f(e){e[0]!==document.activeElement&&window.setTimeout(function(){var t,o=e[0],n=e.val().length;e.focus();var i=o.offsetWidth>0||o.offsetHeight>0;i&&o===document.activeElement&&(o.setSelectionRange?o.setSelectionRange(n,n):o.createTextRange&&(t=o.createTextRange(),t.collapse(!1),t.select()))},0)}function p(t){t=e(t)[0];var o=0,n=0;if("selectionStart"in t)o=t.selectionStart,n=t.selectionEnd-o;else if("selection"in document){t.focus();var i=document.selection.createRange();n=document.selection.createRange().text.length,i.moveStart("character",-t.value.length),o=i.text.length-n}return{offset:o,length:n}}function m(e){e.preventDefault(),e.stopPropagation()}function g(e){e.preventDefault(),e.stopImmediatePropagation()}function v(t){if(!N){var o=t[0].currentStyle||window.getComputedStyle(t[0],null);N=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:o.fontSize,fontFamily:o.fontFamily,fontStyle:o.fontStyle,fontWeight:o.fontWeight,letterSpacing:o.letterSpacing,textTransform:o.textTransform,whiteSpace:"nowrap"}),N.attr("class","select2-sizer"),e(document.body).append(N)}return N.text(t.val()),N.width()}function w(t,o,n){var i,r,s=[];i=e.trim(t.attr("class")),i&&(i=""+i,e(i.split(/\s+/)).each2(function(){0===this.indexOf("select2-")&&s.push(this)})),i=e.trim(o.attr("class")),i&&(i=""+i,e(i.split(/\s+/)).each2(function(){0!==this.indexOf("select2-")&&(r=n(this),r&&s.push(r))})),t.attr("class",s.join(" "))}function y(e,t,o,i){var r=n(e.toUpperCase()).indexOf(n(t.toUpperCase())),s=t.length;return 0>r?void o.push(i(e)):(o.push(i(e.substring(0,r))),o.push("<span class='select2-match'>"),o.push(i(e.substring(r,r+s))),o.push("</span>"),void o.push(i(e.substring(r+s,e.length))))}function C(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function b(o){var n,i=null,r=o.quietMillis||100,s=o.url,a=this;return function(l){window.clearTimeout(n),n=window.setTimeout(function(){var n=o.data,r=s,c=o.transport||e.fn.select2.ajaxDefaults.transport,h={type:o.type||"GET",cache:o.cache||!1,jsonpCallback:o.jsonpCallback||t,dataType:o.dataType||"json"},u=e.extend({},e.fn.select2.ajaxDefaults.params,h);n=n?n.call(a,l.term,l.page,l.context):null,r="function"==typeof r?r.call(a,l.term,l.page,l.context):r,i&&"function"==typeof i.abort&&i.abort(),
o.params&&(e.isFunction(o.params)?e.extend(u,o.params.call(a)):e.extend(u,o.params)),e.extend(u,{url:r,dataType:o.dataType,data:n,success:function(e){var t=o.results(e,l.page,l);l.callback(t)},error:function(e,t,o){var n={hasError:!0,jqXHR:e,textStatus:t,errorThrown:o};l.callback(n)}}),i=c.call(a,u)},r)}}function _(t){var o,n,i=t,r=function(e){return""+e.text};e.isArray(i)&&(n=i,i={results:n}),e.isFunction(i)===!1&&(n=i,i=function(){return n});var s=i();return s.text&&(r=s.text,e.isFunction(r)||(o=s.text,r=function(e){return e[o]})),function(t){var o,n=t.term,s={results:[]};return""===n?void t.callback(i()):(o=function(i,s){var a,l;if(i=i[0],i.children){a={};for(l in i)i.hasOwnProperty(l)&&(a[l]=i[l]);a.children=[],e(i.children).each2(function(e,t){o(t,a.children)}),(a.children.length||t.matcher(n,r(a),i))&&s.push(a)}else t.matcher(n,r(i),i)&&s.push(i)},e(i().results).each2(function(e,t){o(t,s.results)}),void t.callback(s))}}function R(o){var n=e.isFunction(o);return function(i){var r=i.term,s={results:[]},a=n?o(i):o;e.isArray(a)&&(e(a).each(function(){var e=this.text!==t,o=e?this.text:this;(""===r||i.matcher(r,o))&&s.results.push(e?this:{id:this,text:this})}),i.callback(s))}}function S(t,o){if(e.isFunction(t))return!0;if(!t)return!1;if("string"==typeof t)return!0;throw new Error(o+" must be a string, function, or falsy value")}function E(t,o){if(e.isFunction(t)){var n=Array.prototype.slice.call(arguments,2);return t.apply(o,n)}return t}function T(t){var o=0;return e.each(t,function(e,t){t.children?o+=T(t.children):o++}),o}function k(e,o,n,i){var r,a,l,c,h,u=e,d=!1;if(!i.createSearchChoice||!i.tokenSeparators||i.tokenSeparators.length<1)return t;for(;;){for(a=-1,l=0,c=i.tokenSeparators.length;c>l&&(h=i.tokenSeparators[l],a=e.indexOf(h),!(a>=0));l++);if(0>a)break;if(r=e.substring(0,a),e=e.substring(a+h.length),r.length>0&&(r=i.createSearchChoice.call(this,r,o),r!==t&&null!==r&&i.id(r)!==t&&null!==i.id(r))){for(d=!1,l=0,c=o.length;c>l;l++)if(s(i.id(r),i.id(o[l]))){d=!0;break}d||n(r)}}return u!==e?e:void 0}function x(){var t=this;e.each(arguments,function(e,o){t[o].remove(),t[o]=null})}function D(t,o){var n=function(){};return n.prototype=new t,n.prototype.constructor=n,n.prototype.parent=t.prototype,n.prototype=e.extend(n.prototype,o),n}if(window.Select2===t){var A,O,H,P,N,I,M,L={x:0,y:0},$={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case $.LEFT:case $.RIGHT:case $.UP:case $.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case $.SHIFT:case $.CTRL:case $.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&123>=e}},W="<div class='select2-measure-scrollbar'></div>",B={"\u24b6":"A","\uff21":"A","\xc0":"A","\xc1":"A","\xc2":"A","\u1ea6":"A","\u1ea4":"A","\u1eaa":"A","\u1ea8":"A","\xc3":"A","\u0100":"A","\u0102":"A","\u1eb0":"A","\u1eae":"A","\u1eb4":"A","\u1eb2":"A","\u0226":"A","\u01e0":"A","\xc4":"A","\u01de":"A","\u1ea2":"A","\xc5":"A","\u01fa":"A","\u01cd":"A","\u0200":"A","\u0202":"A","\u1ea0":"A","\u1eac":"A","\u1eb6":"A","\u1e00":"A","\u0104":"A","\u023a":"A","\u2c6f":"A","\ua732":"AA","\xc6":"AE","\u01fc":"AE","\u01e2":"AE","\ua734":"AO","\ua736":"AU","\ua738":"AV","\ua73a":"AV","\ua73c":"AY","\u24b7":"B","\uff22":"B","\u1e02":"B","\u1e04":"B","\u1e06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24b8":"C","\uff23":"C","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\xc7":"C","\u1e08":"C","\u0187":"C","\u023b":"C","\ua73e":"C","\u24b9":"D","\uff24":"D","\u1e0a":"D","\u010e":"D","\u1e0c":"D","\u1e10":"D","\u1e12":"D","\u1e0e":"D","\u0110":"D","\u018b":"D","\u018a":"D","\u0189":"D","\ua779":"D","\u01f1":"DZ","\u01c4":"DZ","\u01f2":"Dz","\u01c5":"Dz","\u24ba":"E","\uff25":"E","\xc8":"E","\xc9":"E","\xca":"E","\u1ec0":"E","\u1ebe":"E","\u1ec4":"E","\u1ec2":"E","\u1ebc":"E","\u0112":"E","\u1e14":"E","\u1e16":"E","\u0114":"E","\u0116":"E","\xcb":"E","\u1eba":"E","\u011a":"E","\u0204":"E","\u0206":"E","\u1eb8":"E","\u1ec6":"E","\u0228":"E","\u1e1c":"E","\u0118":"E","\u1e18":"E","\u1e1a":"E","\u0190":"E","\u018e":"E","\u24bb":"F","\uff26":"F","\u1e1e":"F","\u0191":"F","\ua77b":"F","\u24bc":"G","\uff27":"G","\u01f4":"G","\u011c":"G","\u1e20":"G","\u011e":"G","\u0120":"G","\u01e6":"G","\u0122":"G","\u01e4":"G","\u0193":"G","\ua7a0":"G","\ua77d":"G","\ua77e":"G","\u24bd":"H","\uff28":"H","\u0124":"H","\u1e22":"H","\u1e26":"H","\u021e":"H","\u1e24":"H","\u1e28":"H","\u1e2a":"H","\u0126":"H","\u2c67":"H","\u2c75":"H","\ua78d":"H","\u24be":"I","\uff29":"I","\xcc":"I","\xcd":"I","\xce":"I","\u0128":"I","\u012a":"I","\u012c":"I","\u0130":"I","\xcf":"I","\u1e2e":"I","\u1ec8":"I","\u01cf":"I","\u0208":"I","\u020a":"I","\u1eca":"I","\u012e":"I","\u1e2c":"I","\u0197":"I","\u24bf":"J","\uff2a":"J","\u0134":"J","\u0248":"J","\u24c0":"K","\uff2b":"K","\u1e30":"K","\u01e8":"K","\u1e32":"K","\u0136":"K","\u1e34":"K","\u0198":"K","\u2c69":"K","\ua740":"K","\ua742":"K","\ua744":"K","\ua7a2":"K","\u24c1":"L","\uff2c":"L","\u013f":"L","\u0139":"L","\u013d":"L","\u1e36":"L","\u1e38":"L","\u013b":"L","\u1e3c":"L","\u1e3a":"L","\u0141":"L","\u023d":"L","\u2c62":"L","\u2c60":"L","\ua748":"L","\ua746":"L","\ua780":"L","\u01c7":"LJ","\u01c8":"Lj","\u24c2":"M","\uff2d":"M","\u1e3e":"M","\u1e40":"M","\u1e42":"M","\u2c6e":"M","\u019c":"M","\u24c3":"N","\uff2e":"N","\u01f8":"N","\u0143":"N","\xd1":"N","\u1e44":"N","\u0147":"N","\u1e46":"N","\u0145":"N","\u1e4a":"N","\u1e48":"N","\u0220":"N","\u019d":"N","\ua790":"N","\ua7a4":"N","\u01ca":"NJ","\u01cb":"Nj","\u24c4":"O","\uff2f":"O","\xd2":"O","\xd3":"O","\xd4":"O","\u1ed2":"O","\u1ed0":"O","\u1ed6":"O","\u1ed4":"O","\xd5":"O","\u1e4c":"O","\u022c":"O","\u1e4e":"O","\u014c":"O","\u1e50":"O","\u1e52":"O","\u014e":"O","\u022e":"O","\u0230":"O","\xd6":"O","\u022a":"O","\u1ece":"O","\u0150":"O","\u01d1":"O","\u020c":"O","\u020e":"O","\u01a0":"O","\u1edc":"O","\u1eda":"O","\u1ee0":"O","\u1ede":"O","\u1ee2":"O","\u1ecc":"O","\u1ed8":"O","\u01ea":"O","\u01ec":"O","\xd8":"O","\u01fe":"O","\u0186":"O","\u019f":"O","\ua74a":"O","\ua74c":"O","\u01a2":"OI","\ua74e":"OO","\u0222":"OU","\u24c5":"P","\uff30":"P","\u1e54":"P","\u1e56":"P","\u01a4":"P","\u2c63":"P","\ua750":"P","\ua752":"P","\ua754":"P","\u24c6":"Q","\uff31":"Q","\ua756":"Q","\ua758":"Q","\u024a":"Q","\u24c7":"R","\uff32":"R","\u0154":"R","\u1e58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1e5a":"R","\u1e5c":"R","\u0156":"R","\u1e5e":"R","\u024c":"R","\u2c64":"R","\ua75a":"R","\ua7a6":"R","\ua782":"R","\u24c8":"S","\uff33":"S","\u1e9e":"S","\u015a":"S","\u1e64":"S","\u015c":"S","\u1e60":"S","\u0160":"S","\u1e66":"S","\u1e62":"S","\u1e68":"S","\u0218":"S","\u015e":"S","\u2c7e":"S","\ua7a8":"S","\ua784":"S","\u24c9":"T","\uff34":"T","\u1e6a":"T","\u0164":"T","\u1e6c":"T","\u021a":"T","\u0162":"T","\u1e70":"T","\u1e6e":"T","\u0166":"T","\u01ac":"T","\u01ae":"T","\u023e":"T","\ua786":"T","\ua728":"TZ","\u24ca":"U","\uff35":"U","\xd9":"U","\xda":"U","\xdb":"U","\u0168":"U","\u1e78":"U","\u016a":"U","\u1e7a":"U","\u016c":"U","\xdc":"U","\u01db":"U","\u01d7":"U","\u01d5":"U","\u01d9":"U","\u1ee6":"U","\u016e":"U","\u0170":"U","\u01d3":"U","\u0214":"U","\u0216":"U","\u01af":"U","\u1eea":"U","\u1ee8":"U","\u1eee":"U","\u1eec":"U","\u1ef0":"U","\u1ee4":"U","\u1e72":"U","\u0172":"U","\u1e76":"U","\u1e74":"U","\u0244":"U","\u24cb":"V","\uff36":"V","\u1e7c":"V","\u1e7e":"V","\u01b2":"V","\ua75e":"V","\u0245":"V","\ua760":"VY","\u24cc":"W","\uff37":"W","\u1e80":"W","\u1e82":"W","\u0174":"W","\u1e86":"W","\u1e84":"W","\u1e88":"W","\u2c72":"W","\u24cd":"X","\uff38":"X","\u1e8a":"X","\u1e8c":"X","\u24ce":"Y","\uff39":"Y","\u1ef2":"Y","\xdd":"Y","\u0176":"Y","\u1ef8":"Y","\u0232":"Y","\u1e8e":"Y","\u0178":"Y","\u1ef6":"Y","\u1ef4":"Y","\u01b3":"Y","\u024e":"Y","\u1efe":"Y","\u24cf":"Z","\uff3a":"Z","\u0179":"Z","\u1e90":"Z","\u017b":"Z","\u017d":"Z","\u1e92":"Z","\u1e94":"Z","\u01b5":"Z","\u0224":"Z","\u2c7f":"Z","\u2c6b":"Z","\ua762":"Z","\u24d0":"a","\uff41":"a","\u1e9a":"a","\xe0":"a","\xe1":"a","\xe2":"a","\u1ea7":"a","\u1ea5":"a","\u1eab":"a","\u1ea9":"a","\xe3":"a","\u0101":"a","\u0103":"a","\u1eb1":"a","\u1eaf":"a","\u1eb5":"a","\u1eb3":"a","\u0227":"a","\u01e1":"a","\xe4":"a","\u01df":"a","\u1ea3":"a","\xe5":"a","\u01fb":"a","\u01ce":"a","\u0201":"a","\u0203":"a","\u1ea1":"a","\u1ead":"a","\u1eb7":"a","\u1e01":"a","\u0105":"a","\u2c65":"a","\u0250":"a","\ua733":"aa","\xe6":"ae","\u01fd":"ae","\u01e3":"ae","\ua735":"ao","\ua737":"au","\ua739":"av","\ua73b":"av","\ua73d":"ay","\u24d1":"b","\uff42":"b","\u1e03":"b","\u1e05":"b","\u1e07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24d2":"c","\uff43":"c","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\xe7":"c","\u1e09":"c","\u0188":"c","\u023c":"c","\ua73f":"c","\u2184":"c","\u24d3":"d","\uff44":"d","\u1e0b":"d","\u010f":"d","\u1e0d":"d","\u1e11":"d","\u1e13":"d","\u1e0f":"d","\u0111":"d","\u018c":"d","\u0256":"d","\u0257":"d","\ua77a":"d","\u01f3":"dz","\u01c6":"dz","\u24d4":"e","\uff45":"e","\xe8":"e","\xe9":"e","\xea":"e","\u1ec1":"e","\u1ebf":"e","\u1ec5":"e","\u1ec3":"e","\u1ebd":"e","\u0113":"e","\u1e15":"e","\u1e17":"e","\u0115":"e","\u0117":"e","\xeb":"e","\u1ebb":"e","\u011b":"e","\u0205":"e","\u0207":"e","\u1eb9":"e","\u1ec7":"e","\u0229":"e","\u1e1d":"e","\u0119":"e","\u1e19":"e","\u1e1b":"e","\u0247":"e","\u025b":"e","\u01dd":"e","\u24d5":"f","\uff46":"f","\u1e1f":"f","\u0192":"f","\ua77c":"f","\u24d6":"g","\uff47":"g","\u01f5":"g","\u011d":"g","\u1e21":"g","\u011f":"g","\u0121":"g","\u01e7":"g","\u0123":"g","\u01e5":"g","\u0260":"g","\ua7a1":"g","\u1d79":"g","\ua77f":"g","\u24d7":"h","\uff48":"h","\u0125":"h","\u1e23":"h","\u1e27":"h","\u021f":"h","\u1e25":"h","\u1e29":"h","\u1e2b":"h","\u1e96":"h","\u0127":"h","\u2c68":"h","\u2c76":"h","\u0265":"h","\u0195":"hv","\u24d8":"i","\uff49":"i","\xec":"i","\xed":"i","\xee":"i","\u0129":"i","\u012b":"i","\u012d":"i","\xef":"i","\u1e2f":"i","\u1ec9":"i","\u01d0":"i","\u0209":"i","\u020b":"i","\u1ecb":"i","\u012f":"i","\u1e2d":"i","\u0268":"i","\u0131":"i","\u24d9":"j","\uff4a":"j","\u0135":"j","\u01f0":"j","\u0249":"j","\u24da":"k","\uff4b":"k","\u1e31":"k","\u01e9":"k","\u1e33":"k","\u0137":"k","\u1e35":"k","\u0199":"k","\u2c6a":"k","\ua741":"k","\ua743":"k","\ua745":"k","\ua7a3":"k","\u24db":"l","\uff4c":"l","\u0140":"l","\u013a":"l","\u013e":"l","\u1e37":"l","\u1e39":"l","\u013c":"l","\u1e3d":"l","\u1e3b":"l","\u017f":"l","\u0142":"l","\u019a":"l","\u026b":"l","\u2c61":"l","\ua749":"l","\ua781":"l","\ua747":"l","\u01c9":"lj","\u24dc":"m","\uff4d":"m","\u1e3f":"m","\u1e41":"m","\u1e43":"m","\u0271":"m","\u026f":"m","\u24dd":"n","\uff4e":"n","\u01f9":"n","\u0144":"n","\xf1":"n","\u1e45":"n","\u0148":"n","\u1e47":"n","\u0146":"n","\u1e4b":"n","\u1e49":"n","\u019e":"n","\u0272":"n","\u0149":"n","\ua791":"n","\ua7a5":"n","\u01cc":"nj","\u24de":"o","\uff4f":"o","\xf2":"o","\xf3":"o","\xf4":"o","\u1ed3":"o","\u1ed1":"o","\u1ed7":"o","\u1ed5":"o","\xf5":"o","\u1e4d":"o","\u022d":"o","\u1e4f":"o","\u014d":"o","\u1e51":"o","\u1e53":"o","\u014f":"o","\u022f":"o","\u0231":"o","\xf6":"o","\u022b":"o","\u1ecf":"o","\u0151":"o","\u01d2":"o","\u020d":"o","\u020f":"o","\u01a1":"o","\u1edd":"o","\u1edb":"o","\u1ee1":"o","\u1edf":"o","\u1ee3":"o","\u1ecd":"o","\u1ed9":"o","\u01eb":"o","\u01ed":"o","\xf8":"o","\u01ff":"o","\u0254":"o","\ua74b":"o","\ua74d":"o","\u0275":"o","\u01a3":"oi","\u0223":"ou","\ua74f":"oo","\u24df":"p","\uff50":"p","\u1e55":"p","\u1e57":"p","\u01a5":"p","\u1d7d":"p","\ua751":"p","\ua753":"p","\ua755":"p","\u24e0":"q","\uff51":"q","\u024b":"q","\ua757":"q","\ua759":"q","\u24e1":"r","\uff52":"r","\u0155":"r","\u1e59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1e5b":"r","\u1e5d":"r","\u0157":"r","\u1e5f":"r","\u024d":"r","\u027d":"r","\ua75b":"r","\ua7a7":"r","\ua783":"r","\u24e2":"s","\uff53":"s","\xdf":"s","\u015b":"s","\u1e65":"s","\u015d":"s","\u1e61":"s","\u0161":"s","\u1e67":"s","\u1e63":"s","\u1e69":"s","\u0219":"s","\u015f":"s","\u023f":"s","\ua7a9":"s","\ua785":"s","\u1e9b":"s","\u24e3":"t","\uff54":"t","\u1e6b":"t","\u1e97":"t","\u0165":"t","\u1e6d":"t","\u021b":"t","\u0163":"t","\u1e71":"t","\u1e6f":"t","\u0167":"t","\u01ad":"t","\u0288":"t","\u2c66":"t","\ua787":"t","\ua729":"tz","\u24e4":"u","\uff55":"u","\xf9":"u","\xfa":"u","\xfb":"u","\u0169":"u","\u1e79":"u","\u016b":"u","\u1e7b":"u","\u016d":"u","\xfc":"u","\u01dc":"u","\u01d8":"u","\u01d6":"u","\u01da":"u","\u1ee7":"u","\u016f":"u","\u0171":"u","\u01d4":"u","\u0215":"u","\u0217":"u","\u01b0":"u","\u1eeb":"u","\u1ee9":"u","\u1eef":"u","\u1eed":"u","\u1ef1":"u","\u1ee5":"u","\u1e73":"u","\u0173":"u","\u1e77":"u","\u1e75":"u","\u0289":"u","\u24e5":"v","\uff56":"v","\u1e7d":"v","\u1e7f":"v","\u028b":"v","\ua75f":"v","\u028c":"v","\ua761":"vy","\u24e6":"w","\uff57":"w","\u1e81":"w","\u1e83":"w","\u0175":"w","\u1e87":"w","\u1e85":"w","\u1e98":"w","\u1e89":"w","\u2c73":"w","\u24e7":"x","\uff58":"x","\u1e8b":"x","\u1e8d":"x","\u24e8":"y","\uff59":"y","\u1ef3":"y","\xfd":"y","\u0177":"y","\u1ef9":"y","\u0233":"y","\u1e8f":"y","\xff":"y","\u1ef7":"y","\u1e99":"y","\u1ef5":"y","\u01b4":"y","\u024f":"y","\u1eff":"y","\u24e9":"z","\uff5a":"z","\u017a":"z","\u1e91":"z","\u017c":"z","\u017e":"z","\u1e93":"z","\u1e95":"z","\u01b6":"z","\u0225":"z","\u0240":"z","\u2c6c":"z","\ua763":"z","\u0386":"\u0391","\u0388":"\u0395","\u0389":"\u0397","\u038a":"\u0399","\u03aa":"\u0399","\u038c":"\u039f","\u038e":"\u03a5","\u03ab":"\u03a5","\u038f":"\u03a9","\u03ac":"\u03b1","\u03ad":"\u03b5","\u03ae":"\u03b7","\u03af":"\u03b9","\u03ca":"\u03b9","\u0390":"\u03b9","\u03cc":"\u03bf","\u03cd":"\u03c5","\u03cb":"\u03c5","\u03b0":"\u03c5","\u03c9":"\u03c9","\u03c2":"\u03c3"};I=e(document),P=function(){var e=1;return function(){return e++}}(),A=D(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(o){var n,i,s=".select2-results";this.opts=o=this.prepareOpts(o),this.id=o.id,o.element.data("select2")!==t&&null!==o.element.data("select2")&&o.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=e(".select2-hidden-accessible"),0==this.liveRegion.length&&(this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body)),this.containerId="s2id_"+(o.element.attr("id")||"autogen"+P()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",o.element.attr("title")),this.body=e(document.body),w(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",o.element.attr("style")),this.container.css(E(o.containerCss,this.opts.element)),this.container.addClass(E(o.containerCssClass,this.opts.element)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",m),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),w(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(E(o.dropdownCssClass,this.opts.element)),this.dropdown.data("select2",this),this.dropdown.on("click",m),this.results=n=this.container.find(s),this.search=i=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",m),h(this.results),this.dropdown.on("mousemove-filtered",s,this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",s,this.bind(function(e){this._touchEvent=!0,this.highlightUnderEvent(e)})),this.dropdown.on("touchmove",s,this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",s,this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind(function(e){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())})),d(80,this.results),this.dropdown.on("scroll-debounced",s,this.bind(this.loadMoreIfNeeded)),e(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),e(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),e.fn.mousewheel&&n.mousewheel(function(e,t,o,i){var r=n.scrollTop();i>0&&0>=r-i?(n.scrollTop(0),m(e)):0>i&&n.get(0).scrollHeight-n.scrollTop()+i<=n.height()&&(n.scrollTop(n.get(0).scrollHeight-n.height()),m(e))}),c(i),i.on("keyup-change input paste",this.bind(this.updateResults)),i.on("focus",function(){i.addClass("select2-focused")}),i.on("blur",function(){i.removeClass("select2-focused")}),this.dropdown.on("mouseup",s,this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",function(e){e.stopPropagation()}),this.lastSearchTerm=t,e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==o.maximumInputLength&&this.search.attr("maxlength",o.maximumInputLength);var a=o.element.prop("disabled");a===t&&(a=!1),this.enable(!a);var l=o.element.prop("readonly");l===t&&(l=!1),this.readonly(l),M=M||r(),this.autofocus=o.element.prop("autofocus"),o.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",o.searchInputPlaceholder)},destroy:function(){var e=this.opts.element,o=e.data("select2"),n=this;this.close(),e.length&&e[0].detachEvent&&n._sync&&e.each(function(){n._sync&&this.detachEvent("onpropertychange",n._sync)}),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),this._sync=null,o!==t&&(o.container.remove(),o.liveRegion.remove(),o.dropdown.remove(),e.removeData("select2").off("select2"),e.is("input[type='hidden']")?e.css("display",""):(e.show().prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show())),x.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(e){return e.is("option")?{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:s(e.attr("locked"),"locked")||s(e.data("locked"),!0)}:e.is("optgroup")?{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}:void 0},prepareOpts:function(o){var n,i,r,l,c=this;if(n=o.element,"select"===n.get(0).tagName.toLowerCase()&&(this.select=i=o.element),i&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in o)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),o=e.extend({},{populateResults:function(n,i,r){var s,a=this.opts.id,l=this.liveRegion;(s=function(n,i,h){var u,d,f,p,m,g,v,w,y,C;n=o.sortResults(n,i,r);var b=[];for(u=0,d=n.length;d>u;u+=1)f=n[u],m=f.disabled===!0,p=!m&&a(f)!==t,g=f.children&&f.children.length>0,v=e("<li></li>"),v.addClass("select2-results-dept-"+h),v.addClass("select2-result"),v.addClass(p?"select2-result-selectable":"select2-result-unselectable"),m&&v.addClass("select2-disabled"),g&&v.addClass("select2-result-with-children"),v.addClass(c.opts.formatResultCssClass(f)),v.attr("role","presentation"),w=e(document.createElement("div")),w.addClass("select2-result-label"),w.attr("id","select2-result-label-"+P()),w.attr("role","option"),C=o.formatResult(f,w,r,c.opts.escapeMarkup),C!==t&&(w.html(C),v.append(w)),g&&(y=e("<ul></ul>"),y.addClass("select2-result-sub"),s(f.children,y,h+1),v.append(y)),v.data("select2-data",f),b.push(v[0]);i.append(b),l.text(o.formatMatches(n.length))})(i,n,0)}},e.fn.select2.defaults,o),"function"!=typeof o.id&&(r=o.id,o.id=function(e){return e[r]}),e.isArray(o.element.data("select2Tags"))){if("tags"in o)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+o.element.attr("id");o.tags=o.element.data("select2Tags")}if(i?(o.query=this.bind(function(e){var o,i,r,s={results:[],more:!1},a=e.term;r=function(t,o){var n;t.is("option")?e.matcher(a,t.text(),t)&&o.push(c.optionToData(t)):t.is("optgroup")&&(n=c.optionToData(t),t.children().each2(function(e,t){r(t,n.children)}),n.children.length>0&&o.push(n))},o=n.children(),this.getPlaceholder()!==t&&o.length>0&&(i=this.getPlaceholderOption(),i&&(o=o.not(i))),o.each2(function(e,t){r(t,s.results)}),e.callback(s)}),o.id=function(e){return e.id}):"query"in o||("ajax"in o?(l=o.element.data("ajax-url"),l&&l.length>0&&(o.ajax.url=l),o.query=b.call(o.element,o.ajax)):"data"in o?o.query=_(o.data):"tags"in o&&(o.query=R(o.tags),o.createSearchChoice===t&&(o.createSearchChoice=function(t){return{id:e.trim(t),text:e.trim(t)}}),o.initSelection===t&&(o.initSelection=function(t,n){var i=[];e(a(t.val(),o.separator,o.transformVal)).each(function(){var t={id:this,text:this},n=o.tags;e.isFunction(n)&&(n=n()),e(n).each(function(){return s(this.id,t.id)?(t=this,!1):void 0}),i.push(t)}),n(i)}))),"function"!=typeof o.query)throw"query function not defined for Select2 "+o.element.attr("id");if("top"===o.createSearchChoicePosition)o.createSearchChoicePosition=function(e,t){e.unshift(t)};else if("bottom"===o.createSearchChoicePosition)o.createSearchChoicePosition=function(e,t){e.push(t)};else if("function"!=typeof o.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return o},monitorSource:function(){var o,n=this.opts.element,i=this;n.on("change.select2",this.bind(function(e){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),this._sync=this.bind(function(){var e=n.prop("disabled");e===t&&(e=!1),this.enable(!e);var o=n.prop("readonly");o===t&&(o=!1),this.readonly(o),this.container&&(w(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(E(this.opts.containerCssClass,this.opts.element))),this.dropdown&&(w(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(E(this.opts.dropdownCssClass,this.opts.element)))}),n.length&&n[0].attachEvent&&n.each(function(){this.attachEvent("onpropertychange",i._sync)}),o=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,o!==t&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new o(function(t){e.each(t,i._sync)}),this.propertyObserver.observe(n.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(t){var o=e.Event("select2-selecting",{val:this.id(t),object:t,choice:t});return this.opts.element.trigger(o),!o.isDefaultPrevented()},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===t&&(e=!0),this._enabled!==e&&(this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(e){e===t&&(e=!1),this._readonly!==e&&(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface())},opened:function(){return this.container?this.container.hasClass("select2-dropdown-open"):!1},positionDropdown:function(){var t,o,n,i,r,s=this.dropdown,a=this.container,l=a.offset(),c=a.outerHeight(!1),h=a.outerWidth(!1),u=s.outerHeight(!1),d=e(window),f=d.width(),p=d.height(),m=d.scrollLeft()+f,g=d.scrollTop()+p,v=l.top+c,w=l.left,y=g>=v+u,C=l.top-u>=d.scrollTop(),b=s.outerWidth(!1),_=function(){return m>=w+b},R=function(){return l.left+m+a.outerWidth(!1)>b},S=s.hasClass("select2-drop-above");S?(o=!0,!C&&y&&(n=!0,o=!1)):(o=!1,!y&&C&&(n=!0,o=!0)),n&&(s.hide(),l=this.container.offset(),c=this.container.outerHeight(!1),h=this.container.outerWidth(!1),u=s.outerHeight(!1),m=d.scrollLeft()+f,g=d.scrollTop()+p,v=l.top+c,w=l.left,b=s.outerWidth(!1),s.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(r=e(".select2-results",s)[0],s.addClass("select2-drop-auto-width"),s.css("width",""),b=s.outerWidth(!1)+(r.scrollHeight===r.clientHeight?0:M.width),b>h?h=b:b=h,u=s.outerHeight(!1)):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body.css("position")&&(t=this.body.offset(),v-=t.top,w-=t.left),!_()&&R()&&(w=l.left+this.container.outerWidth(!1)-b),i={left:w,width:h},o?(this.container.addClass("select2-drop-above"),s.addClass("select2-drop-above"),u=s.outerHeight(!1),i.top=l.top-u,i.bottom="auto"):(i.top=v,i.bottom="auto",this.container.removeClass("select2-drop-above"),s.removeClass("select2-drop-above")),i=e.extend(i,E(this.opts.dropdownCss,this.opts.element)),s.css(i)},shouldOpen:function(){var t;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(t=e.Event("select2-opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),I.on("mousemove.select2Event",function(e){L.x=e.pageX,L.y=e.pageY}),!0):!1},opening:function(){var t,n=this.containerEventName,i="scroll."+n,r="resize."+n,s="orientationchange."+n;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),t=e("#select2-drop-mask"),0===t.length&&(t=e(document.createElement("div")),t.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),t.hide(),t.appendTo(this.body),t.on("mousedown touchstart click",function(n){o(t);var i,r=e("#select2-drop");r.length>0&&(i=r.data("select2"),i.opts.selectOnBlur&&i.selectHighlighted({noFocus:!0}),i.close(),n.preventDefault(),n.stopPropagation())})),this.dropdown.prev()[0]!==t[0]&&this.dropdown.before(t),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),t.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var a=this;this.container.parents().add(window).each(function(){e(this).on(r+" "+i+" "+s,function(e){a.opened()&&a.positionDropdown()})})},close:function(){if(this.opened()){var t=this.containerEventName,o="scroll."+t,n="resize."+t,i="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).off(o).off(n).off(i)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),I.off("mousemove.select2Event"),this.clearSearch(),this.search.removeClass("select2-active"),this.search.removeAttr("aria-activedescendant"),this.opts.element.trigger(e.Event("select2-close"))}},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},prefillNextSearchTerm:function(){if(""!==this.search.val())return!1;var e=this.opts.nextSearchTerm(this.data(),this.lastSearchTerm);return e!==t?(this.search.val(e),this.search.select(),!0):!1},getMaximumSelectionSize:function(){return E(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var t,o,n,i,r,s,a,l,c=this.results;if(o=this.highlight(),!(0>o)){if(0==o)return void c.scrollTop(0);t=this.findHighlightableChoices().find(".select2-result-label"),n=e(t[o]),l=(n.offset()||{}).top||0,i=l+n.outerHeight(!0),o===t.length-1&&(a=c.find("li.select2-more-results"),a.length>0&&(i=a.offset().top+a.outerHeight(!0))),r=c.offset().top+c.outerHeight(!1),i>r&&c.scrollTop(c.scrollTop()+(i-r)),s=l-c.offset().top,0>s&&"none"!=n.css("display")&&c.scrollTop(c.scrollTop()+s)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(t){for(var o=this.findHighlightableChoices(),n=this.highlight();n>-1&&n<o.length;){n+=t;var i=e(o[n]);if(i.hasClass("select2-result-selectable")&&!i.hasClass("select2-disabled")&&!i.hasClass("select2-selected")){this.highlight(n);break}}},highlight:function(t){var o,n,r=this.findHighlightableChoices();return 0===arguments.length?i(r.filter(".select2-highlighted")[0],r.get()):(t>=r.length&&(t=r.length-1),0>t&&(t=0),this.removeHighlight(),o=e(r[t]),o.addClass("select2-highlighted"),this.search.attr("aria-activedescendant",o.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(o.text()),n=o.data("select2-data"),void(n&&this.opts.element.trigger({type:"select2-highlight",val:this.id(n),choice:n})))},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var o=e(t.target).closest(".select2-result-selectable");if(o.length>0&&!o.is(".select2-highlighted")){var n=this.findHighlightableChoices();this.highlight(n.index(o))}else 0==o.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var e,t=this.results,o=t.find("li.select2-more-results"),n=this.resultsPage+1,i=this,r=this.search.val(),s=this.context;0!==o.length&&(e=o.offset().top-t.offset().top-t.height(),e<=this.opts.loadMorePadding&&(o.addClass("select2-active"),this.opts.query({element:this.opts.element,term:r,page:n,context:s,matcher:this.opts.matcher,callback:this.bind(function(e){i.opened()&&(i.opts.populateResults.call(this,t,e.results,{term:r,page:n,context:s}),i.postprocessResults(e,!1,!1),e.more===!0?(o.detach().appendTo(t).html(i.opts.escapeMarkup(E(i.opts.formatLoadMore,i.opts.element,n+1))),window.setTimeout(function(){i.loadMoreIfNeeded()},10)):o.remove(),i.positionDropdown(),i.resultsPage=n,i.context=e.context,this.opts.element.trigger({type:"select2-loaded",items:e}))})})))},tokenize:function(){},updateResults:function(o){function n(){c.removeClass("select2-active"),d.positionDropdown(),h.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?d.liveRegion.text(h.text()):d.liveRegion.text(d.opts.formatMatches(h.find('.select2-result-selectable:not(".select2-selected")').length))}function i(e){h.html(e),n()}var r,a,l,c=this.search,h=this.results,u=this.opts,d=this,f=c.val(),p=e.data(this.container,"select2-last-term");if((o===!0||!p||!s(f,p))&&(e.data(this.container,"select2-last-term",f),o===!0||this.showSearchInput!==!1&&this.opened())){l=++this.queryCount;var m=this.getMaximumSelectionSize();if(m>=1&&(r=this.data(),e.isArray(r)&&r.length>=m&&S(u.formatSelectionTooBig,"formatSelectionTooBig")))return void i("<li class='select2-selection-limit'>"+E(u.formatSelectionTooBig,u.element,m)+"</li>");if(c.val().length<u.minimumInputLength)return i(S(u.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+E(u.formatInputTooShort,u.element,c.val(),u.minimumInputLength)+"</li>":""),void(o&&this.showSearch&&this.showSearch(!0));if(u.maximumInputLength&&c.val().length>u.maximumInputLength)return void i(S(u.formatInputTooLong,"formatInputTooLong")?"<li class='select2-no-results'>"+E(u.formatInputTooLong,u.element,c.val(),u.maximumInputLength)+"</li>":"");u.formatSearching&&0===this.findHighlightableChoices().length&&i("<li class='select2-searching'>"+E(u.formatSearching,u.element)+"</li>"),c.addClass("select2-active"),this.removeHighlight(),a=this.tokenize(),a!=t&&null!=a&&c.val(a),this.resultsPage=1,u.query({element:u.element,term:c.val(),page:this.resultsPage,context:null,matcher:u.matcher,callback:this.bind(function(r){var a;if(l==this.queryCount){if(!this.opened())return void this.search.removeClass("select2-active");if(r.hasError!==t&&S(u.formatAjaxError,"formatAjaxError"))return void i("<li class='select2-ajax-error'>"+E(u.formatAjaxError,u.element,r.jqXHR,r.textStatus,r.errorThrown)+"</li>");if(this.context=r.context===t?null:r.context,this.opts.createSearchChoice&&""!==c.val()&&(a=this.opts.createSearchChoice.call(d,c.val(),r.results),a!==t&&null!==a&&d.id(a)!==t&&null!==d.id(a)&&0===e(r.results).filter(function(){return s(d.id(this),d.id(a))}).length&&this.opts.createSearchChoicePosition(r.results,a)),0===r.results.length&&S(u.formatNoMatches,"formatNoMatches"))return i("<li class='select2-no-results'>"+E(u.formatNoMatches,u.element,c.val())+"</li>"),
void this.showSearch(c.val());h.empty(),d.opts.populateResults.call(this,h,r.results,{term:c.val(),page:this.resultsPage,context:null}),r.more===!0&&S(u.formatLoadMore,"formatLoadMore")&&(h.append("<li class='select2-more-results'>"+u.escapeMarkup(E(u.formatLoadMore,u.element,this.resultsPage))+"</li>"),window.setTimeout(function(){d.loadMoreIfNeeded()},10)),this.postprocessResults(r,o),n(),this.opts.element.trigger({type:"select2-loaded",items:r})}})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){f(this.search)},selectHighlighted:function(e){if(this._touchMoved)return void this.clearTouchMoved();var t=this.highlight(),o=this.results.find(".select2-highlighted"),n=o.closest(".select2-result").data("select2-data");n?(this.highlight(t),this.onSelect(n,e)):e&&e.noFocus&&this.close()},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==t?e.text():t)},getPlaceholderOption:function(){if(this.select){var o=this.select.children("option").first();if(this.opts.placeholderOption!==t)return"first"===this.opts.placeholderOption&&o||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===e.trim(o.text())&&""===o.val())return o}},initContainerWidth:function(){function t(){var t,o,n,i,r,s;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(t=this.opts.element.attr("style"),"string"==typeof t)for(o=t.split(";"),i=0,r=o.length;r>i;i+=1)if(s=o[i].replace(/\s/g,""),n=s.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==n&&n.length>=1)return n[1];return"resolve"===this.opts.width?(t=this.opts.element.css("width"),t.indexOf("%")>0?t:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var o=t.call(this);null!==o&&this.container.css("width",o)}}),O=D(A,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""));return t},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var t,o,n;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),t=this.search.get(0),t.createTextRange?(o=t.createTextRange(),o.collapse(!1),o.select()):t.setSelectionRange&&(n=this.search.val().length,t.setSelectionRange(n,n))),this.prefillNextSearchTerm(),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){e("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),x.call(this,"selection","focusser")},initContainer:function(){var t,n,i=this.container,r=this.dropdown,s=P();this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=t=i.find(".select2-choice"),this.focusser=i.find(".select2-focusser"),t.find(".select2-chosen").attr("id","select2-chosen-"+s),this.focusser.attr("aria-labelledby","select2-chosen-"+s),this.results.attr("id","select2-results-"+s),this.search.attr("aria-owns","select2-results-"+s),this.focusser.attr("id","s2id_autogen"+s),n=e("label[for='"+this.opts.element.attr("id")+"']"),this.opts.element.focus(this.bind(function(){this.focus()})),this.focusser.prev().text(n.text()).attr("for",this.focusser.attr("id"));var a=this.opts.element.attr("title");this.opts.element.attr("title",a||n.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text(e("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&229!=e.keyCode){if(e.which===$.PAGE_UP||e.which===$.PAGE_DOWN)return void m(e);switch(e.which){case $.UP:case $.DOWN:return this.moveHighlight(e.which===$.UP?-1:1),void m(e);case $.ENTER:return this.selectHighlighted(),void m(e);case $.TAB:return void this.selectHighlighted({noFocus:!0});case $.ESC:return this.cancel(e),void m(e)}}})),this.search.on("blur",this.bind(function(e){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==$.TAB&&!$.isControl(e)&&!$.isFunctionKey(e)&&e.which!==$.ESC){if(this.opts.openOnEnter===!1&&e.which===$.ENTER)return void m(e);if(e.which==$.DOWN||e.which==$.UP||e.which==$.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),void m(e)}return e.which==$.DELETE||e.which==$.BACKSPACE?(this.opts.allowClear&&this.clear(),void m(e)):void 0}})),c(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){if(e.stopPropagation(),this.opened())return;this.open()}})),t.on("mousedown touchstart","abbr",this.bind(function(e){this.isInterfaceEnabled()&&(this.clear(),g(e),this.close(),this.selection&&this.selection.focus())})),t.on("mousedown touchstart",this.bind(function(n){o(t),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),m(n)})),r.on("mousedown touchstart",this.bind(function(){this.opts.shouldFocusInput(this)&&this.search.focus()})),t.on("focus",this.bind(function(e){m(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(e.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.hide(),this.setPlaceholder()},clear:function(t){var o=this.selection.data("select2-data");if(o){var n=e.Event("select2-clearing");if(this.opts.element.trigger(n),n.isDefaultPrevented())return;var i=this.getPlaceholderOption();this.opts.element.val(i?i.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),t!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(o),choice:o}),this.triggerChange({removed:o}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(o){o!==t&&null!==o&&(e.updateSelection(o),e.close(),e.setPlaceholder(),e.lastSearchTerm=e.search.val())})}},isPlaceholderOptionSelected:function(){var e;return this.getPlaceholder()===t?!1:(e=this.getPlaceholderOption())!==t&&e.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===t||null===this.opts.element.val()},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),o=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var n=e.find("option").filter(function(){return this.selected&&!this.disabled});t(o.optionToData(n))}:"data"in t&&(t.initSelection=t.initSelection||function(o,n){var i=o.val(),r=null;t.query({matcher:function(e,o,n){var a=s(i,t.id(n));return a&&(r=n),a},callback:e.isFunction(n)?function(){n(r)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===t?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==t){if(this.select&&this.getPlaceholderOption()===t)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,o){var n=0,i=this;if(this.findHighlightableChoices().each2(function(e,t){return s(i.id(t.data("select2-data")),i.opts.element.val())?(n=e,!1):void 0}),o!==!1&&(t===!0&&n>=0?this.highlight(n):this.highlight(0)),t===!0){var r=this.opts.minimumResultsForSearch;r>=0&&this.showSearch(T(e.results)>=r)}},showSearch:function(t){this.showSearchInput!==t&&(this.showSearchInput=t,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!t),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!t),e(this.dropdown,this.container).toggleClass("select2-with-searchbox",t))},onSelect:function(e,t){if(this.triggerSelect(e)){var o=this.opts.element.val(),n=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.lastSearchTerm=this.search.val(),this.close(),t&&t.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),s(o,this.id(e))||this.triggerChange({added:e,removed:n})}},updateSelection:function(e){var o,n,i=this.selection.find(".select2-chosen");this.selection.data("select2-data",e),i.empty(),null!==e&&(o=this.opts.formatSelection(e,i,this.opts.escapeMarkup)),o!==t&&i.append(o),n=this.opts.formatSelectionCssClass(e,i),n!==t&&i.addClass(n),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.container.addClass("select2-allowclear")},val:function(){var e,o=!1,n=null,i=this,r=this.data();if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],arguments.length>1&&(o=arguments[1]),this.select)this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){return n=i.optionToData(t),!1}),this.updateSelection(n),this.setPlaceholder(),o&&this.triggerChange({added:n,removed:r});else{if(!e&&0!==e)return void this.clear(o);if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(e?i.id(e):""),i.updateSelection(e),i.setPlaceholder(),o&&i.triggerChange({added:e,removed:r})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var o,n=!1;return 0===arguments.length?(o=this.selection.data("select2-data"),o==t&&(o=null),o):(arguments.length>1&&(n=arguments[1]),void(e?(o=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),n&&this.triggerChange({added:e,removed:o})):this.clear(n)))}}),H=D(A,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),o=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var n=[];e.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(e,t){n.push(o.optionToData(t))}),t(n)}:"data"in t&&(t.initSelection=t.initSelection||function(o,n){var i=a(o.val(),t.separator,t.transformVal),r=[];t.query({matcher:function(o,n,a){var l=e.grep(i,function(e){return s(e,t.id(a))}).length;return l&&r.push(a),l},callback:e.isFunction(n)?function(){for(var e=[],o=0;o<i.length;o++)for(var a=i[o],l=0;l<r.length;l++){var c=r[l];if(s(a,t.id(c))){e.push(c),r.splice(l,1);break}}n(e)}:e.noop})}),t},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e)))},destroy:function(){e("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),x.call(this,"searchContainer","selection")},initContainer:function(){var t,o=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(o);var n=this;this.selection.on("click",".select2-container:not(.select2-container-disabled) .select2-search-choice:not(.select2-locked)",function(t){n.search[0].focus(),n.selectChoice(e(this))}),this.search.attr("id","s2id_autogen"+P()),this.search.prev().text(e("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.opts.element.focus(this.bind(function(){this.focus()})),this.search.on("input paste",this.bind(function(){this.search.attr("placeholder")&&0==this.search.val().length||this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var o=t.find(".select2-search-choice-focus"),n=o.prev(".select2-search-choice:not(.select2-locked)"),i=o.next(".select2-search-choice:not(.select2-locked)"),r=p(this.search);if(o.length&&(e.which==$.LEFT||e.which==$.RIGHT||e.which==$.BACKSPACE||e.which==$.DELETE||e.which==$.ENTER)){var s=o;return e.which==$.LEFT&&n.length?s=n:e.which==$.RIGHT?s=i.length?i:null:e.which===$.BACKSPACE?this.unselect(o.first())&&(this.search.width(10),s=n.length?n:i):e.which==$.DELETE?this.unselect(o.first())&&(this.search.width(10),s=i.length?i:null):e.which==$.ENTER&&(s=null),this.selectChoice(s),m(e),void(s&&s.length||this.open())}if((e.which===$.BACKSPACE&&1==this.keydowns||e.which==$.LEFT)&&0==r.offset&&!r.length)return this.selectChoice(t.find(".select2-search-choice:not(.select2-locked)").last()),void m(e);if(this.selectChoice(null),this.opened())switch(e.which){case $.UP:case $.DOWN:return this.moveHighlight(e.which===$.UP?-1:1),void m(e);case $.ENTER:return this.selectHighlighted(),void m(e);case $.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case $.ESC:return this.cancel(e),void m(e)}if(e.which!==$.TAB&&!$.isControl(e)&&!$.isFunctionKey(e)&&e.which!==$.BACKSPACE&&e.which!==$.ESC){if(e.which===$.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===$.PAGE_UP||e.which===$.PAGE_DOWN)&&m(e),e.which===$.ENTER&&m(e)}}})),this.search.on("keyup",this.bind(function(e){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(t){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),t.stopImmediatePropagation(),this.opts.element.trigger(e.Event("select2-blur"))})),this.container.on("click",o,this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.on("focus",o,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.hide(),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(o){o!==t&&null!==o&&(e.updateSelection(o),e.close(),e.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder(),o=this.getMaxSearchWidth();e!==t&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.search.width(o>0?o:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.prefillNextSearchTerm(),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var o={},n=[],i=this;e(t).each(function(){i.id(this)in o||(o[i.id(this)]=0,n.push(this))}),this.selection.find(".select2-search-choice").remove(),this.addSelectedChoice(n),i.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts),null!=e&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){this.triggerSelect(e)&&""!==e.text&&(this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.lastSearchTerm=this.search.val(),this.clearSearch(),this.updateResults(),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(e,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.prefillNextSearchTerm()&&this.updateResults(),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),t&&t.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(t){var o=this.getVal(),n=this;e(t).each(function(){o.push(n.createChoice(this))}),this.setVal(o)},createChoice:function(o){var n,i,r=!o.locked,s=e("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),a=e("<li class='select2-search-choice select2-locked'><div></div></li>"),l=r?s:a,c=this.id(o);return n=this.opts.formatSelection(o,l.find("div"),this.opts.escapeMarkup),n!=t&&l.find("div").replaceWith(e("<div></div>").html(n)),i=this.opts.formatSelectionCssClass(o,l.find("div")),i!=t&&l.addClass(i),r&&l.find(".select2-search-choice-close").on("mousedown",m).on("click dblclick",this.bind(function(t){this.isInterfaceEnabled()&&(this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),m(t),this.close(),this.focusSearch())})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),l.data("select2-data",o),l.insertBefore(this.searchContainer),c},unselect:function(t){var o,n,r=this.getVal();if(t=t.closest(".select2-search-choice"),0===t.length)throw"Invalid argument: "+t+". Must be .select2-search-choice";if(o=t.data("select2-data")){var s=e.Event("select2-removing");if(s.val=this.id(o),s.choice=o,this.opts.element.trigger(s),s.isDefaultPrevented())return!1;for(;(n=i(this.id(o),r))>=0;)r.splice(n,1),this.setVal(r),this.select&&this.postprocessResults();return t.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(o),choice:o}),this.triggerChange({removed:o}),!0}},postprocessResults:function(e,t,o){var n=this.getVal(),r=this.results.find(".select2-result"),s=this.results.find(".select2-result-with-children"),a=this;r.each2(function(e,t){var o=a.id(t.data("select2-data"));i(o,n)>=0&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),s.each2(function(e,t){t.is(".select2-result-selectable")||0!==t.find(".select2-result-selectable:not(.select2-selected)").length||t.addClass("select2-selected")}),-1==this.highlight()&&o!==!1&&this.opts.closeOnSelect===!0&&a.highlight(0),!this.opts.createSearchChoice&&!r.filter(".select2-result:not(.select2-selected)").length>0&&(!e||e&&!e.more&&0===this.results.find(".select2-no-results").length)&&S(a.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+E(a.opts.formatNoMatches,a.opts.element,a.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-l(this.search)},resizeSearch:function(){var e,t,o,n,i,r=l(this.search);e=v(this.search)+10,t=this.search.offset().left,o=this.selection.width(),n=this.selection.offset().left,i=o-(t-n)-r,e>i&&(i=o-r),40>i&&(i=o-r),0>=i&&(i=e),this.search.width(Math.floor(i))},getVal:function(){var e;return this.select?(e=this.select.val(),null===e?[]:e):(e=this.opts.element.val(),a(e,this.opts.separator,this.opts.transformVal))},setVal:function(t){if(this.select)this.select.val(t);else{var o=[],n={};e(t).each(function(){this in n||(o.push(this),n[this]=0)}),this.opts.element.val(0===o.length?"":o.join(this.opts.separator))}},buildChangeDetails:function(e,t){for(var t=t.slice(0),e=e.slice(0),o=0;o<t.length;o++)for(var n=0;n<e.length;n++)if(s(this.opts.id(t[o]),this.opts.id(e[n]))){t.splice(o,1),o--,e.splice(n,1);break}return{added:t,removed:e}},val:function(o,n){var i,r=this;if(0===arguments.length)return this.getVal();if(i=this.data(),i.length||(i=[]),!o&&0!==o)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(n&&this.triggerChange({added:this.data(),removed:i}));if(this.setVal(o),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),n&&this.triggerChange(this.buildChangeDetails(i,this.data()));else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var o=e.map(t,r.id);r.setVal(o),r.updateSelection(t),r.clearSearch(),n&&r.triggerChange(r.buildChangeDetails(i,r.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],o=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(o.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t,o){var n,i,r=this;return 0===arguments.length?this.selection.children(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get():(i=this.data(),t||(t=[]),n=e.map(t,function(e){return r.opts.id(e)}),this.setVal(n),this.updateSelection(t),this.clearSearch(),o&&this.triggerChange(this.buildChangeDetails(i,this.data())),void 0)}}),e.fn.select2=function(){var o,n,r,s,a,l=Array.prototype.slice.call(arguments,0),c=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],h=["opened","isFocused","container","dropdown"],u=["val","data"],d={search:"externalSearch"};return this.each(function(){if(0===l.length||"object"==typeof l[0])o=0===l.length?{}:e.extend({},l[0]),o.element=e(this),"select"===o.element.get(0).tagName.toLowerCase()?a=o.element.prop("multiple"):(a=o.multiple||!1,"tags"in o&&(o.multiple=a=!0)),n=a?new window.Select2["class"].multi:new window.Select2["class"].single,n.init(o);else{if("string"!=typeof l[0])throw"Invalid arguments to select2 plugin: "+l;if(i(l[0],c)<0)throw"Unknown method: "+l[0];if(s=t,n=e(this).data("select2"),n===t)return;if(r=l[0],"container"===r?s=n.container:"dropdown"===r?s=n.dropdown:(d[r]&&(r=d[r]),s=n[r].apply(n,l.slice(1))),i(l[0],h)>=0||i(l[0],u)>=0&&1==l.length)return!1}}),s===t?this:s},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,o,n){var i=[];return y(this.text(e),o.term,i,n),i.join("")},transformVal:function(t){return e.trim(t)},formatSelection:function(e,o,n){return e?n(this.text(e)):t},sortResults:function(e,t,o){return e},formatResultCssClass:function(e){return e.css},formatSelectionCssClass:function(e,o){return t},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==t?null:e.id},text:function(t){return t&&this.data&&this.data.text?e.isFunction(this.data.text)?this.data.text(t):t[this.data.text]:t.text},matcher:function(e,t){return n(""+t).toUpperCase().indexOf(n(""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:k,escapeMarkup:C,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null},nextSearchTerm:function(e,o){return t},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(e){var t="ontouchstart"in window||navigator.msMaxTouchPoints>0;return t&&e.opts.minimumResultsForSearch<0?!1:!0}},e.fn.select2.locales=[],e.fn.select2.locales.en={formatMatches:function(e){return 1===e?"One result is available, press enter to select it.":e+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(e,t,o){return"Loading failed"},formatInputTooShort:function(e,t){var o=t-e.length;return"Please enter "+o+" or more character"+(1==o?"":"s")},formatInputTooLong:function(e,t){var o=e.length-t;return"Please delete "+o+" character"+(1==o?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(e){return"Loading more results\u2026"},formatSearching:function(){return"Searching\u2026"}},e.extend(e.fn.select2.defaults,e.fn.select2.locales.en),e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:b,local:_,tags:R},util:{debounce:u,markMatch:y,escapeMarkup:C,stripDiacritics:n},"class":{"abstract":A,single:O,multi:H}}}}(jQuery);var chart,current_config={},chart_html_tag,parsed_data,org_data;Rumali.liveEditor=function(){var e,t,o=function(e){data.data=parsed_data,"Grid"!==chart_name&&dataFinding(data),$(".theme_configuration").click(function(){$(".execute1").attr("checked",!1);var e=JSON.parse($(this).attr("config"));dataFinding(e)}),$("#expandCollapse").click(function(e){e.preventDefault(),expandAndCollapseAllPanels()}),$(":input.execute1").on("click",function(){if("radio"==this.type){if("chart_color"!=this.id){var e=this.id;final_config[e]!==$(this).val()&&final_config[e]!==parseFloat($(this).val())&&(current_config[e]=$(this).val()),obj[this.id]=this.value,final_config[this.id]=this.value}initializeTheChart("true")}}),$(":input.execute2").on("click",function(){var e=this.id,t=[];if("chart_color_boolean0"===e)colorRepetation=$("[id1='array_text']").val(),$("[id1='array_text']").attr("value",colorRepetation),obj.chart_color=colorRepetation.split(";"),final_config.chart_color=obj.chart_color,$(".identity1").attr("disabled",!0),$(".identity2").attr("disabled",!1);else{var o=$(".execute3:checked");if(o.length)for(var n=0;n<o.length;n++)t.push(o[n].value);else t.push(obj.chart_color[0]);obj.chart_color=t,final_config.chart_color=t,$(".identity1").attr("disabled",!1),$(".identity2").attr("disabled",!0)}initializeTheChart("true")}),$(".execute3").on("click",function(){if("checked"===$("#chart_color_boolean1").attr("checked")){for(var e=this.id,t=[],o=$(".execute3:checked"),n=0;n<o.length;n++)t.push(o[n].value);obj[e]=t,final_config[e]=t,initializeTheChart("true")}}),$(":input.execute").on("blur",function(){var e=this.id;if(obj[e]=$("#"+this.id).val(),final_config[e]!==$(this).val()&&final_config[e]!==parseFloat($(this).val())&&"chart_color"!=e&&(current_config[e]=$(this).val()),final_config[e]=$("#"+this.id).val(),"chart_color"===e){if("checked"===$("#chart_color_boolean0").attr("checked")){obj[e]=this.value.split(";"),final_config[e]=obj[e]}}else"select-one"==this.type?"fixed"==$("#"+this.id).val()?$("."+$(this).attr("disableinputs1")).each(function(){$(this).attr("disabled",!1)}):"moving"==$("#"+this.id).val()?$("."+$(this).attr("disableinputs1")).each(function(){$(this).attr("disabled",!0)}):"color"==$("#"+this.id).val()?$("."+$(this).attr("disableinputs1")).each(function(){$(this).attr("disabled",!0)}):$("."+$(this).attr("disableinputs1")).each(function(){$(this).attr("disabled",!1)}):"checkbox"==this.type&&(this.checked?($("."+$(this).attr("disableinputs")).each(function(){$(this).attr("disabled",!1)}),obj[e]="yes",final_config[e]="yes",current_config[this.id]="yes"):($("."+$(this).attr("disableinputs")).each(function(){$(this).attr("disabled",!0)}),obj[e]="no",current_config[this.id]="no",final_config[e]="no"));""===obj[e]||isNaN(obj[e])||(obj[e]=parseInt(obj[e]),final_config[e]=parseInt(obj[e])),("axis_x_pointer_values"===e||"axis_y_pointer_values"===e||"clubdata_always_include_data_points"===e)&&(obj[e]=obj[e].toString().split(";"),final_config[e]=obj[e]),PykCharts.interval&&clearInterval(PykCharts.interval),"palette_color"==e&&(obj.saturation_color="",final_config.saturation_color=""),initializeTheChart("true")}),$("#color_mode").change(function(){"color"==this.value?($("#color_group").show(),$("#saturation_group").hide()):($("#color_group").hide(),$("#saturation_group").show())}),$("#zoom_enable").click(function(){this.checked?$("#zoom_level").attr("disabled",!1):$("#zoom_level").attr("disabled",!0)}),$(".color").colorpicker().on("hide",function(e,t){if($(this).children()[1].checked)if($(this).has(".execute3").length>0){if("checked"===$(selector).attr("checked")){for(var o=$(this).find(".execute3")[0].id,n=[],i=$(".execute3:checked"),r=0;r<i.length;r++){var s=$($(i[r])[0].previousElementSibling.childNodes[1]).css("background-color");n.push(s)}obj[o]=n,final_config[o]=n,initializeTheChart("true")}}else if($(this).has(".execute1").length>0&&"radio"==$(this).find(".execute1")[0].type){
$(selector).empty();var o=$(this).find(".execute1")[0].id;if("chart_color"!=o){var s=$(this).find(".circle").css("background-color");obj[o]=s,final_config[this.id]=s}initializeTheChart("true")}}),$("#core_viz_update").click(function(){var e=obj;("[entertitlehere]"==e.title_text.trim().replace(/ /g,"").toLowerCase()||""==e.title_text.trim().replace(/ /g,"").toLowerCase())&&(e.title_text=""),("[entersubtitlehere]"==e.subtitle_text.trim().replace(/ /g,"").toLowerCase()||""==e.subtitle_text.replace(/ /g,"").toLowerCase())&&(e.subtitle_text=""),e.data="",$("#core_viz_config").val(JSON.stringify(e))})},n=function(e){org_data=e,i(),o(org_data)},i=function(){var e;"true"===chart_html_tag.dataset.filter_present?($("#filter_container").show(),unique_filter_html=renderFilter(org_data,chart_html_tag.dataset.filter_column_name,"filter_show"),$("#filter_container").html(unique_filter_html),$("#filter_show").change(function(){e=$("#filter_show option:selected").val(),parsed_data=filterChart(org_data,chart_html_tag.dataset.filter_column_name,e),o(parsed_data)}),$("select#filter_show").prop("selectedIndex",0),e=$("#filter_show option:selected").val(),parsed_data=filterChart(org_data,chart_html_tag.dataset.filter_column_name,e)):($("#filter_container").hide(),parsed_data=org_data)};chart_html_tag=$("#chart_container")[0],e=chart_html_tag.dataset.datacast_identifier,t=Rumali.object.datacast_url+e,getJSON(t,n)};var initializeTheChart=function(e){"Grid"!==chart_name&&($("#title").remove(),$("#subtitle").remove(),"true"==e&&(""==obj.title_text&&(obj.title_text="[ Enter Title Here ]"),""==obj.subtitle_text&&(obj.subtitle_text="[ Enter Subtitle Here ]")),chart&&chart.interval&&clearInterval(chart.interval),chart=new initializer(obj),d3.selectAll(".pyk-tooltip").remove(),$(selector).empty(),chart.execute(),"true"==e&&giveTitleProperties())},giveTitleProperties=function(){$("#title").ready(function(){$("#title").attr("contenteditable","true"),$("#title").blur(function(){var e=this.innerText.trim();$(this).attr("contenteditable","true"),$("#title_text").val(e),obj.title_text=e,""==e&&initializeTheChart("true")}),$("#title").keydown(function(e){13===e.keyCode&&$(this).attr("contenteditable","false")})}),$("#sub-title").ready(function(){$("#sub-title").attr("contenteditable","true"),$("#sub-title").blur(function(){var e=this.innerText.trim();$(this).attr("contenteditable","true"),$("#subtitle_text").val(e),obj.subtitle_text=e,""==e&&initializeTheChart("true")}),$("#sub-title").keydown(function(e){13===e.keyCode&&$(this).attr("contenteditable","false")})})};Rumali.showChartPage=function(){obj.selector=selector,obj.data=gon.data_file,initializeTheChart("false")};var showHintForChartEligibility=function(e,t){var o="";switch(data_length=e.length,t){case"PykCharts.oneD.pie":case"PykCharts.oneD.donut":case"PykCharts.oneD.electionPie":case"PykCharts.oneD.electionDonut":case"PykCharts.oneD.pyramid":case"PykCharts.oneD.funnel":case"PykCharts.oneD.bubble":case"PykCharts.oneD.treemap":case"PykCharts.oneD.percentageBar":case"PykCharts.oneD.percentageColumn":data_length>6&&(o="Ideally, this chart should not have more than 6 partitions. You may check the other charts too, to get the best match.");break;case"PykCharts.multiD.multiSeriesLine":for(var n=[],i=0;i<data_length;i++){var r=e[i].name;-1===n.indexOf(r)&&n.push(r)}n.length>5&&(o="Ideally, this chart should not have more than 5 lines. You may check the other charts too, to get the best match.");break;case"PykCharts.multiD.panelsOfLine":for(var n=[],i=0;i<data_length;i++){var r=e[i].name;-1===n.indexOf(r)&&n.push(r)}n.length>9&&(o="Ideally, this chart should not have more than 9 panels. You may check the other charts too, to get the best match.");break;case"PykCharts.multiD.stackedArea":for(var n=[],i=0;i<data_length;i++){var r=e[i].name;-1===n.indexOf(r)&&n.push(r)}n.length>4&&(o="Ideally, this chart should not have more than 4 stacks. You may check the other charts too, to get the best match.");break;case"PykCharts.multiD.bar":case"PykCharts.multiD.column":data_length>20&&(o="Ideally, this chart should not have more than 20 bars. You may check the other charts too, to get the best match.");break;case"PykCharts.multiD.groupedBar":for(var n=[],i=0;i<data_length;i++){var r=e[i].group;-1===n.indexOf(r)&&n.push(r)}(n.length>4||e.length>24)&&(o="Ideally, this chart should not have more than 4 groups and more than 24 bars. You may check the other charts too, to get the best match.");break;case"PykCharts.multiD.groupedColumn":for(var n=[],i=0;i<data_length;i++){var r=e[i].group;-1===n.indexOf(r)&&n.push(r)}(n.length>4||e.length>24)&&(o="Ideally, this chart should not have more than 4 groups and more than 24 bars. You may check the other charts too, to get the best match.");break;case"PykCharts.multiD.scatter":for(var n=[],i=0;i<data_length;i++){var r=e[i].group;-1===n.indexOf(r)&&n.push(r)}(n.length>6||e.length>50)&&(o="Ideally, this chart should not have more than 50 bubbles and 6 groups. You may check the other charts too, to get the best match.");break;case"PykCharts.multiD.panelsOfScatter":for(var n=[],i=0;i<data_length;i++){var r=e[i].group;-1===n.indexOf(r)&&n.push(r)}(n.length>9||e.length>50)&&(o="Ideally, this chart should not have more than 50 bubbles and 9 panels. You may check the other charts too, to get the best match.");break;case"PykCharts.multiD.pulse":for(var n=[],s=[],a=[],i=0;i<data_length;i++){var r=e[i].group,l=e[i].x,c=e[i].y;-1===n.indexOf(r)&&n.push(r),-1===s.indexOf(l)&&s.push(l),-1===a.indexOf(c)&&a.push(c)}(n.length>6||s.length>30||a.length>10)&&(o="Ideally, this chart should not have more than 6 groups and 30 points in x-axis and 10 points on y-axis. You may check the other charts too, to get the best match.");break;case"PykCharts.multiD.spiderWeb":for(var n=[],i=0;i<data_length;i++){var r=e[i].group;-1===n.indexOf(r)&&n.push(r)}n.length>4&&(o="Ideally, this chart should not have more than 4 groups and 32 data points. You may check the other charts too, to get the best match.")}document.getElementById("chart_eligibility").innerHTML=o},enableCharts=function(e,t,o,n){var i=table_show.dimensions,r=table_show.metrics,s=i.length,a=calCulateMetricLength(r);checkConditionAndEnable(s,a),showChart(e,t,o,n)},checkConditionAndEnable=function(e,t){$("#core_viz_submit").show(),disableAllChartsAndGrid(),e>0||t>0?$("#show_grid_and_hide_the_chart").removeClass("disabled").addClass("enabled"):$("#core_viz_submit").hide();for(var o=document.getElementsByClassName("charts"),n=o.length,i=0;n>i;i++){var r=o[i];parseInt($(r).data("dimensions_required"),10)==e&&parseInt($(r).data("metrics_required"),10)==t&&($(r).removeClass("disabled"),$(r).addClass("enabled"))}},showChart=function(e,t,o,n){$(".charts.enabled").unbind("click"),$(".charts.enabled").click(function(i){$(".is_selected_chart").removeClass("is_selected_chart"),$("#table_show").hide(),$("#chart_show").empty(),$(this).addClass("is_selected_chart");var r=$(this).data(),s=r.api;callTheChart(s,e,t,o,r.dimensions_alias,r.metrics_alias,n),$("#chart_show").show(),i.preventDefault()})},callTheChart=function(e,t,o,n,i,r,s){t=convertColumnToAlias(t,o,i),t=convertColumnToAlias(t,n,r),chart_api=getApiFromString(e),showHintForChartEligibility(t,e),time_value=findTimeValue(t);var a=JSON.parse(gon.default_theme);a.title_text="",a.subtitle_text="",a.legends_enable="no",a.axis_x_time_value_datatype=time_value[0],a.axis_x_time_value_interval=time_value[1],a.data=t,"PykCharts.multiD.panelsOfLine"===e?(a.chart_width=250,a.chart_height=250):(a.chart_width=575,a.chart_height=400),a.selector="#chart_show",$(".pyk-tooltip").remove();var l=new chart_api(a);l.execute()},disableAllChartsAndGrid=function(){$(".options").removeClass("enabled"),$(".options").addClass("disabled"),$(".charts").unbind("click")},findTimeValue=function(e){if(new_data=d3.csv.parse(e),!isNaN(new Date(new_data[0].x).getTime())){var t=d3.extent(new_data,function(e){return new Date(e.x)}),o=Math.abs(t[1].getTime()-t[0].getTime()),n=Math.ceil(o/864e5);return n>30?["month",1]:["date",3]}return[]},column_name_alias={},user_entered_column_names={},showTable=function(){function e(e,t,o,n,i,r,s){Handsontable.TextCell.renderer.apply(this,arguments),0>=o&&(s.readOnly=!1,t.style.fontWeight="bold",t.style.color="#1B668B",t.style.background="#f0f0f0")}function t(e,t,o,n,i,r,s){Handsontable.TextCell.renderer.apply(this,arguments),0>=o&&(t.style.fontWeight="bold",t.style.color="#1B668B",t.style.background="#f0f0f0")}chart_view_filter=new PykQuery.init("aggregation","local","chart_view_filter","rumi"),chart_view_filter.rumiparams=Rumali.gridoperation.restEndPoint(),divg1=new PykQuery.init("aggregation","global","divg1","rumi"),pyk_histogram=new PykQuery.init("aggregation","local","pyk_histogram","rumi"),pyk_histogram.rumiparams=Rumali.gridoperation.restEndPoint(),column_values_filter=new PykQuery.init("aggregation","local","column_values_filter","rumi"),column_values_filter.addImpacts(["divg1"],!1),pyk_histogram.addImpacts(["divg1"],!1),divg1.addImpacts(["table_show"],!1),divg1.listFilters("list_applied_filters"),Rumali.gridoperation.showFilterCount(),Rumali.sidebarUnique(),Rumali.plugin=new Rumali.plugins,$cont=$("#table_show"),$("#table_show").handsontable({data:{},readOnly:!0,fixedRowsTop:1,colHeaders:!0,manualColumnMove:!0,outsideClickDeselects:!1,contextMenu:!1,cells:function(t,o,n){return{renderer:e}}}),$("#table_header").handsontable({data:{},readOnly:!0,colHeaders:!0,manualColumnMove:!0,outsideClickDeselects:!1,contextMenu:!1,cells:function(e,o,n){return{renderer:t}}});var o=$cont.handsontable("getInstance"),n=$("#table_header").handsontable("getInstance");n.addHook("afterOnCellMouseDown",function(e,t,o){-1==t.row&&-1!=t.col&&0==e.button&&i(t)}),o.addHook("afterChange",function(e,t){if("edit"==t){var o=e[0][3],n=e[0][1],i=e[0][0],a=e[0][2];a!=o&&(s(n,o),r(n,o,i))}});var i=function(e){var t,o,n=Object.keys(Rumali.original_column_names),i=e.col,r=n[i],s={};$("#table1").show(),$("#table1").addClass("active"),$("#all_charts").removeClass("active"),$("#show_filter_tab").addClass("active"),$("#chart_selector_list").removeClass("active"),t=self.datatype_column[r],selected_datatype=t,new_column_name=r,chart_view_filter.dataformat="json",s[r]=["count"],chart_view_filter.resetDimensions(),chart_view_filter.resetMetrics(),chart_view_filter.dimensions=[r],chart_view_filter.metrics=s,chart_view_filter.executeOnFilter=function(){o=JSON.parse(chart_view_filter.flushToGet().data),data_distribution=Rumali.gridoperation.changeToJsonData(o,n[i]),"integer"==t||"double"==t?($("#merge").hide(),$("#grid_unique_values").hide(),Rumali.histogram(r,t,data_distribution)):($("#histogram-chart").hide(),$("#histogram_min_max").hide(),$("#grid_unique_values").show(),Rumali.countUniqueValues(data_distribution,"asce",r)),Rumali.gridoperation.resetFilterElements()},chart_view_filter.call()},r=function(e,t,n){if(e!=t){var i=t+" ("+Rumali.original_column_names[e]+")";self.table_data[n][e]=i}else{var i=e;self.table_data[n][e]=i}o.render()},s=function(e,t){var o=["sum","count","min","max","avg","median"],n=e.split("_"),i=n.length;if(o.indexOf(n[i-1])>-1){var r,s,a=n.pop();original_colname=n.join("_");for(var l in Rumali.original_column_names)if(Rumali.original_column_names[l]===original_colname){s=l;break}r=table_show.alias[s][a]?table_show.alias[s][a]:e,user_entered_column_names[r]=t,column_name_alias[s][a]=t}else{user_entered_column_names[e]=t;var c=column_name_alias[e];c&&c[e]?column_name_alias[e][e]=t:column_name_alias[e]=t}}},appendAliasToColumnHeader=function(e){for(var t in e)void 0!=self.table_data[0][t]&&self.table_data[0][t]!=e[t]&&(self.table_data[0][t]=e[t]+" ("+self.table_data[0][t]+")",$("#table_show").handsontable("render"))};Rumali.refreshAfterFilter=function(){table_show.executeOnFilter=function(){if("block"==$("#table_show").css("display")){var e=table_show.flushToGet().data;void 0!=e&&""!=e?(json_table_data=d3.csv.parse(e),refreshTableData(json_table_data),generate_notify({text:"Filter Updated",notice:"success",timeout:!0})):generate_notify({text:"No data For this filter",notify:"error",timeout:!0})}else"block"==$("#chart_show").css("display")&&Rumali.refreshChartAfterFilter();Rumali.gridoperation.resetFilterElements(),Rumali.gridoperation.showFilterCount()}},Rumali.executeAfterHistogramFilter=function(e,t){void 0!=e&&void 0!=t&&(global_brush.extent([e,t]),brush.call(global_brush)),Rumali.refreshAfterFilter()},Rumali.executeAfterUniquevalueFilter=function(){Rumali.refreshAfterFilter()},Rumali.executeAfterDeleteFilter=function(){Rumali.refreshAfterFilter()},Rumali.executeAfterRangeFilter=function(){Rumali.refreshAfterFilter()};var refreshTableData=function(e){self.table_data=e;var t={},o=[],n=Handsontable.editors.TextEditor.prototype.extend();if(n.prototype.prepare=function(e,t,o,n,i,r){var s=i.replace("("+Rumali.original_column_names[self.column_header[t]]+")","");i=s,Handsontable.editors.BaseEditor.prototype.prepare.apply(this,arguments)},void 0!=self.table_data[0]){self.column_header=Object.keys(self.table_data[0]);for(var i=0;i<self.column_header.length;i++)o.push({editor:n,data:self.column_header[i]}),t[self.column_header[i]]=Rumali.original_column_names[self.column_header[i]]}else console.error("No Column Header in data Or no data is present For this filter");e.splice(0,0,t);var r=$("#table_show").handsontable("getInstance");r.updateSettings({data:self.table_data,columns:o})};Rumali.object={datacast_url:rumi_api_endpoint+"datacast/"};var getJSON=function(e,t){$.getJSON(e).done(function(e){t(e)})},findKeyArray=function(e){var t=Object.keys(e);return t},renderHTMLForCard=function(e,t){var t=t,o=e[0].title?e[0].title:"",n=e[0].key?e[0].key:"<br/>",i=e[0].value?e[0].value:"",r=e[0].content?e[0].content:"";diff_in_value=e[0].diff_in_value?e[0].diff_in_value:"",diff_string="","number"==typeof+i&&(i=+i,i=applyConditionalFormatting(i)),"number"==typeof+diff_in_value&&(+diff_in_value>0&&(diff_string='(<span class="'+applyConditionalCssPositiveOrNegative(1)+'">'+diff_in_value,diff_string+="&#9652;</span>)"),+diff_in_value<0&&(diff_string='(<span class="'+applyConditionalCssPositiveOrNegative(2)+'">'+-1*+diff_in_value,diff_string+="&#9660;</span>)"),0===+diff_in_value&&(diff_string='(<span class="'+applyConditionalCssPositiveOrNegative(3)+'">'+diff_in_value,diff_string+="-</span>)"));var s=$("<div />").appendTo("body");s.attr("id",t);var a='<span class = "col-sm-4 card_layout">';a+='<span class= "col-sm-12 card_layout_header_span"><h4 class="card_layout_header"><b>'+o+"</b></h4></span>",a+='<span class= "col-sm-12 card_layout_key">'+n+"</b></span>",a+='<span class= "col-sm-12 card_layout_value">'+i+"</b>",""!==diff_in_value&&(a+=diff_string),a+='<span class= "col-sm-12 card_layout_content">'+r,a+="</span>",$("#"+t).html(a)},applyConditionalFormatting=function(e){var t=e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");return t},applyConditionalCssPositiveOrNegative=function(e){return 1===e?"positive_value_css":2===e?"negative_value_css":"no_class"},filterChart=function(e,t,o){var n,i=[],r=-1;for(n=0;n<e.length;n++)if(o===e[n][t]){i[++r]={};for(var s in e[n])s!==t&&(i[r][s]=e[n][s])}return i},getApiFromString=function(e){return e=e.split("."),PykCharts[e[1]][e[2]]};window.onload=function(){switch(gon.scopejs){case"scopejs_themes_new":case"scopejs_themes_create":case"scopejs_themes_edit":case"scopejs_themes_update":Rumali.ConfigThemeSubmitForm(),Rumali.liveEditor();break;case"scopejs_vizs_new":case"scopejs_vizs_create":Rumali.chartView();break;case"scopejs_vizs_edit":case"scopejs_vizs_update":"Grid"!==chart_name&&"One Number indicators"!==chart_name?Rumali.liveEditor():"One Number indicators"!==chart_name?Rumali.showAndEditGridPage():Rumali.showAndEditBoxPage();break;case"scopejs_datacast_pulls_create":case"scopejs_datacasts_file":case"scopejs_datacasts_upload":Rumali.newDataStorePage();break;case"scopejs_vizs_show":"Grid"!==chart_name?Rumali.showChartPage():Rumali.showAndEditGridPage();break;case"scopejs_datacasts_new":case"scopejs_datacasts_create":Rumali.dataCastNewPage();break;case"scopejs_datacasts_edit":case"scopejs_datacasts_update":Rumali.dataCastNewPage(),Rumali.initDataCastGrid();break;case"scopejs_articles_edit":case"scopejs_articles_update":Rumali.newArticleCreate();case"scopejs_reports_show":Rumali.buildCharts.loadReportChart(),setTimeout(function(){$(".maincontent").css("height",$("main").height())},3e3);case"scopejs_reports_new":case"scopejs_reports_create":case"scopejs_reports_edit":case"scopejs_reports_update":Rumali.reportsNewPage()}};