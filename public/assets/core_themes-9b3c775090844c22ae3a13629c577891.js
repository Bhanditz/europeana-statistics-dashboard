function dataFinding(t){"One Dimensional Charts"==genre&&(t.color_mode="shade");var e=0;config_data=t,final_config={};var i=$(".cstm-form-control:input"),a=[];colorRepetation=[],countgroup=1;for(var o in current_config)config_data[o]=current_config[o];for(o=0;o<i.length;o++)if("core_theme_name"!=i[o].id)if(a.push(i[o].type),"number"===i[o].type.toLowerCase())i[o].value=config_data[$(i)[o].id],final_config[$(i)[o].id]=config_data[$(i)[o].id];else if("textbox"===i[o].type.toLowerCase())$(i)[o].value=config_data[$(i)[o].id]||"",final_config[$(i)[o].id]=config_data[$(i)[o].id];else if("text"===i[o].type.toLowerCase())$(i)[o].value=config_data[$(i)[o].id]||"",final_config[$(i)[o].id]=config_data[$(i)[o].id];else if("color"===i[o].type.toLowerCase())$(i)[o].value=config_data[$(i)[o].id]||"",final_config[$(i)[o].id]=config_data[$(i)[o].id];else if("color1"===$(i[o]).attr("reference")){1===e&&(e=0),e+=.2;var r=config_data[i[o].id];"chart_color"===i[o].id&&(r=r[0]);var n=hex2rgb(r),c=("rgba("+n[0]+","+n[1]+","+n[2]+","+e+")",RGBAtoRGB(n[0],n[1],n[2],e,255,255,255)),l=rgbToHex(c);i[o].value=l,$($(i[o])[0].parentElement).attr("data-color",l),$($(i[o])[0].previousElementSibling.childNodes[1]).css("background-color",l),"chart_color"===i[o].id&&5>=countgroup&&(colorRepetation+=5===countgroup?l:l+";",countgroup++)}else"checkbox"===i[o].type.toLowerCase()?($(i)[o].value=config_data[$(i)[o].id],$(i)[o].checked="yes"===config_data[$(i)[o].id]?!0:!1,final_config[$(i)[o].id]=config_data[$(i)[o].id]):"select-one"===i[o].type.toLowerCase()&&($(i)[o].value=config_data[$(i)[o].id],final_config[$(i)[o].id]=config_data[$(i)[o].id]);config_data.data=data_file,""==config_data.data&&(config_data.data=gon.data_file),config_data.selector=selector,init()}function init(){obj&&(config_data.title_text=""!=obj.title_text.toString().trim()?obj.title_text:config_data.title_text,config_data.subtitle_text=""!=obj.subtitle_text.toString().trim()?obj.subtitle_text:config_data.subtitle_text),obj=config_data,$(selector).empty(),config_data.map_code=map_code,final_config.map_code=map_code,obj.title_text&&"[entertitlehere]"==obj.title_text.trim().replace(/ /g,"").toLowerCase()&&$("#title_text").val(""),obj.subtitle_text&&"[entersubtitlehere]"==obj.subtitle_text.trim().replace(/ /g,"").toLowerCase()&&$("#subtitle_text").val("");var t="";t=colorRepetation,"Pictograph"!=chart_name&&"Grid"!==chart_name&&(config_data.chart_color=colorRepetation.split(";").reverse(),$("[id1='array_text']").attr("value",t.split(";").reverse().join(";"))),colorRepetation=[],t="",countgroup=1,initializeTheChart("true")}function hex2rgb(t){return["0x"+t[1]+t[2]|0,"0x"+t[3]+t[4]|0,"0x"+t[5]+t[6]|0]}function RGBAtoRGB(t,e,i,a,o,r,n){var c=Math.round((1-a)*o+a*t),l=Math.round((1-a)*r+a*e),s=Math.round((1-a)*n+a*i);return"rgb("+c+","+l+","+s+")"}function rgbToHex(t){if("#"===t.substr(0,1))return t;var e=/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(t),i=parseInt(e[2],10).toString(16),a=parseInt(e[3],10).toString(16),o=parseInt(e[4],10).toString(16);return"#"+((1==i.length?"0"+i:i)+(1==a.length?"0"+a:a)+(1==o.length?"0"+o:o))}function expandAndCollapseAllPanels(){$(".panel-body").hasClass("in")?$(".panel-body").removeClass("in"):($(".panel-body").addClass("in").css("height","auto"),$(".in").prev().removeClass("collapsed"))}Rumali.ConfigThemeSubmitForm=function(){$("#theme_submit").click(function(){var t=JSON.stringify(obj);$("#core_theme_config").val(t)})};var chart,current_config={};Rumali.liveEditor=function(){"Grid"!==chart_name&&(dataFinding(data),$("#embed-code-display").length>0&&embed_url&&(setTimeout(function(){initClipBoard("#copy-link","#embed-code-display")},1e3),$("#embed-code-display").text('<iframe src="'+embed_url+'" height='+(data.chart_height+25)+" width="+(data.chart_width+25)+' frameborder="0" scrolling="no"></iframe>'))),$(".theme_configuration").click(function(){$(".execute1").attr("checked",!1);var t=JSON.parse($(this).attr("config"));dataFinding(t)}),$("#expandCollapse").click(function(t){t.preventDefault(),expandAndCollapseAllPanels()}),$(":input.execute1").on("click",function(){if("radio"==this.type){if("chart_color"!=this.id){var t=this.id;final_config[t]!==$(this).val()&&final_config[t]!==parseFloat($(this).val())&&(current_config[t]=$(this).val()),obj[this.id]=this.value,final_config[this.id]=this.value}initializeTheChart("true")}}),$(":input.execute2").on("click",function(){var t=this.id,e=[];if("chart_color_boolean0"===t)colorRepetation=$("[id1='array_text']").val(),$("[id1='array_text']").attr("value",colorRepetation),obj.chart_color=colorRepetation.split(";"),final_config.chart_color=obj.chart_color,$(".identity1").attr("disabled",!0),$(".identity2").attr("disabled",!1);else{var i=$(".execute3:checked");if(i.length)for(var a=0;a<i.length;a++)e.push(i[a].value);else e.push(obj.chart_color[0]);obj.chart_color=e,final_config.chart_color=e,$(".identity1").attr("disabled",!1),$(".identity2").attr("disabled",!0)}initializeTheChart("true")}),$(".execute3").on("click",function(){if("checked"===$("#chart_color_boolean1").attr("checked")){for(var t=this.id,e=[],i=$(".execute3:checked"),a=0;a<i.length;a++)e.push(i[a].value);obj[t]=e,final_config[t]=e,initializeTheChart("true")}}),$(":input.execute").on("blur",function(){var t=this.id;if(obj[t]=$("#"+this.id).val(),final_config[t]!==$(this).val()&&final_config[t]!==parseFloat($(this).val())&&"chart_color"!=t&&(current_config[t]=$(this).val()),final_config[t]=$("#"+this.id).val(),"chart_color"===t){if("checked"===$("#chart_color_boolean0").attr("checked")){obj[t]=this.value.split(";"),final_config[t]=obj[t]}}else"select-one"==this.type?$("."+$(this).attr("disableinputs1")).each("fixed"==$("#"+this.id).val()?function(){$(this).attr("disabled",!1)}:"moving"==$("#"+this.id).val()?function(){$(this).attr("disabled",!0)}:"color"==$("#"+this.id).val()?function(){$(this).attr("disabled",!0)}:function(){$(this).attr("disabled",!1)}):"checkbox"==this.type&&(this.checked?($("."+$(this).attr("disableinputs")).each(function(){$(this).attr("disabled",!1)}),obj[t]="yes",final_config[t]="yes",current_config[this.id]="yes"):($("."+$(this).attr("disableinputs")).each(function(){$(this).attr("disabled",!0)}),obj[t]="no",current_config[this.id]="no",final_config[t]="no"));""===obj[t]||isNaN(obj[t])||(obj[t]=parseInt(obj[t]),final_config[t]=parseInt(obj[t])),("axis_x_pointer_values"===t||"axis_y_pointer_values"===t||"clubdata_always_include_data_points"===t)&&(obj[t]=obj[t].toString().split(";"),final_config[t]=obj[t]),PykCharts.interval&&clearInterval(PykCharts.interval),"palette_color"==t&&(obj.saturation_color="",final_config.saturation_color=""),initializeTheChart("true")}),$("#color_mode").change(function(){"color"==this.value?($("#color_group").show(),$("#saturation_group").hide()):($("#color_group").hide(),$("#saturation_group").show())}),$("#zoom_enable").click(function(){this.checked?$("#zoom_level").attr("disabled",!1):$("#zoom_level").attr("disabled",!0)}),$(".color").colorpicker().on("hide",function(){if($(this).children()[1].checked)if($(this).has(".execute3").length>0){if("checked"===$(selector).attr("checked")){for(var t=$(this).find(".execute3")[0].id,e=[],i=$(".execute3:checked"),a=0;a<i.length;a++){var o=$($(i[a])[0].previousElementSibling.childNodes[1]).css("background-color");e.push(o)}obj[t]=e,final_config[t]=e,initializeTheChart("true")}}else if($(this).has(".execute1").length>0&&"radio"==$(this).find(".execute1")[0].type){$(selector).empty();var t=$(this).find(".execute1")[0].id;if("chart_color"!=t){var o=$(this).find(".circle").css("background-color");obj[t]=o,final_config[this.id]=o}initializeTheChart("true")}}),$("#core_viz_update").click(function(){var t=obj,e=$("#core_viz_name").val();("[entertitlehere]"==t.title_text.trim().replace(/ /g,"").toLowerCase()||""==t.title_text.trim().replace(/ /g,"").toLowerCase())&&(t.title_text=""),("[entersubtitlehere]"==t.subtitle_text.trim().replace(/ /g,"").toLowerCase()||""==t.subtitle_text.replace(/ /g,"").toLowerCase())&&(t.subtitle_text=""),t.data="",$("#core_viz_config").val(JSON.stringify(t)),e=""===t.title_text?e:t.title_text,$("#core_viz_name").val(e)})};var initializeTheChart=function(t){"Grid"!==chart_name&&($("#title").remove(),$("#subtitle").remove(),"true"==t&&(""==obj.title_text&&(obj.title_text="[ Enter Title Here ]"),""==obj.subtitle_text&&(obj.subtitle_text="[ Enter Subtitle Here ]")),chart&&chart.interval&&clearInterval(chart.interval),chart=new initializer(obj),d3.selectAll(".pyk-tooltip").remove(),$(selector).empty(),chart.execute(),"true"==t&&giveTitleProperties())},giveTitleProperties=function(){$("#title").ready(function(){$("#title").attr("contenteditable","true"),$("#title").blur(function(){var t=this.innerText.trim();$(this).attr("contenteditable","true"),$("#title_text").val(t),obj.title_text=t,""==t&&initializeTheChart("true")}),$("#title").keydown(function(t){13===t.keyCode&&$(this).attr("contenteditable","false")})}),$("#sub-title").ready(function(){$("#sub-title").attr("contenteditable","true"),$("#sub-title").blur(function(){var t=this.innerText.trim();$(this).attr("contenteditable","true"),$("#subtitle_text").val(t),obj.subtitle_text=t,""==t&&initializeTheChart("true")}),$("#sub-title").keydown(function(t){13===t.keyCode&&$(this).attr("contenteditable","false")})})};window.onload=function(){$("#loader .centered").slideUp(function(){$("#loader").fadeOut(function(){$("#loader").remove()})});var t=document.getElementsByTagName("body")[0].id;switch(t){case"scopejs_themes_new":case"scopejs_themes_create":case"scopejs_themes_edit":case"scopejs_themes_update":Rumali.ConfigThemeSubmitForm(),Rumali.liveEditor();break;case"scopejs_vizs_new":case"scopejs_vizs_create":Rumali.chartView();break;case"scopejs_vizs_edit":case"scopejs_vizs_update":"Grid"!==chart_name?Rumali.liveEditor():"csv"==gon.dataformat?Rumali.showAndEditGridPage():Rumali.JsonDataPage();break;case"scopejs_data_stores_new":case"scopejs_data_store_pulls_create":Rumali.newDataStorePage();break;case"scopejs_vizs_show":"Grid"!==chart_name?Rumali.showChartPage():"csv"==gon.dataformat?Rumali.showAndEditGridPage():Rumali.JsonDataPage();break;case"scopejs_maps_show":Rumali.bangaloreGeo();break;case"scopejs_map_files_show":Rumali.showMapFile()}};