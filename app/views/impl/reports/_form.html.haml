- if ["new",'create'].include?(action_name)
  - url = account_project_impl_reports_path(@account,@core_project)
  - method = "post"
- else
  - url = account_project_impl_report_path(@account,@core_project, @impl_report)
  - method = "put"


= simple_form_for(@impl_report, url: url, method: method) do |f|
  .row
    .col-sm-6
      = f.input :name
      #editor
        .col-sm-8
          #toolbar.wmd-toolbar
        .col-sm-3.pull-right
          = link_to "Add a chart","#","data-toggle" => "modal", "data-target"=>"#chart-selector", id: "btn-chart-selector", class: "bootstrap-btn btn btn-orange"
        = f.input :html_content, as: :text, input_html: {id: "input", cols:"65", rows:"26",class: "form-control wmd-input", onscroll: "scrolling('textarea')", onkeyup: "scrolling('textarea')"}, required: true, label: false
    .col-sm-6
      #report_preview.wmd-preview Live preview
  .clearfix
  = f.input :is_autogenerated, as: :hidden, input_html: {value: true}
  = f.input :core_project_id, as: :hidden, input_html: {value: @core_project.id}
  = f.submit "Create", class: "btn btn-orange", id: "impl_report_submit"

- if @core_vizs.first.present?

  #chart-selector.modal.fade{"aria-hidden" => "true", "aria-labelledby" => "myModalLabel", :role => "dialog", :tabindex => "-1"}
    .modal-dialog 
      .modal-content
        .modal-body{style: "min-height:400px; overflow-y:scroll;"}
          %table.table.table-bordred.table-hovered
            %thead
              %th Name
              %th Type
            - @core_vizs.each do |viz|
              %tr
                %td
                  = link_to viz.name, "#",class: "selected-chart", "data-auto_html_div" => viz.auto_html_div
                %td
                  = viz.ref_chart.name


:javascript
  new WMD("input", "toolbar", { preview: "report_preview" });
  setTimeout(function() {genereteChartInMarkdown();},1000);